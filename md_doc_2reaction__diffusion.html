<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: Reaction-diffusion module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPI-AMRVAC<span id="projectnumber">&#160;3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Reaction-diffusion module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page describes the current functionality of the reaction-diffusion module. The source code can be found in <code><a class="el" href="mod__rd__phys_8t.html">src/rd/mod_rd_phys.t</a></code>.</p>
<h1><a class="anchor" id="label-1"></a>
Physics</h1>
<p>Systems of \( s \) reaction-diffusion equations are of the form</p>
<p class="formulaDsp">
\[ \frac{\partial u_i}{\partial t} = D_i \nabla^2 u_i + f_i(u_1, \ldots, u_s) \qquad i \in \{1,\ldots, s\} \]
</p>
<p>where \( D_i \) are the diffusion coefficients and \( f_i \) the reaction functions. Several of these systems are available in MPI-AMRVAC, the systems of interest are given below. The prefixes relate to the names given to the systems in the code, to be supplied in the <code>.par</code> file or prefixing the variables. Some systems have a good starting resource linked to them.</p>
<ul>
<li><code>lg</code> = <code>logistic</code>: <a href="https://people.maths.ox.ac.uk/trefethen/pdectb/fisher2.pdf"><b>Fisher-KPP</b></a> or the diffusive logistic equation</li>
</ul>
<p class="formulaDsp">
\[
        u_t = D \nabla^2 u + \lambda u(1-u) 
    \]
</p>
<ul>
<li><code>gs</code> = <code>gray-scott</code>: <a href="http://mrob.com/pub/comp/xmorphia/index.html"><b>Gray-Scott</b></a></li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u - uv^2 + F(1-u) \\
        v_t &amp;=&amp; D_2 \nabla^2 v + uv^2 - (F+k)v 
    \end{eqnarray*}
</p>
<ul>
<li><code>br</code> = <code>brusselator</code>: <b>Brusselator</b></li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u + u^2 v + A - (B+1) u \\
        v_t &amp;=&amp; D_2 \nabla^2 v - u^2 v + Bu 
    \end{eqnarray*}
</p>
<ul>
<li><code>sb</code> = <code>schnakenberg</code>: <a href="https://cbeentjes.github.io/files/Ramblings/PatternFormationSchnakenberg.pdf"><b>Schnakenberg</b></a></li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u + \gamma (\alpha + u^2 v - u) \\
        v_t &amp;=&amp; D_2 \nabla^2 v + \gamma (\beta - u^2 v) 
    \end{eqnarray*}
</p>
<ul>
<li><code>ebr</code> = <code>ext-brusselator</code>: <b>Extended Brusselator</b> (where \( f(u,v) \) and \( g(u,v) \) are the reaction functions in the Brusselator model (see above))</li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u + f(u,v) - Cu + Dw \\
        v_t &amp;=&amp; D_2 \nabla^2 v + g(u,v) \\
        w_t &amp;=&amp; D_3 \nabla^2 w + Cu - Dw
    \end{eqnarray*}
</p>
<ul>
<li><code>bzfn</code> = <code>belousov_fieldnoyes</code>: <b>Oregonator</b> (Field-Noyes model of the Belousov-Zhabotinski reaction)</li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u + \frac{1}{\epsilon} (\lambda u - u w + u - u^2) \\
        v_t &amp;=&amp; D_2 \nabla^2 v + u - v \\
        w_t &amp;=&amp; D_3 \nabla^2 w + \frac{1}{\delta} (-\lambda w - u w + \mu v))
    \end{eqnarray*}
</p>
<ul>
<li><code>lor</code> = <code>lorenz</code>: <b>The Lorenz system</b></li>
</ul>
<p class="formulaDsp">
\begin{eqnarray*}
        u_t &amp;=&amp; D_1 \nabla^2 u + \sigma (v-u) \\
        v_t &amp;=&amp; D_2 \nabla^2 v + u(r - w) - v \\
        w_t &amp;=&amp; D_3 \nabla^2 w + uv - bw 
    \end{eqnarray*}
</p>
<h1><a class="anchor" id="label-2"></a>
Numerics</h1>
<p>The reaction-diffusion module doesn't use advection, hence none of the flux schemes or slope limiters are applicable to this module. The spatially discretized diffusion and the local reactions are added as source terms. For the moment, diffusion is discretized with a second order centered finite difference scheme. There is a possibility to use IMEX schemes, where the diffusion part is handled implicitly and reaction explicitly. The implicit system is then solved using the AMR-compatible multigrid solver coupled to MPI-AMRVAC. </p><pre class="fragment">&lt;!-- J. Teunissen, R. Keppens,
A geometric multigrid library for quadtree/octree AMR grids coupled to MPI-AMRVAC,
Computer Physics Communications,
Volume 245,
2019,
106866,
ISSN 0010-4655,
https://doi.org/10.1016/j.cpc.2019.106866. --&gt;
</pre><h1><a class="anchor" id="label-3"></a>
Practical usage</h1>
<p>A number of examples can be found in <code>tests/rd/</code>. The namelist for the reaction-diffusion module is as follows: </p><pre class="fragment">&amp;rd_list
    D1, D2, D3,                  ! Diffusion coefficients
    sb_alpha, sb_beta, sb_kappa, ! Parameters for Schnakenberg
    gs_F, gs_k,                  ! Parameters for Gray-Scott
    br_A, br_B,                  ! Parameters for Brusselator
    br_C, br_D,                  ! Parameters for extended Brusselator
    lg_lambda,                   ! Parameter for Fisher-KPP equation
    bzfn_epsilon, bzfn_delta, bzfn_lambda, bzfn_mu, ! Parameters for Oregonator model
    lor_r, lor_sigma, lor_b,     ! Parameters for Lorenz system
    equation_name,               ! Name of the system to simulate
    dtreacpar,                   ! Timestep restriction parameter
    rd_particles, rd_source_split 
/
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
