<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: mod_afld Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPI-AMRVAC<span id="projectnumber">&#160;3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mod_afld Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Module for including anisotropic flux limited diffusion (AFLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information.  
<a href="namespacemod__afld.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:af061aa858d2bb7d78828d23afbe78291" id="r_af061aa858d2bb7d78828d23afbe78291"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#af061aa858d2bb7d78828d23afbe78291">afld_params_read</a> (files)</td></tr>
<tr class="memdesc:af061aa858d2bb7d78828d23afbe78291"><td class="mdescLeft">&#160;</td><td class="mdescRight">public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a>  <br /></td></tr>
<tr class="separator:af061aa858d2bb7d78828d23afbe78291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705680adea8d29d8250119dec25e4a70" id="r_a705680adea8d29d8250119dec25e4a70"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a705680adea8d29d8250119dec25e4a70">afld_init</a> (he_abundance, rhd_radiation_diffusion, afld_gamma)</td></tr>
<tr class="memdesc:a705680adea8d29d8250119dec25e4a70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ...  <br /></td></tr>
<tr class="separator:a705680adea8d29d8250119dec25e4a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ce83136673f187e8bbcd22062c249a4" id="r_a4ce83136673f187e8bbcd22062c249a4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a4ce83136673f187e8bbcd22062c249a4">get_afld_rad_force</a> (qdt, ixil, ixol, wct, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:a4ce83136673f187e8bbcd22062c249a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force  <br /></td></tr>
<tr class="separator:a4ce83136673f187e8bbcd22062c249a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a214ac74441479c883fac53192ddbad" id="r_a9a214ac74441479c883fac53192ddbad"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a9a214ac74441479c883fac53192ddbad">afld_radforce_get_dt</a> (w, ixil, ixol, dtnew, dxd, x)</td></tr>
<tr class="separator:a9a214ac74441479c883fac53192ddbad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6227c4f754590112d4ff98a4610cd87" id="r_ac6227c4f754590112d4ff98a4610cd87"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ac6227c4f754590112d4ff98a4610cd87">get_afld_energy_interact</a> (qdt, ixil, ixol, wct, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:ac6227c4f754590112d4ff98a4610cd87"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the energy exchange between gas and radiation  <br /></td></tr>
<tr class="separator:ac6227c4f754590112d4ff98a4610cd87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8704dc4f298466b7f931aae68dcb380" id="r_ad8704dc4f298466b7f931aae68dcb380"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ad8704dc4f298466b7f931aae68dcb380">afld_get_opacity</a> (w, x, ixil, ixol, fld_kappa)</td></tr>
<tr class="memdesc:ad8704dc4f298466b7f931aae68dcb380"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in Rosseland-mean opacities from OPAL tables. Table opacity values are given in bas...">mod_opal_opacity</a>.  <br /></td></tr>
<tr class="separator:ad8704dc4f298466b7f931aae68dcb380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a534fb3f2e92a62c9e7518f901ce3ae57" id="r_a534fb3f2e92a62c9e7518f901ce3ae57"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57">afld_get_fluxlimiter</a> (w, x, ixil, ixol, fld_lambda, fld_r, nth)</td></tr>
<tr class="memdesc:a534fb3f2e92a62c9e7518f901ce3ae57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path.  <br /></td></tr>
<tr class="separator:a534fb3f2e92a62c9e7518f901ce3ae57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ae4607d5a4b846f75b99c2e56e756c7" id="r_a3ae4607d5a4b846f75b99c2e56e756c7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a3ae4607d5a4b846f75b99c2e56e756c7">afld_get_radflux</a> (w, x, ixil, ixol, rad_flux, nth)</td></tr>
<tr class="memdesc:a3ae4607d5a4b846f75b99c2e56e756c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Flux Calculate the Flux using the fld closure relation F = -c*lambda/(kappa*rho) *grad E.  <br /></td></tr>
<tr class="separator:a3ae4607d5a4b846f75b99c2e56e756c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62a3a09185251d685c0fc17dca38fe0" id="r_af62a3a09185251d685c0fc17dca38fe0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#af62a3a09185251d685c0fc17dca38fe0">afld_get_eddington</a> (w, x, ixil, ixol, eddington_tensor, nth)</td></tr>
<tr class="memdesc:af62a3a09185251d685c0fc17dca38fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Eddington-tensor Stores Eddington-tensor in w-array.  <br /></td></tr>
<tr class="separator:af62a3a09185251d685c0fc17dca38fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af14da4ee0effb21d55f01e0410b0d1" id="r_a9af14da4ee0effb21d55f01e0410b0d1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a9af14da4ee0effb21d55f01e0410b0d1">afld_get_radpress</a> (w, x, ixil, ixol, rad_pressure, nth)</td></tr>
<tr class="memdesc:a9af14da4ee0effb21d55f01e0410b0d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Pressure Returns Radiation Pressure as tensor.  <br /></td></tr>
<tr class="separator:a9af14da4ee0effb21d55f01e0410b0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f419887d90c3edb888b2a75da3e213" id="r_a68f419887d90c3edb888b2a75da3e213"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a68f419887d90c3edb888b2a75da3e213">diffuse_e_rad_mg</a> (dtfactor, qdt, qtc, psa, psb)</td></tr>
<tr class="memdesc:a68f419887d90c3edb888b2a75da3e213"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library.  <br /></td></tr>
<tr class="separator:a68f419887d90c3edb888b2a75da3e213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f92ed2631515e146db25f084214c9" id="r_a9a4f92ed2631515e146db25f084214c9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a9a4f92ed2631515e146db25f084214c9">evaluate_e_rad_mg</a> (qtc, psa)</td></tr>
<tr class="memdesc:a9a4f92ed2631515e146db25f084214c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <br /></td></tr>
<tr class="separator:a9a4f92ed2631515e146db25f084214c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb6f45fae873e367229e0d1c201a299" id="r_aebb6f45fae873e367229e0d1c201a299"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#aebb6f45fae873e367229e0d1c201a299">put_diffterm_onegrid</a> (ixil, ixol, w)</td></tr>
<tr class="memdesc:aebb6f45fae873e367229e0d1c201a299"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <br /></td></tr>
<tr class="separator:aebb6f45fae873e367229e0d1c201a299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292222016c4df688c77b80961c9b821b" id="r_a292222016c4df688c77b80961c9b821b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a292222016c4df688c77b80961c9b821b">afld_get_diffcoef_central</a> (w, wct, x, ixil, ixol)</td></tr>
<tr class="memdesc:a292222016c4df688c77b80961c9b821b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates cell-centered diffusion coefficient to be used in multigrid.  <br /></td></tr>
<tr class="separator:a292222016c4df688c77b80961c9b821b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5289df9bf8e1e13a2af0815ef926a5" id="r_a9d5289df9bf8e1e13a2af0815ef926a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a9d5289df9bf8e1e13a2af0815ef926a5">update_diffcoeff</a> (psa)</td></tr>
<tr class="separator:a9d5289df9bf8e1e13a2af0815ef926a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce190d6c038097eb591a808d0c4525f" id="r_a0ce190d6c038097eb591a808d0c4525f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a0ce190d6c038097eb591a808d0c4525f">afld_smooth_diffcoef</a> (w, ixil, ixol, idir)</td></tr>
<tr class="memdesc:a0ce190d6c038097eb591a808d0c4525f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use running average on Diffusion coefficient.  <br /></td></tr>
<tr class="separator:a0ce190d6c038097eb591a808d0c4525f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a9232590db897662fda786c71365a09" id="r_a9a9232590db897662fda786c71365a09"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a9a9232590db897662fda786c71365a09">energy_interaction</a> (w, wct, x, ixil, ixol)</td></tr>
<tr class="memdesc:a9a9232590db897662fda786c71365a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implicit scheme. These sourceterms are applied using the root-finding of a 4th order polynomial This routine loops over every cell in the domain and computes the coefficients of the polynomials in every cell.  <br /></td></tr>
<tr class="separator:a9a9232590db897662fda786c71365a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb940836590e32462520c6b43fecac3" id="r_a7eb940836590e32462520c6b43fecac3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a7eb940836590e32462520c6b43fecac3">bisection_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:a7eb940836590e32462520c6b43fecac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the bisection method.  <br /></td></tr>
<tr class="separator:a7eb940836590e32462520c6b43fecac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f3dbfffba4e7c41a1e40821ce15ab7" id="r_ab2f3dbfffba4e7c41a1e40821ce15ab7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ab2f3dbfffba4e7c41a1e40821ce15ab7">newton_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:ab2f3dbfffba4e7c41a1e40821ce15ab7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Newton-Ralphson method.  <br /></td></tr>
<tr class="separator:ab2f3dbfffba4e7c41a1e40821ce15ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76aa76ff434d1bda3094e5fff8a54b7" id="r_aa76aa76ff434d1bda3094e5fff8a54b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#aa76aa76ff434d1bda3094e5fff8a54b7">halley_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:aa76aa76ff434d1bda3094e5fff8a54b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Halley method.  <br /></td></tr>
<tr class="separator:aa76aa76ff434d1bda3094e5fff8a54b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9ba324228b7daabfdf1ee26a7c88026" id="r_aa9ba324228b7daabfdf1ee26a7c88026"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#aa9ba324228b7daabfdf1ee26a7c88026">polynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:aa9ba324228b7daabfdf1ee26a7c88026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:aa9ba324228b7daabfdf1ee26a7c88026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a78bd59aab671d27b82fd0f79713d1a" id="r_a8a78bd59aab671d27b82fd0f79713d1a"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a8a78bd59aab671d27b82fd0f79713d1a">dpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a8a78bd59aab671d27b82fd0f79713d1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate first derivative of polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:a8a78bd59aab671d27b82fd0f79713d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e713c279492245503edda6384cef4a" id="r_a77e713c279492245503edda6384cef4a"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a77e713c279492245503edda6384cef4a">ddpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a77e713c279492245503edda6384cef4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate second derivative of polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:a77e713c279492245503edda6384cef4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a216f97d4641cd0b010a21bbbd5b7c869" id="r_a216f97d4641cd0b010a21bbbd5b7c869"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a216f97d4641cd0b010a21bbbd5b7c869">fld_eint_split</a> = .false.</td></tr>
<tr class="memdesc:a216f97d4641cd0b010a21bbbd5b7c869"><td class="mdescLeft">&#160;</td><td class="mdescRight">source split for energy interact and radforce:  <br /></td></tr>
<tr class="separator:a216f97d4641cd0b010a21bbbd5b7c869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20315084fb9735fef24b8f7a22a349d" id="r_ad20315084fb9735fef24b8f7a22a349d"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ad20315084fb9735fef24b8f7a22a349d">fld_radforce_split</a> = .false.</td></tr>
<tr class="separator:ad20315084fb9735fef24b8f7a22a349d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea768f07bef24636da517b4ee613b51" id="r_a4ea768f07bef24636da517b4ee613b51"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a4ea768f07bef24636da517b4ee613b51">fld_kappa0</a> = 0.34d0</td></tr>
<tr class="memdesc:a4ea768f07bef24636da517b4ee613b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opacity per unit of unit_density.  <br /></td></tr>
<tr class="separator:a4ea768f07bef24636da517b4ee613b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36cf9da279835877db79517593f9773" id="r_ae36cf9da279835877db79517593f9773"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ae36cf9da279835877db79517593f9773">afld_mu</a> = 0.6d0</td></tr>
<tr class="memdesc:ae36cf9da279835877db79517593f9773"><td class="mdescLeft">&#160;</td><td class="mdescRight">mean particle mass  <br /></td></tr>
<tr class="separator:ae36cf9da279835877db79517593f9773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a3f0b3cb7f2bf5d523cae57e1ba0d14" id="r_a4a3f0b3cb7f2bf5d523cae57e1ba0d14"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a4a3f0b3cb7f2bf5d523cae57e1ba0d14">fld_bisect_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a4a3f0b3cb7f2bf5d523cae57e1ba0d14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy.  <br /></td></tr>
<tr class="separator:a4a3f0b3cb7f2bf5d523cae57e1ba0d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dfc6250beb84fbb70e3e21571d4ab4f" id="r_a5dfc6250beb84fbb70e3e21571d4ab4f"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a5dfc6250beb84fbb70e3e21571d4ab4f">fld_diff_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a5dfc6250beb84fbb70e3e21571d4ab4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for adi method for radiative Energy diffusion.  <br /></td></tr>
<tr class="separator:a5dfc6250beb84fbb70e3e21571d4ab4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace04332127fd83710700fd46b1cd9a88" id="r_ace04332127fd83710700fd46b1cd9a88"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ace04332127fd83710700fd46b1cd9a88">diff_crit</a></td></tr>
<tr class="memdesc:ace04332127fd83710700fd46b1cd9a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number for splitting the diffusion module.  <br /></td></tr>
<tr class="separator:ace04332127fd83710700fd46b1cd9a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f033efe15a187dbef91fc708de9c42e" id="r_a8f033efe15a187dbef91fc708de9c42e"><td class="memItemLeft" align="right" valign="top">character(len=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a8f033efe15a187dbef91fc708de9c42e">fld_opacity_law</a></td></tr>
<tr class="memdesc:a8f033efe15a187dbef91fc708de9c42e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use constant Opacity?  <br /></td></tr>
<tr class="separator:a8f033efe15a187dbef91fc708de9c42e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab585bc66c9a64f80d7718f0d17ebc1cf" id="r_ab585bc66c9a64f80d7718f0d17ebc1cf"><td class="memItemLeft" align="right" valign="top">character(len=50)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ab585bc66c9a64f80d7718f0d17ebc1cf">fld_opal_table</a> = 'Y09800'</td></tr>
<tr class="separator:ab585bc66c9a64f80d7718f0d17ebc1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ae06bf2c058e6700a663662495da48" id="r_a61ae06bf2c058e6700a663662495da48"><td class="memItemLeft" align="right" valign="top">character(len=16)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a61ae06bf2c058e6700a663662495da48">fld_fluxlimiter</a> = 'Pomraning'</td></tr>
<tr class="memdesc:a61ae06bf2c058e6700a663662495da48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion limit lambda = 0.33.  <br /></td></tr>
<tr class="separator:a61ae06bf2c058e6700a663662495da48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88338c74496a8ef765f476f93fb0cda" id="r_ae88338c74496a8ef765f476f93fb0cda"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ae88338c74496a8ef765f476f93fb0cda">i_diff_mg</a></td></tr>
<tr class="separator:ae88338c74496a8ef765f476f93fb0cda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab600478175e32e54507930fa5a453c8b" id="r_ab600478175e32e54507930fa5a453c8b"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ab600478175e32e54507930fa5a453c8b">afld_diff_scheme</a> = 'mg'</td></tr>
<tr class="memdesc:ab600478175e32e54507930fa5a453c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to solve diffusion part.  <br /></td></tr>
<tr class="separator:ab600478175e32e54507930fa5a453c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8e9d9fd456e918479fe5a4bde21ad8" id="r_a0e8e9d9fd456e918479fe5a4bde21ad8"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a0e8e9d9fd456e918479fe5a4bde21ad8">fld_interaction_method</a> = 'Halley'</td></tr>
<tr class="memdesc:a0e8e9d9fd456e918479fe5a4bde21ad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to find the root for the energy interaction polynomial.  <br /></td></tr>
<tr class="separator:a0e8e9d9fd456e918479fe5a4bde21ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a770d35524300ee9a804b31ce105db" id="r_a85a770d35524300ee9a804b31ce105db"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a85a770d35524300ee9a804b31ce105db">fld_diff_testcase</a> = .false.</td></tr>
<tr class="memdesc:a85a770d35524300ee9a804b31ce105db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Diffusion coefficient to unity.  <br /></td></tr>
<tr class="separator:a85a770d35524300ee9a804b31ce105db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada0be98793916c578ed467d51c7bf03a" id="r_ada0be98793916c578ed467d51c7bf03a"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ada0be98793916c578ed467d51c7bf03a">diff_coef_filter</a> = .false.</td></tr>
<tr class="memdesc:ada0be98793916c578ed467d51c7bf03a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take running average for Diffusion coefficient.  <br /></td></tr>
<tr class="separator:ada0be98793916c578ed467d51c7bf03a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4cf3d2c4cd5575fd78ff97e42b9a44d" id="r_ad4cf3d2c4cd5575fd78ff97e42b9a44d"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ad4cf3d2c4cd5575fd78ff97e42b9a44d">size_d_filter</a> = 1</td></tr>
<tr class="separator:ad4cf3d2c4cd5575fd78ff97e42b9a44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acfbf67de8bb631f56ecaa69e08a452" id="r_a3acfbf67de8bb631f56ecaa69e08a452"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a3acfbf67de8bb631f56ecaa69e08a452">flux_lim_filter</a> = .false.</td></tr>
<tr class="memdesc:a3acfbf67de8bb631f56ecaa69e08a452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a running average over the fluxlimiter.  <br /></td></tr>
<tr class="separator:a3acfbf67de8bb631f56ecaa69e08a452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96ebc2df4145cc8f20721781bb62633" id="r_ae96ebc2df4145cc8f20721781bb62633"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#ae96ebc2df4145cc8f20721781bb62633">size_l_filter</a> = 1</td></tr>
<tr class="separator:ae96ebc2df4145cc8f20721781bb62633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ca3635375053ac0b5bcc38899646d3" id="r_a02ca3635375053ac0b5bcc38899646d3"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a02ca3635375053ac0b5bcc38899646d3">lineforce_opacities</a> = .false.</td></tr>
<tr class="memdesc:a02ca3635375053ac0b5bcc38899646d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use or dont use lineforce opacities.  <br /></td></tr>
<tr class="separator:a02ca3635375053ac0b5bcc38899646d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0e26fb19d7aeb30d836e67db9f00e7" id="r_a8a0e26fb19d7aeb30d836e67db9f00e7"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#a8a0e26fb19d7aeb30d836e67db9f00e7">diffcrash_resume</a> = .true.</td></tr>
<tr class="memdesc:a8a0e26fb19d7aeb30d836e67db9f00e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume run when multigrid returns error.  <br /></td></tr>
<tr class="separator:a8a0e26fb19d7aeb30d836e67db9f00e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af47b1bedd6a94866e05d77fe9db2006c" id="r_af47b1bedd6a94866e05d77fe9db2006c"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__afld.html#af47b1bedd6a94866e05d77fe9db2006c">dt_diff</a> = 0.d0</td></tr>
<tr class="memdesc:af47b1bedd6a94866e05d77fe9db2006c"><td class="mdescLeft">&#160;</td><td class="mdescRight">running timestep for diffusion solver, initialised as zero  <br /></td></tr>
<tr class="separator:af47b1bedd6a94866e05d77fe9db2006c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module for including anisotropic flux limited diffusion (AFLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a292222016c4df688c77b80961c9b821b" name="a292222016c4df688c77b80961c9b821b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a292222016c4df688c77b80961c9b821b">&#9670;&#160;</a></span>afld_get_diffcoef_central()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::afld_get_diffcoef_central </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates cell-centered diffusion coefficient to be used in multigrid. </p>
<p>calculate diffusion coefficient</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00683">683</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a292222016c4df688c77b80961c9b821b_cgraph.png" border="0" usemap="#anamespacemod__afld_a292222016c4df688c77b80961c9b821b_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a292222016c4df688c77b80961c9b821b_cgraph" id="anamespacemod__afld_a292222016c4df688c77b80961c9b821b_cgraph">
<area shape="rect" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="5,63,148,103"/>
<area shape="rect" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="210,5,353,45"/>
<area shape="poly" title=" " alt="" coords="147,60,196,46,198,51,149,65"/>
<area shape="rect" href="namespacemod__afld.html#ad8704dc4f298466b7f931aae68dcb380" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="415,35,557,75"/>
<area shape="poly" title=" " alt="" coords="148,75,401,58,401,63,149,80"/>
<area shape="rect" href="namespacemod__afld.html#a0ce190d6c038097eb591a808d0c4525f" title="Use running average on Diffusion coefficient." alt="" coords="196,120,367,160"/>
<area shape="poly" title=" " alt="" coords="149,100,197,114,195,119,147,105"/>
<area shape="poly" title=" " alt="" coords="353,33,401,40,401,45,352,38"/>
</map>
</div>

</div>
</div>
<a id="af62a3a09185251d685c0fc17dca38fe0" name="af62a3a09185251d685c0fc17dca38fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af62a3a09185251d685c0fc17dca38fe0">&#9670;&#160;</a></span>afld_get_eddington()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::afld_get_eddington </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>eddington_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Eddington-tensor Stores Eddington-tensor in w-array. </p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate radiation pressure P = (lambda + lambda^2 R^2)*E</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00463">463</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_af62a3a09185251d685c0fc17dca38fe0_cgraph.png" border="0" usemap="#anamespacemod__afld_af62a3a09185251d685c0fc17dca38fe0_cgraph" alt=""/></div>
<map name="anamespacemod__afld_af62a3a09185251d685c0fc17dca38fe0_cgraph" id="anamespacemod__afld_af62a3a09185251d685c0fc17dca38fe0_cgraph">
<area shape="rect" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="5,35,148,75"/>
<area shape="rect" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="196,5,339,45"/>
<area shape="poly" title=" " alt="" coords="148,41,182,36,183,41,148,46"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="387,42,569,67"/>
<area shape="poly" title=" " alt="" coords="149,54,196,55,339,55,373,54,373,60,339,60,196,60,148,59"/>
<area shape="poly" title=" " alt="" coords="339,33,374,37,373,43,339,38"/>
</map>
</div>

</div>
</div>
<a id="a534fb3f2e92a62c9e7518f901ce3ae57" name="a534fb3f2e92a62c9e7518f901ce3ae57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a534fb3f2e92a62c9e7518f901ce3ae57">&#9670;&#160;</a></span>afld_get_fluxlimiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_get_fluxlimiter </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>fld_lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>fld_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path. </p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Levermore and Pomraning: lambda = (2 + R)/(6 + 3R + R^2)</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Minerbo:</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00337">337</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a534fb3f2e92a62c9e7518f901ce3ae57_cgraph.png" border="0" usemap="#anamespacemod__afld_a534fb3f2e92a62c9e7518f901ce3ae57_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a534fb3f2e92a62c9e7518f901ce3ae57_cgraph" id="anamespacemod__afld_a534fb3f2e92a62c9e7518f901ce3ae57_cgraph">
<area shape="rect" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="5,35,148,75"/>
<area shape="rect" href="namespacemod__afld.html#ad8704dc4f298466b7f931aae68dcb380" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="216,5,359,45"/>
<area shape="poly" title=" " alt="" coords="148,42,202,35,203,40,149,47"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="196,70,379,95"/>
<area shape="poly" title=" " alt="" coords="149,62,183,66,182,71,148,67"/>
</map>
</div>

</div>
</div>
<a id="ad8704dc4f298466b7f931aae68dcb380" name="ad8704dc4f298466b7f931aae68dcb380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8704dc4f298466b7f931aae68dcb380">&#9670;&#160;</a></span>afld_get_opacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_get_opacity </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>fld_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in Rosseland-mean opacities from OPAL tables. Table opacity values are given in bas...">mod_opal_opacity</a>. </p>
<p>Take lower value of rho in domain</p>
<p>Opacity bump</p>
<p>Take lower value of rho in domain</p>
<p>Hard limit on kappa</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00265">265</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_ad8704dc4f298466b7f931aae68dcb380_cgraph.png" border="0" usemap="#anamespacemod__afld_ad8704dc4f298466b7f931aae68dcb380_cgraph" alt=""/></div>
<map name="anamespacemod__afld_ad8704dc4f298466b7f931aae68dcb380_cgraph" id="anamespacemod__afld_ad8704dc4f298466b7f931aae68dcb380_cgraph">
<area shape="rect" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="5,5,148,45"/>
<area shape="rect" href="namespacemod__opal__opacity.html#a8a6b7571280893a4d5716c993e03c910" title="This subroutine calculates the opacity for a given temperature&#45;density structure. Opacities are read ..." alt="" coords="196,5,364,45"/>
<area shape="poly" title=" " alt="" coords="148,23,182,23,182,28,148,28"/>
</map>
</div>

</div>
</div>
<a id="a3ae4607d5a4b846f75b99c2e56e756c7" name="a3ae4607d5a4b846f75b99c2e56e756c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae4607d5a4b846f75b99c2e56e756c7">&#9670;&#160;</a></span>afld_get_radflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_get_radflux </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s, 1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Flux Calculate the Flux using the fld closure relation F = -c*lambda/(kappa*rho) *grad E. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00438">438</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a3ae4607d5a4b846f75b99c2e56e756c7_cgraph.png" border="0" usemap="#anamespacemod__afld_a3ae4607d5a4b846f75b99c2e56e756c7_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a3ae4607d5a4b846f75b99c2e56e756c7_cgraph" id="anamespacemod__afld_a3ae4607d5a4b846f75b99c2e56e756c7_cgraph">
<area shape="rect" title="Calculate Radiation Flux Calculate the Flux using the fld closure relation F = &#45;c*lambda/(kappa*rho) ..." alt="" coords="5,48,148,88"/>
<area shape="rect" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="196,48,339,88"/>
<area shape="poly" title=" " alt="" coords="148,65,183,65,183,71,148,71"/>
<area shape="rect" href="namespacemod__afld.html#ad8704dc4f298466b7f931aae68dcb380" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="407,5,549,45"/>
<area shape="poly" title=" " alt="" coords="141,45,196,33,298,23,393,21,393,26,298,29,196,39,142,50"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="387,85,569,110"/>
<area shape="poly" title=" " alt="" coords="140,85,196,97,286,104,373,103,373,108,286,109,196,103,139,91"/>
<area shape="poly" title=" " alt="" coords="339,51,392,40,393,45,340,56"/>
<area shape="poly" title=" " alt="" coords="339,75,374,80,373,85,339,81"/>
</map>
</div>

</div>
</div>
<a id="a9af14da4ee0effb21d55f01e0410b0d1" name="a9af14da4ee0effb21d55f01e0410b0d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9af14da4ee0effb21d55f01e0410b0d1">&#9670;&#160;</a></span>afld_get_radpress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_get_radpress </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Pressure Returns Radiation Pressure as tensor. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00517">517</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a9af14da4ee0effb21d55f01e0410b0d1_cgraph.png" border="0" usemap="#anamespacemod__afld_a9af14da4ee0effb21d55f01e0410b0d1_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a9af14da4ee0effb21d55f01e0410b0d1_cgraph" id="anamespacemod__afld_a9af14da4ee0effb21d55f01e0410b0d1_cgraph">
<area shape="rect" title="Calculate Radiation Pressure Returns Radiation Pressure as tensor." alt="" coords="5,5,148,45"/>
<area shape="rect" href="namespacemod__afld.html#af62a3a09185251d685c0fc17dca38fe0" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="196,5,339,45"/>
<area shape="poly" title=" " alt="" coords="148,23,183,23,183,28,148,28"/>
</map>
</div>

</div>
</div>
<a id="a705680adea8d29d8250119dec25e4a70" name="a705680adea8d29d8250119dec25e4a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705680adea8d29d8250119dec25e4a70">&#9670;&#160;</a></span>afld_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_init </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>he_abundance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>rhd_radiation_diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>afld_gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ... </p>
<p>allocate boundary conditions</p>
<p>read par files</p>
<p>Need mean molecular weight</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00092">92</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a705680adea8d29d8250119dec25e4a70_cgraph.png" border="0" usemap="#anamespacemod__afld_a705680adea8d29d8250119dec25e4a70_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a705680adea8d29d8250119dec25e4a70_cgraph" id="anamespacemod__afld_a705680adea8d29d8250119dec25e4a70_cgraph">
<area shape="rect" title="Initialising FLD&#45;module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variable..." alt="" coords="5,127,148,152"/>
<area shape="rect" href="namespacemod__afld.html#af061aa858d2bb7d78828d23afbe78291" title="public methods these are called in mod_rhd_phys" alt="" coords="196,5,403,31"/>
<area shape="poly" title=" " alt="" coords="88,125,132,83,162,61,195,41,215,32,217,37,197,46,165,65,136,88,92,129"/>
<area shape="rect" href="namespacemod__afld.html#a68f419887d90c3edb888b2a75da3e213" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="225,55,374,95"/>
<area shape="poly" title=" " alt="" coords="121,124,215,97,217,102,123,129"/>
<area shape="rect" href="namespacemod__afld.html#a9a4f92ed2631515e146db25f084214c9" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="226,119,373,159"/>
<area shape="poly" title=" " alt="" coords="148,137,212,137,212,142,148,142"/>
<area shape="rect" href="namespacemod__opal__opacity.html#a7c35946184618fb6e09dc3257316b79d" title="This subroutine is called when the FLD radiation module is initialised. The OPAL tables for different..." alt="" coords="215,183,384,223"/>
<area shape="poly" title=" " alt="" coords="123,150,217,177,215,182,121,155"/>
<area shape="rect" href="namespacemod__variables.html#a924c3b2f4e13f6f6432de212ac790966" title="Set extra variable in w, which is not advected and has no boundary conditions. This has to be done af..." alt="" coords="226,247,373,287"/>
<area shape="poly" title=" " alt="" coords="92,150,137,191,166,213,197,233,215,241,212,246,195,238,163,218,133,195,89,154"/>
</map>
</div>

</div>
</div>
<a id="af061aa858d2bb7d78828d23afbe78291" name="af061aa858d2bb7d78828d23afbe78291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af061aa858d2bb7d78828d23afbe78291">&#9670;&#160;</a></span>afld_params_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::afld_params_read </td>
          <td>(</td>
          <td class="paramtype">character(len=*), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>files</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a> </p>
<p>Reading in fld-list parameters from .par file </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00066">66</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a9a214ac74441479c883fac53192ddbad" name="a9a214ac74441479c883fac53192ddbad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a214ac74441479c883fac53192ddbad">&#9670;&#160;</a></span>afld_radforce_get_dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::afld_radforce_get_dt </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>dtnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00216">216</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a9a214ac74441479c883fac53192ddbad_cgraph.png" border="0" usemap="#anamespacemod__afld_a9a214ac74441479c883fac53192ddbad_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a9a214ac74441479c883fac53192ddbad_cgraph" id="anamespacemod__afld_a9a214ac74441479c883fac53192ddbad_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,180,75"/>
<area shape="rect" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="228,5,371,45"/>
<area shape="poly" title=" " alt="" coords="180,40,214,35,214,40,181,45"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="419,42,601,67"/>
<area shape="poly" title=" " alt="" coords="180,54,228,55,371,55,405,54,405,60,371,60,228,60,180,59"/>
<area shape="poly" title=" " alt="" coords="371,33,406,37,405,43,371,38"/>
</map>
</div>

</div>
</div>
<a id="a0ce190d6c038097eb591a808d0c4525f" name="a0ce190d6c038097eb591a808d0c4525f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce190d6c038097eb591a808d0c4525f">&#9670;&#160;</a></span>afld_smooth_diffcoef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::afld_smooth_diffcoef </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use running average on Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00733">733</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a7eb940836590e32462520c6b43fecac3" name="a7eb940836590e32462520c6b43fecac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb940836590e32462520c6b43fecac3">&#9670;&#160;</a></span>bisection_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::bisection_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the bisection method. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00843">843</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a7eb940836590e32462520c6b43fecac3_cgraph.png" border="0" usemap="#anamespacemod__afld_a7eb940836590e32462520c6b43fecac3_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a7eb940836590e32462520c6b43fecac3_cgraph" id="anamespacemod__afld_a7eb940836590e32462520c6b43fecac3_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="5,5,155,45"/>
<area shape="rect" href="namespacemod__afld.html#aa9ba324228b7daabfdf1ee26a7c88026" title="Evaluate polynomial at argument e_gas." alt="" coords="203,5,365,45"/>
<area shape="poly" title=" " alt="" coords="155,23,189,23,189,28,155,28"/>
</map>
</div>

</div>
</div>
<a id="a77e713c279492245503edda6384cef4a" name="a77e713c279492245503edda6384cef4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77e713c279492245503edda6384cef4a">&#9670;&#160;</a></span>ddpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_afld::ddpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate second derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00985">985</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a68f419887d90c3edb888b2a75da3e213" name="a68f419887d90c3edb888b2a75da3e213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f419887d90c3edb888b2a75da3e213">&#9670;&#160;</a></span>diffuse_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::diffuse_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dtfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library. </p>
<p>Set diffusion timestep, add previous timestep if mg did not converge:</p>
<p>replace call set_rhs(mg, -1/dt, 0.0_dp)</p>
<p>Reset dt_diff when diffusion worked out</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00536">536</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a68f419887d90c3edb888b2a75da3e213_cgraph.png" border="0" usemap="#anamespacemod__afld_a68f419887d90c3edb888b2a75da3e213_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a68f419887d90c3edb888b2a75da3e213_cgraph" id="anamespacemod__afld_a68f419887d90c3edb888b2a75da3e213_cgraph">
<area shape="rect" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="5,69,155,109"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#adba5ed257a7b740fc0152041faa8f490" title="Copy from multigrid tree with one layer of ghost cells. Corner ghost cells are not used/set." alt="" coords="209,5,391,45"/>
<area shape="poly" title=" " alt="" coords="149,67,217,47,219,52,150,72"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#a6844c00572acb078d62136c84a07a4c8" title="Copy a variable to the multigrid tree, including a layer of ghost cells." alt="" coords="211,69,389,109"/>
<area shape="poly" title=" " alt="" coords="155,87,197,87,197,92,155,92"/>
<area shape="rect" href="namespacemod__afld.html#a9d5289df9bf8e1e13a2af0815ef926a5" title=" " alt="" coords="203,134,397,159"/>
<area shape="poly" title=" " alt="" coords="156,106,238,128,237,133,154,111"/>
</map>
</div>

</div>
</div>
<a id="a8a78bd59aab671d27b82fd0f79713d1a" name="a8a78bd59aab671d27b82fd0f79713d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a78bd59aab671d27b82fd0f79713d1a">&#9670;&#160;</a></span>dpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_afld::dpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate first derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00975">975</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a9a9232590db897662fda786c71365a09" name="a9a9232590db897662fda786c71365a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a9232590db897662fda786c71365a09">&#9670;&#160;</a></span>energy_interaction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::energy_interaction </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implicit scheme. These sourceterms are applied using the root-finding of a 4th order polynomial This routine loops over every cell in the domain and computes the coefficients of the polynomials in every cell. </p>
<p>e_gas is the INTERNAL ENERGY without KINETIC ENERGY</p>
<p>Calculate coefficients for polynomial</p>
<p>Loop over every cell for rootfinding method</p>
<p>advance E_rad</p>
<p>Update gas-energy in w, internal + kinetic</p>
<p>Beginning of module substracted wCT Ekin So now add wCT Ekin</p>
<p>Update rad-energy in w</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00764">764</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a9a9232590db897662fda786c71365a09_cgraph.png" border="0" usemap="#anamespacemod__afld_a9a9232590db897662fda786c71365a09_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a9a9232590db897662fda786c71365a09_cgraph" id="anamespacemod__afld_a9a9232590db897662fda786c71365a09_cgraph">
<area shape="rect" title="This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implic..." alt="" coords="5,95,217,121"/>
<area shape="rect" href="namespacemod__afld.html#ad8704dc4f298466b7f931aae68dcb380" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="287,5,430,45"/>
<area shape="poly" title=" " alt="" coords="150,93,284,47,286,52,151,98"/>
<area shape="rect" href="namespacemod__afld.html#a7eb940836590e32462520c6b43fecac3" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="743,88,892,128"/>
<area shape="poly" title=" " alt="" coords="218,105,729,105,729,111,218,111"/>
<area shape="rect" href="namespacemod__afld.html#aa76aa76ff434d1bda3094e5fff8a54b7" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="265,121,452,146"/>
<area shape="poly" title=" " alt="" coords="218,116,252,120,251,125,217,122"/>
<area shape="rect" href="namespacemod__afld.html#ab2f3dbfffba4e7c41a1e40821ce15ab7" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="500,121,695,146"/>
<area shape="poly" title=" " alt="" coords="143,118,199,139,266,156,334,162,403,161,468,155,524,146,525,151,468,160,403,166,334,167,265,161,197,144,141,123"/>
<area shape="poly" title=" " alt="" coords="452,131,487,131,487,136,452,136"/>
<area shape="poly" title=" " alt="" coords="695,119,729,115,729,121,696,125"/>
</map>
</div>

</div>
</div>
<a id="a9a4f92ed2631515e146db25f084214c9" name="a9a4f92ed2631515e146db25f084214c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4f92ed2631515e146db25f084214c9">&#9670;&#160;</a></span>evaluate_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::evaluate_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00640">640</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a9a4f92ed2631515e146db25f084214c9_cgraph.png" border="0" usemap="#anamespacemod__afld_a9a4f92ed2631515e146db25f084214c9_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a9a4f92ed2631515e146db25f084214c9_cgraph" id="anamespacemod__afld_a9a4f92ed2631515e146db25f084214c9_cgraph">
<area shape="rect" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="5,69,152,109"/>
<area shape="rect" href="namespacemod__ghostcells__update.html#a1b945d19ee179d85b1b4a719a8dfcad6" title="do update ghost cells of all blocks including physical boundaries" alt="" coords="209,5,385,45"/>
<area shape="poly" title=" " alt="" coords="147,67,215,47,216,52,149,72"/>
<area shape="rect" href="namespacemod__afld.html#aebb6f45fae873e367229e0d1c201a299" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="212,69,383,109"/>
<area shape="poly" title=" " alt="" coords="153,87,198,87,198,92,153,92"/>
<area shape="rect" href="namespacemod__afld.html#a9d5289df9bf8e1e13a2af0815ef926a5" title=" " alt="" coords="200,134,395,159"/>
<area shape="poly" title=" " alt="" coords="153,106,201,119,235,128,234,133,199,124,152,111"/>
</map>
</div>

</div>
</div>
<a id="ac6227c4f754590112d4ff98a4610cd87" name="ac6227c4f754590112d4ff98a4610cd87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6227c4f754590112d4ff98a4610cd87">&#9670;&#160;</a></span>get_afld_energy_interact()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::get_afld_energy_interact </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the energy exchange between gas and radiation </p>
<p>Calculate and add sourceterms</p>
<p>Add energy sourceterms</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00242">242</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_ac6227c4f754590112d4ff98a4610cd87_cgraph.png" border="0" usemap="#anamespacemod__afld_ac6227c4f754590112d4ff98a4610cd87_cgraph" alt=""/></div>
<map name="anamespacemod__afld_ac6227c4f754590112d4ff98a4610cd87_cgraph" id="anamespacemod__afld_ac6227c4f754590112d4ff98a4610cd87_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles th..." alt="" coords="5,5,148,45"/>
<area shape="rect" href="namespacemod__afld.html#a9a9232590db897662fda786c71365a09" title="This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implic..." alt="" coords="196,13,408,38"/>
<area shape="poly" title=" " alt="" coords="148,23,182,23,182,28,148,28"/>
</map>
</div>

</div>
</div>
<a id="a4ce83136673f187e8bbcd22062c249a4" name="a4ce83136673f187e8bbcd22062c249a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ce83136673f187e8bbcd22062c249a4">&#9670;&#160;</a></span>get_afld_rad_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_afld::get_afld_rad_force </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force </p>
<p>Calculate and add sourceterms</p>
<p>Radiation force = kappa*rho/c *Flux = lambda gradE</p>
<p>Momentum equation source term</p>
<p>Energy equation source term (kinetic energy)</p>
<p>Photon tiring calculate tensor div_v !$OMP PARALLEL DO</p>
<p>!$OMP END PARALLEL DO</p>
<p>VARIABLE NAMES DIV ARE ACTUALLY GRADIENTS</p>
<p>eq 34 Turner and stone (Only 2D)</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00139">139</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a4ce83136673f187e8bbcd22062c249a4_cgraph.png" border="0" usemap="#anamespacemod__afld_a4ce83136673f187e8bbcd22062c249a4_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a4ce83136673f187e8bbcd22062c249a4_cgraph" id="anamespacemod__afld_a4ce83136673f187e8bbcd22062c249a4_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles th..." alt="" coords="5,59,148,99"/>
<area shape="rect" href="namespacemod__afld.html#af62a3a09185251d685c0fc17dca38fe0" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="196,59,339,99"/>
<area shape="poly" title=" " alt="" coords="148,76,183,76,183,81,148,81"/>
<area shape="rect" href="namespacemod__afld.html#a534fb3f2e92a62c9e7518f901ce3ae57" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="387,5,529,45"/>
<area shape="poly" title=" " alt="" coords="143,56,196,44,287,32,373,26,373,31,288,37,196,49,144,61"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="577,70,760,95"/>
<area shape="poly" title=" " alt="" coords="140,96,196,108,300,115,404,113,501,105,582,95,583,100,501,111,404,119,300,121,196,113,139,101"/>
<area shape="poly" title=" " alt="" coords="338,56,373,46,374,51,339,61"/>
<area shape="poly" title=" " alt="" coords="339,77,564,79,564,84,339,82"/>
<area shape="poly" title=" " alt="" coords="530,42,609,64,607,69,529,47"/>
</map>
</div>

</div>
</div>
<a id="aa76aa76ff434d1bda3094e5fff8a54b7" name="aa76aa76ff434d1bda3094e5fff8a54b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa76aa76ff434d1bda3094e5fff8a54b7">&#9670;&#160;</a></span>halley_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::halley_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Halley method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00934">934</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_aa76aa76ff434d1bda3094e5fff8a54b7_cgraph.png" border="0" usemap="#anamespacemod__afld_aa76aa76ff434d1bda3094e5fff8a54b7_cgraph" alt=""/></div>
<map name="anamespacemod__afld_aa76aa76ff434d1bda3094e5fff8a54b7_cgraph" id="anamespacemod__afld_aa76aa76ff434d1bda3094e5fff8a54b7_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="5,95,192,121"/>
<area shape="rect" href="namespacemod__afld.html#a77e713c279492245503edda6384cef4a" title="Evaluate second derivative of polynomial at argument e_gas." alt="" coords="248,5,427,45"/>
<area shape="poly" title=" " alt="" coords="135,93,265,47,267,53,137,98"/>
<area shape="rect" href="namespacemod__afld.html#a8a78bd59aab671d27b82fd0f79713d1a" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="483,72,653,112"/>
<area shape="poly" title=" " alt="" coords="192,102,469,93,469,98,192,108"/>
<area shape="rect" href="namespacemod__afld.html#ab2f3dbfffba4e7c41a1e40821ce15ab7" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="240,121,435,146"/>
<area shape="poly" title=" " alt="" coords="193,115,227,119,226,124,192,121"/>
<area shape="rect" href="namespacemod__afld.html#aa9ba324228b7daabfdf1ee26a7c88026" title="Evaluate polynomial at argument e_gas." alt="" coords="487,145,649,185"/>
<area shape="poly" title=" " alt="" coords="128,118,180,139,241,156,300,164,361,169,473,169,473,174,361,174,300,170,239,161,178,144,126,123"/>
<area shape="poly" title=" " alt="" coords="408,118,469,107,470,112,409,123"/>
<area shape="poly" title=" " alt="" coords="430,143,473,150,473,155,429,149"/>
</map>
</div>

</div>
</div>
<a id="ab2f3dbfffba4e7c41a1e40821ce15ab7" name="ab2f3dbfffba4e7c41a1e40821ce15ab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f3dbfffba4e7c41a1e40821ce15ab7">&#9670;&#160;</a></span>newton_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::newton_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Newton-Ralphson method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00905">905</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_ab2f3dbfffba4e7c41a1e40821ce15ab7_cgraph.png" border="0" usemap="#anamespacemod__afld_ab2f3dbfffba4e7c41a1e40821ce15ab7_cgraph" alt=""/></div>
<map name="anamespacemod__afld_ab2f3dbfffba4e7c41a1e40821ce15ab7_cgraph" id="anamespacemod__afld_ab2f3dbfffba4e7c41a1e40821ce15ab7_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="5,70,200,95"/>
<area shape="rect" href="namespacemod__afld.html#a7eb940836590e32462520c6b43fecac3" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="259,5,408,45"/>
<area shape="poly" title=" " alt="" coords="154,67,245,44,246,50,155,73"/>
<area shape="rect" href="namespacemod__afld.html#aa9ba324228b7daabfdf1ee26a7c88026" title="Evaluate polynomial at argument e_gas." alt="" coords="467,35,629,75"/>
<area shape="poly" title=" " alt="" coords="200,74,453,58,453,63,200,79"/>
<area shape="rect" href="namespacemod__afld.html#a8a78bd59aab671d27b82fd0f79713d1a" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="248,120,419,160"/>
<area shape="poly" title=" " alt="" coords="155,93,240,114,239,119,154,98"/>
<area shape="poly" title=" " alt="" coords="409,33,453,39,452,44,408,38"/>
</map>
</div>

</div>
</div>
<a id="aa9ba324228b7daabfdf1ee26a7c88026" name="aa9ba324228b7daabfdf1ee26a7c88026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9ba324228b7daabfdf1ee26a7c88026">&#9670;&#160;</a></span>polynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_afld::polynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00965">965</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="aebb6f45fae873e367229e0d1c201a299" name="aebb6f45fae873e367229e0d1c201a299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebb6f45fae873e367229e0d1c201a299">&#9670;&#160;</a></span>put_diffterm_onegrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::put_diffterm_onegrid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00662">662</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a9d5289df9bf8e1e13a2af0815ef926a5" name="a9d5289df9bf8e1e13a2af0815ef926a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5289df9bf8e1e13a2af0815ef926a5">&#9670;&#160;</a></span>update_diffcoeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_afld::update_diffcoeff </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00717">717</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__afld_a9d5289df9bf8e1e13a2af0815ef926a5_cgraph.png" border="0" usemap="#anamespacemod__afld_a9d5289df9bf8e1e13a2af0815ef926a5_cgraph" alt=""/></div>
<map name="anamespacemod__afld_a9d5289df9bf8e1e13a2af0815ef926a5_cgraph" id="anamespacemod__afld_a9d5289df9bf8e1e13a2af0815ef926a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,200,38"/>
<area shape="rect" href="namespacemod__afld.html#a292222016c4df688c77b80961c9b821b" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="248,5,391,45"/>
<area shape="poly" title=" " alt="" coords="200,23,234,23,234,28,200,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab600478175e32e54507930fa5a453c8b" name="ab600478175e32e54507930fa5a453c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab600478175e32e54507930fa5a453c8b">&#9670;&#160;</a></span>afld_diff_scheme</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_afld::afld_diff_scheme = 'mg'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to solve diffusion part. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00034">34</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ae36cf9da279835877db79517593f9773" name="ae36cf9da279835877db79517593f9773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36cf9da279835877db79517593f9773">&#9670;&#160;</a></span>afld_mu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_afld::afld_mu = 0.6d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>mean particle mass </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00018">18</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ada0be98793916c578ed467d51c7bf03a" name="ada0be98793916c578ed467d51c7bf03a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada0be98793916c578ed467d51c7bf03a">&#9670;&#160;</a></span>diff_coef_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::diff_coef_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take running average for Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00040">40</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ace04332127fd83710700fd46b1cd9a88" name="ace04332127fd83710700fd46b1cd9a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace04332127fd83710700fd46b1cd9a88">&#9670;&#160;</a></span>diff_crit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_afld::diff_crit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number for splitting the diffusion module. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00025">25</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a8a0e26fb19d7aeb30d836e67db9f00e7" name="a8a0e26fb19d7aeb30d836e67db9f00e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a0e26fb19d7aeb30d836e67db9f00e7">&#9670;&#160;</a></span>diffcrash_resume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::diffcrash_resume = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume run when multigrid returns error. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00048">48</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="af47b1bedd6a94866e05d77fe9db2006c" name="af47b1bedd6a94866e05d77fe9db2006c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af47b1bedd6a94866e05d77fe9db2006c">&#9670;&#160;</a></span>dt_diff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision mod_afld::dt_diff = 0.d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>running timestep for diffusion solver, initialised as zero </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00052">52</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a4a3f0b3cb7f2bf5d523cae57e1ba0d14" name="a4a3f0b3cb7f2bf5d523cae57e1ba0d14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a3f0b3cb7f2bf5d523cae57e1ba0d14">&#9670;&#160;</a></span>fld_bisect_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_afld::fld_bisect_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00021">21</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a85a770d35524300ee9a804b31ce105db" name="a85a770d35524300ee9a804b31ce105db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a770d35524300ee9a804b31ce105db">&#9670;&#160;</a></span>fld_diff_testcase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::fld_diff_testcase = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Diffusion coefficient to unity. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00038">38</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a5dfc6250beb84fbb70e3e21571d4ab4f" name="a5dfc6250beb84fbb70e3e21571d4ab4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dfc6250beb84fbb70e3e21571d4ab4f">&#9670;&#160;</a></span>fld_diff_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_afld::fld_diff_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for adi method for radiative Energy diffusion. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00023">23</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a216f97d4641cd0b010a21bbbd5b7c869" name="a216f97d4641cd0b010a21bbbd5b7c869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a216f97d4641cd0b010a21bbbd5b7c869">&#9670;&#160;</a></span>fld_eint_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::fld_eint_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>source split for energy interact and radforce: </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00013">13</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a61ae06bf2c058e6700a663662495da48" name="a61ae06bf2c058e6700a663662495da48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61ae06bf2c058e6700a663662495da48">&#9670;&#160;</a></span>fld_fluxlimiter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=16) mod_afld::fld_fluxlimiter = 'Pomraning'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Diffusion limit lambda = 0.33. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00030">30</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a0e8e9d9fd456e918479fe5a4bde21ad8" name="a0e8e9d9fd456e918479fe5a4bde21ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e8e9d9fd456e918479fe5a4bde21ad8">&#9670;&#160;</a></span>fld_interaction_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_afld::fld_interaction_method = 'Halley'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to find the root for the energy interaction polynomial. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00036">36</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a4ea768f07bef24636da517b4ee613b51" name="a4ea768f07bef24636da517b4ee613b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ea768f07bef24636da517b4ee613b51">&#9670;&#160;</a></span>fld_kappa0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_afld::fld_kappa0 = 0.34d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opacity per unit of unit_density. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00016">16</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a8f033efe15a187dbef91fc708de9c42e" name="a8f033efe15a187dbef91fc708de9c42e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f033efe15a187dbef91fc708de9c42e">&#9670;&#160;</a></span>fld_opacity_law</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8), dimension(:), allocatable mod_afld::fld_opacity_law</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use constant Opacity? </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00027">27</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ab585bc66c9a64f80d7718f0d17ebc1cf" name="ab585bc66c9a64f80d7718f0d17ebc1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab585bc66c9a64f80d7718f0d17ebc1cf">&#9670;&#160;</a></span>fld_opal_table</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=50) mod_afld::fld_opal_table = 'Y09800'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00028">28</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ad20315084fb9735fef24b8f7a22a349d" name="ad20315084fb9735fef24b8f7a22a349d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20315084fb9735fef24b8f7a22a349d">&#9670;&#160;</a></span>fld_radforce_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::fld_radforce_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00014">14</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a3acfbf67de8bb631f56ecaa69e08a452" name="a3acfbf67de8bb631f56ecaa69e08a452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acfbf67de8bb631f56ecaa69e08a452">&#9670;&#160;</a></span>flux_lim_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::flux_lim_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take a running average over the fluxlimiter. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00043">43</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ae88338c74496a8ef765f476f93fb0cda" name="ae88338c74496a8ef765f476f93fb0cda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae88338c74496a8ef765f476f93fb0cda">&#9670;&#160;</a></span>i_diff_mg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable mod_afld::i_diff_mg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00032">32</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="a02ca3635375053ac0b5bcc38899646d3" name="a02ca3635375053ac0b5bcc38899646d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02ca3635375053ac0b5bcc38899646d3">&#9670;&#160;</a></span>lineforce_opacities</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_afld::lineforce_opacities = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use or dont use lineforce opacities. </p>

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00046">46</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ad4cf3d2c4cd5575fd78ff97e42b9a44d" name="ad4cf3d2c4cd5575fd78ff97e42b9a44d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4cf3d2c4cd5575fd78ff97e42b9a44d">&#9670;&#160;</a></span>size_d_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_afld::size_d_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00041">41</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
<a id="ae96ebc2df4145cc8f20721781bb62633" name="ae96ebc2df4145cc8f20721781bb62633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96ebc2df4145cc8f20721781bb62633">&#9670;&#160;</a></span>size_l_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_afld::size_l_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__afld_8t_source.html#l00044">44</a> of file <a class="el" href="mod__afld_8t_source.html">mod_afld.t</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
