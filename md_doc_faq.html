<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: Frequently Asked Questions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Frequently Asked Questions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="faq-list"></a>
List of questions</h1>
<p>Below you can find a list of frequently asked questions and answers.</p>
<h1><a class="anchor" id="faq-mailinglist"></a>
Is there a mailinglist?</h1>
<p>Yes, we have a mailinglist that you can send questions to: <a href="#" onclick="location.href='mai'+'lto:'+'amr'+'va'+'cus'+'er'+'s@l'+'s.'+'kul'+'eu'+'ven'+'.b'+'e'; return false;">amrva<span style="display: none;">.nosp@m.</span>cuse<span style="display: none;">.nosp@m.</span>rs@ls<span style="display: none;">.nosp@m.</span>.kul<span style="display: none;">.nosp@m.</span>euven<span style="display: none;">.nosp@m.</span>.be</a></p>
<p>You can join the mailing-list by <a href="https://ls.kuleuven.be/cgi-bin/wa?SUBED1=AMRVACUSERS&amp;A=1">subscribing</a>, so that you will be informed about important changes or (bug)fixes. You can also search the <a href="https://ls.kuleuven.be/cgi-bin/wa?A0=AMRVACUSERS">mailing list archive</a>.</p>
<h1><a class="anchor" id="faq-own-parameters"></a>
Is there a way I can define my own parameters somewhere in mod_usr.t and configure them through &lt;tt&gt;amrvac.par&lt;/tt&gt; ?</h1>
<p>Indeed, there is a quick and time-saving way to read your own parameters without having to give an explicit value in the usr file and recompile each time. Instead, add this in your usr file :</p>
<ol type="1">
<li>at the end of the usr_init subroutine, add this line : call params_read(par_files)</li>
<li>and just after the usr_init subroutine, define the params_read subroutine you just called. For instance :</li>
</ol>
<div class="fragment"><div class="line"><span class="comment">    !&gt; Read parameters from a file</span></div>
<div class="line">    <span class="keyword">subroutine </span>params_read(files)</div>
<div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">unitpar</a></div>
<div class="line">    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: files(:)</div>
<div class="line">    <span class="keywordtype">integer</span>                      :: n</div>
<div class="line"> </div>
<div class="line">    namelist /my_list/ my_parameter_1, my_parameter_2 <span class="comment">! where you tell the code to read your own parameters</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> n = 1, <span class="keyword">size</span>(files)</div>
<div class="line">       <span class="keyword">open</span>(<a class="code" href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">unitpar</a>, file=trim(files(n)), status=<span class="stringliteral">&quot;old&quot;</span>)</div>
<div class="line">       <span class="keyword">read</span>(<a class="code" href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">unitpar</a>, my_list, <span class="keyword">end</span>=111)</div>
<div class="line">111    <span class="keyword">close</span>(unitpar)</div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">end subroutine </span>params_read</div>
<div class="ttc" id="anamespacemod__global__parameters_html"><div class="ttname"><a href="namespacemod__global__parameters.html">mod_global_parameters</a></div><div class="ttdoc">This module contains definitions of global parameters and variables and some generic functions/subrou...</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00004">mod_global_parameters.t:4</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a2643b30397384bf36289b3afb2d7dda3"><div class="ttname"><a href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">mod_global_parameters::unitpar</a></div><div class="ttdeci">integer, parameter unitpar</div><div class="ttdoc">file handle for IO</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00247">mod_global_parameters.t:247</a></div></div>
</div><!-- fragment --><p>with <code>my_parameter_1</code> and <code>my_parameter_2</code> to be defined at the very beginning of the user file, just before the “contains” statement. Doing so, you can use them anywhere in the usr file and they will have the value you defined in your par file adding the following lines :</p>
<div class="fragment"><div class="line">&amp;my_list</div>
<div class="line">    my_parameter_1    = 0.2d0</div>
<div class="line">    my_parameter_2    = 1.d0</div>
<div class="line">/</div>
</div><!-- fragment --> <h1><a class="anchor" id="faq-blk-to-dat"></a>
I'm looking for a way to translate some .blk files (using ‘convert_type= 'onegrid’&lt;tt&gt;) back into standard output&lt;/tt&gt;.dat` that I can use to restart a simulation. My goal is to be able to change my data mid-simulation through another program.</h1>
<p>The idea of the <code>onegrid</code> option for conversion is that a hierarchical block AMR grid (as stored in the <code>.dat</code> files) can be saved to an equivalent uniform grid representation at a user-chosen level (combine <code>level_io</code> with <code>onegrid</code>). You then can use any software you like to handle uniform grid data. Converting back to the .dat format is then impossible. However, you can write a user-routine to read in the uniform data, and then use it to restart a similar uniform-grid (no AMR, just domain decomposed) simulation. The <code>.dat</code> files are all that is needed to do restarts.</p>
<p>If you want to change the data during the simulation, in principle you do not need another program to do that. For that purpose, we provide the generic subroutines</p>
<ol type="1">
<li>usr_process_grid</li>
<li>usr_process_global</li>
</ol>
<p>or immediately after the advance step:</p>
<ol type="1">
<li>usr_process_adv_grid</li>
<li>usr_process_adv_global</li>
</ol>
<p>or just once, at restart (and after reading in a .dat file), then use</p>
<ol type="1">
<li>usr_before_main_loop</li>
</ol>
<p>which allows you to modify things during runtime (of course, it should make physical sense). See their interface in <em><a class="el" href="mod__usr__methods_8t.html">mod_usr_methods.t</a></em>.</p>
<h1><a class="anchor" id="faq-show-ghost-cells"></a>
Is there a way to save (and visualize) the data in the boundary ghost cells?</h1>
<p>The logical variable <code>save_physical_boundary</code> can be set to true, which enforces the <code>.dat</code> files to also contain the ghost cell information for physical boundaries (i.e., those beyond the left or right edge of the domain, in each direction). You can use this file (like any other <code>.dat</code> file, to restart, and this helps if you want to use saved boundary info in your boundary value handling. However, all our present conversion options (like e.g. to <code>.vtu</code> files) do not store this extra info, and you can therefore not use them for visualizing the ghost cell info. For that, you will need to handle the <code>.dat</code> files directly, e.g. using python.</p>
<h1><a class="anchor" id="faq-mpi-mod"></a>
I get an error: mpi.mod was created by a different version of GNU Fortran</h1>
<p>This means that your MPI library was compiled with a different version of <code>gfortran</code> (and <code>GCC</code>) than you are using now. If you run on a cluster, contact their support and ask them to fix it.</p>
<p>If you encounter this problem on your own machine, you can try to:</p>
<ol type="1">
<li>Change compilers: Use the version of gfortran that MPI was compiled with</li>
<li>Reinstall your MPI library, or install a different one (e.g. MPICH or OpenMPI), which is then hopefully compiled with the right version of GCC/gfortran.</li>
<li>Install an operating system with working package management, e.g. Debian ;)</li>
</ol>
<h1><a class="anchor" id="faq-hall-mhd"></a>
Can the MHD module handle Hall-MHD?</h1>
<p>The MPI-AMRVAC code has Hall-MHD included, as detailed in some of our publications, e.g. in the method paper</p>
<ul>
<li>&lsquo;MPI-AMRVAC for Solar and Astrophysics&rsquo;, O. Porth, C. Xia, T. Hendrix, S.P. Moschou, &amp; R. Keppens, 2014, ApJS 214,4 <a href="http://dx.doi.org/10.1088/0067-0049/214/1/4">doi:10.1088/0067-0049/214/1/4</a></li>
</ul>
<p>or also in the Kelvin-Helmholtz related application paper</p>
<ul>
<li>&lsquo;On the influence of environmental parameters on mixing and reconnection caused by the Kelvin-Helmholtz instability at the magnetopause&rsquo;, M.H.J. Leroy &amp; R. Keppens, 2017, PoP 24, 012906 (15pp), <a href="http://dx.doi.org/10.1063/1.4974758">doi:10.1063/1.4974758</a></li>
</ul>
<p>The implementation details are given in the first reference (Porth et al.), and although it works properly on several tests and applications, we note that the time step constraint of our explicit implementation may become prohibitive for particular applications. We just limit the CFL according to \(\Delta t &lt; \Delta x/ c_w\), with time step and spatial step linked by the speed \(c_w\), but in that speed we set \(c_w= |v|+\max(c_{fast}, \eta_h B/\rho * k_{max})\) and \(k_{max}\) is the maximal wavenumber we can represent (i.e. linked to \(\Delta x\)). The dispersive nature of the Hall-MHD system may then make \(\Delta t\) going like \(\Delta x^2\), and this limits the current implementation.</p>
<p>In MPI-AMRVAC 3.0, the Hall effect is included when setting the following in the <code>mhd_list</code> namelist part</p>
<div class="fragment"><div class="line">&amp;mhd_list</div>
<div class="line">      mhd_hall=.true.</div>
<div class="line">      mhd_etah=  .... (some positive number, quantifying the hall <span class="keywordtype">parameter</span>)</div>
<div class="line">/</div>
</div><!-- fragment --><p>In the same namelist, the optional logical <code>mhd_4th_order=.true.</code> implies a 4th order evaluation for currents, default it is only second order. In any case, you may also need to activate an additional ghost cell layer (or 2 for 4th-order evaluations), through setting appropriately the parameter <code>nghostcells</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
