<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: src/physics/mod_radiative_cooling.t Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_8250e12e5a19acb8ece30f1703b6dc16.html">physics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mod_radiative_cooling.t</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mod__radiative__cooling_8t.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!&gt; module radiative cooling -- add optically thin radiative cooling for HD and MHD</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!&gt; Assumptions: full ionize plasma dominated by H and He, ionization equilibrium </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!&gt; Formula: Q=-n_H*n_e*f(T), positive f(T) function is pre-computed and tabulated or a piecewise power law</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!&gt; Developed by Allard Jan van Marle, Rony Keppens, and Chun Xia</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!&gt; Cooling tables extend to 1O^9 K, (17.11.2009)  AJvM</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!&gt; Included table by Smith (18.11.2009)           AJvM</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!&gt; Included luminosity output option (18.11.2009) AJvM</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!&gt; Included two cooling curves from Cloudy code supplied by Wang Ye (12.11.2011) AJvM</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!&gt; Included a solar coronal cooling curve (JCcorona) supplied by J. Colgan (2008) ApJ</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!&gt; Modulized and simplified by Chun Xia (2017)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!&gt; Included piecewise power law functionality by Joris Hermans (01.2020)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html">   14</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacemod__radiative__cooling.html">mod_radiative_cooling</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">! For the interpolatable tables: these tables contain log_10 temperature values and corresponding</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">! log_10 luminosity values. The simulation-dependent temperature and luminosity</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">! scaling parameters are supposed to be provided in the user file. </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">! All tables have been extended to at least T=10^9 K using a pure Bremsstrahlung </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">! relationship of Lambda~sqrt(T). This to ensure that a purely explicit calculation </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">! without timestep check is only used for extremely high temperatures. </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">! (Except for the SPEX curve, which is more complicated and therefore simply stops  </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">! at the official upper limit of log(T) = 8.16)</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a>, <span class="keywordtype">only</span>: std_len</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacemod__physics.html">mod_physics</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">! parameters used for implicit cooling source calculations</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">  !&gt; Helium abundance over Hydrogen</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double precision</span>, <span class="keywordtype">private</span>    :: He_abundance</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">  !&gt; The adiabatic index</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">double precision</span>, <span class="keywordtype">private</span> :: rc_gamma</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  abstract <span class="keyword">interface</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="interfacemod__radiative__cooling_1_1get__subr1.html#aefa8e8c6d9412cf117beb8e9c2d9cbc6">   38</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>(w,x,ixI^L,ixO^L,res)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>          :: ixI^L, ixO^L</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: w(ixI^S,nw)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: x(ixI^S,1:ndim)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(out)</span>:: res(ixI^S)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">end interface</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html">   49</a></span>&#160;  <span class="keyword">type</span> <a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">! these are to be set directly</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a7f90671190ac181af3ca22a0782093c8">   52</a></span>&#160;    <span class="keywordtype">logical</span> :: has_equi = .false.</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#ae66ff48dd3f4bc3df7e06f77480719eb">   53</a></span>&#160;    procedure(<a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>), <span class="keywordtype">pointer</span>, <span class="keywordtype">nopass</span> :: get_rho =&gt; null()</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#aaf48444656cc6e3d47927d748608baf6">   54</a></span>&#160;    procedure(<a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>), <span class="keywordtype">pointer</span>, <span class="keywordtype">nopass</span> :: get_rho_equi =&gt; null()</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#acf87441c4d69d38df953485620364cd1">   55</a></span>&#160;    procedure(<a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>), <span class="keywordtype">pointer</span>, <span class="keywordtype">nopass</span> :: get_pthermal =&gt; null()</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a88d218d5cb3427d71ec0109b1ec1c55e">   56</a></span>&#160;    procedure(<a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>), <span class="keywordtype">pointer</span>, <span class="keywordtype">nopass</span> :: get_pthermal_equi =&gt; null()</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a69cecab6dbef35471187b7577ed18bce">   57</a></span>&#160;    procedure(<a class="code" href="interfacemod__radiative__cooling_1_1get__subr1.html">get_subr1</a>), <span class="keywordtype">pointer</span>, <span class="keywordtype">nopass</span> :: get_var_rfactor =&gt; null()</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">! factor in eq of state p = Rfactor * rho * T</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">! used for getting temperature</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#aa554c23fbba0ec71879abfe85c8708e0">   61</a></span>&#160;    <span class="keywordtype">double precision</span> :: rfactor = 1d0<span class="comment"></span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    !&gt; Index of the energy density</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a07f9c3d4983abad6911ced50b0c0034d">   63</a></span>&#160;    <span class="keywordtype">integer</span>              :: e_<span class="comment"></span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    !&gt; Index of the internal energy density</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a068f74ce221197135e7a01b771148828">   65</a></span>&#160;    <span class="keywordtype">integer</span>              :: eaux_<span class="comment"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    !&gt; Index of cut off temperature for TRAC</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a8df276f72683e594539e0cbfab0828e6">   67</a></span>&#160;    <span class="keywordtype">integer</span>              :: tcoff_</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">! END these are to be set directly</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">! these are set as parameters</span><span class="comment"></span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    !&gt; Resolution of temperature in interpolated tables</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a3b249f1ed4ba035c7c4ab8f248807393">   72</a></span>&#160;    <span class="keywordtype">integer</span> :: ncool</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    !&gt; Coefficent of cooling time step</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#aba68267700a9c0fa0e6eeb83dd4172a3">   75</a></span>&#160;    <span class="keywordtype">double precision</span>   :: cfrac</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">    !&gt; Name of cooling curve</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a4d70720d09580eeb6a87c37666d32113">   78</a></span>&#160;    <span class="keywordtype">character(len=std_len)</span>  :: coolcurve</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    !&gt; Name of cooling method</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#abdb7ddc841f43a370e2fd17d5c7bd720">   81</a></span>&#160;    <span class="keywordtype">character(len=std_len)</span>  :: coolmethod</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    !&gt; Fixed temperature not lower than tlow</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#aa50f957317d7d289435a91b0e9ed810c">   84</a></span>&#160;    <span class="keywordtype">logical</span>   :: tfix</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">    !&gt; Lower limit of temperature</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a0f924100794278465a8bd804782ef211">   87</a></span>&#160;    <span class="keywordtype">double precision</span>   :: tlow</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    !&gt; Add cooling source in a split way (.true.) or un-split way (.false.)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#abf2972f8be00cd4b7a2493575856e1a9">   90</a></span>&#160;    <span class="keywordtype">logical</span>    :: rc_split</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">! END these are set as parameters</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">! these are set in init method</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a43f44d0d0352890884cf42fccefc3b15">   94</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: tcool(:), lcool(:), dldtcool(:)</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a45e23e28944568dcdbee1b9b2a8af44e">   95</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: yc(:), invyc(:)</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a56ca8236f7d6d966848c14977cc91cef">   96</a></span>&#160;    <span class="keywordtype">double precision</span>  :: tref, lref, tcoolmin,tcoolmax</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#ad236c2685d67c2ebe5b25e3ca207ee04">   97</a></span>&#160;    <span class="keywordtype">double precision</span>  :: lgtcoolmin, lgtcoolmax, lgstep</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">! The piecewise powerlaw (PPL) tabels and variabels</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">! x_* en t_* are given as log_10</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a1a0067183d1a433b46d5a8ff85d55fa5">  101</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: y_ppl(:), t_ppl(:), l_ppl(:), a_ppl(:)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a4cc1a2605623ea50b06deab091981e0c">  103</a></span>&#160;    <span class="keywordtype">integer</span> :: n_ppl</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structmod__radiative__cooling_1_1rc__fluid.html#a3d5e19a4e9d43e62648d3d5ec6741293">  105</a></span>&#160;    <span class="keywordtype">logical</span> :: isppl = .false.</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">! END  these are set in init method</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">end type </span><a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">  112</a></span>&#160;  <span class="keywordtype">integer</span>          :: <a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a>, <a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a>, <a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a>, <a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a>, <a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a>, <a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a0091341d39b71e093c116406e851d6f1">  114</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#a29b26e00937bc4f9a21b3b0606b23b77">t_hildner</a>(1:6), <a class="code" href="namespacemod__radiative__cooling.html#a0091341d39b71e093c116406e851d6f1">t_fm</a>(1:5), <a class="code" href="namespacemod__radiative__cooling.html#a49f6dbe5de1126c72f6ecf2c77c23da7">t_rosner</a>(1:10), <a class="code" href="namespacemod__radiative__cooling.html#ab92582fd2be7a4f7caf8ee633e26f60f">t_klimchuk</a>(1:8), &amp;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                      <a class="code" href="namespacemod__radiative__cooling.html#ad973210231bc7335c3c8ef47f0d49adf">t_spex_dm_rough</a>(1:8), <a class="code" href="namespacemod__radiative__cooling.html#a757a058f85b83b210fb6429d656bef0b">t_spex_dm_fine</a>(1:15)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a9c8d50c8c6c519a6b3c7d1a916d42b91">  117</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#a77a4bb25c093933a6a0dee150cbf348f">x_hildner</a>(1:5), <a class="code" href="namespacemod__radiative__cooling.html#a9c8d50c8c6c519a6b3c7d1a916d42b91">x_fm</a>(1:4), <a class="code" href="namespacemod__radiative__cooling.html#a93998291fb002bd7160c79cba04994b3">x_rosner</a>(1:9), <a class="code" href="namespacemod__radiative__cooling.html#a94896dac9a3cf4e4d7c5c927bcce4dad">x_klimchuk</a>(1:7), &amp;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                      <a class="code" href="namespacemod__radiative__cooling.html#a34cec942eec1a95a875a92d2e87719e5">x_spex_dm_rough</a>(1:7), <a class="code" href="namespacemod__radiative__cooling.html#aef014e49d490cee95079a24f8e1f1771">x_spex_dm_fine</a>(1:14)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a51b6cce389bb5faf48cc0778a9c6abf5">  120</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#a28ef07b7764445dfe9169b10ed165c00">a_hildner</a>(1:5), <a class="code" href="namespacemod__radiative__cooling.html#a51b6cce389bb5faf48cc0778a9c6abf5">a_fm</a>(1:4), <a class="code" href="namespacemod__radiative__cooling.html#ae1c63cc7af1e58b105cfa0b2861bd275">a_rosner</a>(1:9), <a class="code" href="namespacemod__radiative__cooling.html#adf796515078f438e7309b608f5e63454">a_klimchuk</a>(1:7), &amp;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                      <a class="code" href="namespacemod__radiative__cooling.html#a991bb73b9d368ac04331bb070bba0870">a_spex_dm_rough</a>(1:7), <a class="code" href="namespacemod__radiative__cooling.html#a7bd34991ed29076faea8d491271e5413">a_spex_dm_fine</a>(1:14)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a> / 5 /</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a29b26e00937bc4f9a21b3b0606b23b77">t_hildner</a> / 3.00000, 4.17609, 4.90309, 5.47712, 5.90309, 10.00000 /</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a77a4bb25c093933a6a0dee150cbf348f">x_hildner</a> / -53.30803, -29.92082, -21.09691, -7.40450, -16.25885 /</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a28ef07b7764445dfe9169b10ed165c00">a_hildner</a> / 7.4, 1.8, 0.0, -2.5, -1.0 /</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a> / 4 /</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a0091341d39b71e093c116406e851d6f1">t_fm</a> / 3.00000, 4.30103, 5.60206, 7.00000, 10.00000 /</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a9c8d50c8c6c519a6b3c7d1a916d42b91">x_fm</a> / -31.15813, -27.50227, -18.25885, -35.75893 /</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a51b6cce389bb5faf48cc0778a9c6abf5">a_fm</a> / 2.0, 1.15, -0.5, 2.0 /</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a> / 9 /</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a49f6dbe5de1126c72f6ecf2c77c23da7">t_rosner</a> / 3.00000, 3.89063, 4.30195, 4.57500,  4.90000, &amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                5.40000, 5.77000, 6.31500, 7.60457, 10.00000  /</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a93998291fb002bd7160c79cba04994b3">x_rosner</a> / -69.900, -48.307, -21.850, -31.000, -21.200, &amp;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                -10.400, -21.940, -17.730, -26.602           /</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#ae1c63cc7af1e58b105cfa0b2861bd275">a_rosner</a> / 11.70, 6.15, 0.00, 2.00, 0.00, &amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                -2.00, 0.00, -0.67, 0.50       /</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a> / 7 /</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#ab92582fd2be7a4f7caf8ee633e26f60f">t_klimchuk</a> / 3.00, 4.97, 5.67, 6.18, 6.55, 6.90, 7.63, 10.00 /</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a94896dac9a3cf4e4d7c5c927bcce4dad">x_klimchuk</a> / -30.96257, -16.05208, -21.72125, -12.45223, &amp;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                      -24.46092, -15.26043, -26.70774             /</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#adf796515078f438e7309b608f5e63454">a_klimchuk</a> / 2.00, -1.00, 0.00, -1.50, 0.33, -1.00, 0.50 /</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a> / 7 /</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#ad973210231bc7335c3c8ef47f0d49adf">t_spex_dm_rough</a> / 1.000, 1.572, 3.992, 4.165, 5.221, 5.751, 7.295, 8.160 /</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a34cec942eec1a95a875a92d2e87719e5">x_spex_dm_rough</a> / -34.286, -28.282, -108.273, -26.662, -9.729, -17.550, -24.767 /</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a991bb73b9d368ac04331bb070bba0870">a_spex_dm_rough</a> / 4.560, 0.740, 20.777, 1.182, -2.061, -0.701, 0.288 /</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a> / 14 /</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a757a058f85b83b210fb6429d656bef0b">t_spex_dm_fine</a> / 1.000, 1.422, 2.806, 3.980, 4.177, 4.443, 4.832, 5.397, &amp;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                          5.570, 5.890, 6.232, 6.505, 6.941, 7.385, 8.160         /</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                          </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#aef014e49d490cee95079a24f8e1f1771">x_spex_dm_fine</a> / -35.314, -29.195, -26.912, -108.273, -18.971, -32.195, -21.217, &amp; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                           -0.247, -15.415, -19.275,   -9.387, -22.476, -17.437, -25.026  /</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">data</span>   <a class="code" href="namespacemod__radiative__cooling.html#a7bd34991ed29076faea8d491271e5413">a_spex_dm_fine</a> / 5.452,  1.150,  0.337, 20.777, -0.602,  2.374, 0.102, &amp;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                         -3.784, -1.061, -0.406, -1.992,  0.020, -0.706, 0.321  /</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">! Interpolatable tables</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">  179</a></span>&#160;  <span class="keywordtype">integer</span>          :: <a class="code" href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">n_dm</a>      , <a class="code" href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">n_mb</a>      , <a class="code" href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">n_mlcosmol</a> &amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">n_mlwc</a>    , <a class="code" href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">n_mlsolar1</a>, <a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>     &amp;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">n_jccorona</a>, <a class="code" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">n_cl_ism</a>  , <a class="code" href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">n_cl_solar</a> &amp;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>    , <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>    , <a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  </div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#ab31b3d92c98eedfda0c3052596ff2672">  184</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#af18323578e93aa12585a85a929bbc71b">t_dm</a>(1:71),       <a class="code" href="namespacemod__radiative__cooling.html#a7a1c8e0f0aa6cea768bd790d1368e6a8">t_mb</a>(1:51),       <a class="code" href="namespacemod__radiative__cooling.html#a72c7bb2cb2adcbdcf17aa70c36dc9ef6">t_mlcosmol</a>(1:71) &amp;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#aa00eb7c5323358031d1d923adb79ee45">t_mlwc</a>(1:71),     <a class="code" href="namespacemod__radiative__cooling.html#aa61b47ca3f179f19eebb33541903ed04">t_mlsolar1</a>(1:71), <a class="code" href="namespacemod__radiative__cooling.html#aea74a2a9c1a2b8083c5d0faa0591bc97">t_spex</a>(1:110)    &amp;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a9e7237a0a6c123c52f3c517ad882475f">t_jccorona</a>(1:45), <a class="code" href="namespacemod__radiative__cooling.html#ab31b3d92c98eedfda0c3052596ff2672">t_cl_ism</a>(1:151),  <a class="code" href="namespacemod__radiative__cooling.html#a144fc5db0c90b80c011a46f75e83cc7a">t_cl_solar</a>(1:151)&amp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a>(1:76),     <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a>(1:101),    <a class="code" href="namespacemod__radiative__cooling.html#a4cf4f74ba22dc1a976d3ecea5f283b31">t_colgan</a>(1:55) </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  </div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#ac62b4885715b9d9d8b142f39a1d69e59">  189</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#a9217661a6d1b782ac684c8513e4bf01c">l_dm</a>(1:71),       <a class="code" href="namespacemod__radiative__cooling.html#a11746fc81a29be58a85270c35a8799f3">l_mb</a>(1:51),           <a class="code" href="namespacemod__radiative__cooling.html#a07c0aa1271a169576349e6deda1d219c">l_mlcosmol</a>(1:71)   &amp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#ac7895ee8cc93a8e76b2a30be3faacab2">l_mlwc</a>(1:71),     <a class="code" href="namespacemod__radiative__cooling.html#ae3bf50014c5f9b160a1b9aa1d9b984e2">l_mlsolar1</a>(1:71),     <a class="code" href="namespacemod__radiative__cooling.html#a23553172a22d868a17b7600720fd97f7">l_spex</a>(1:110)      &amp;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a8936dfcd3aefa0a853fe4153ac850e92">l_jccorona</a>(1:45), <a class="code" href="namespacemod__radiative__cooling.html#ac62b4885715b9d9d8b142f39a1d69e59">l_cl_ism</a>(1:151),      <a class="code" href="namespacemod__radiative__cooling.html#a90afb884c1b454cc032bbf9c4918136e">l_cl_solar</a>(1:151)  &amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a>(1:76),     <a class="code" href="namespacemod__radiative__cooling.html#a8fbfc551634dce377658b2b1ab8a9413">l_dere_corona</a>(1:101), <a class="code" href="namespacemod__radiative__cooling.html#a7f116c412a6622b43c3e6e58c6b35fb7">l_dere_photo</a>(1:101)&amp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    , <a class="code" href="namespacemod__radiative__cooling.html#a378372e4dbb44f94e26e1b7e67d59f9f">l_colgan</a>(1:55)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  </div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">  195</a></span>&#160;  <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">nenh_spex</a>(1:110)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">n_jccorona</a> / 45 /</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a9e7237a0a6c123c52f3c517ad882475f">t_jccorona</a> / 4.00000, 4.14230, 4.21995, 4.29761, 4.37528, &amp;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                       4.45294, 4.53061, 4.60827, 4.68593, 4.76359, &amp;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                       4.79705, 4.83049, 4.86394, 4.89739, 4.93084, &amp;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                       4.96428, 4.99773, 5.03117, 5.06461, 5.17574, &amp;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                       5.28684, 5.39796, 5.50907, 5.62018, 5.73129, &amp;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                       5.84240, 5.95351, 6.06461, 6.17574, 6.28684, &amp;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                       6.39796, 6.50907, 6.62018, 6.73129, 6.84240, &amp;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                       6.95351, 7.06461, 7.17574, 7.28684, 7.39796, &amp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                       7.50907, 7.62018, 7.73129, 7.84240, 7.95351  /</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a8936dfcd3aefa0a853fe4153ac850e92">l_jccorona</a> / -200.18883, -100.78630, -30.60384, -22.68481, -21.76445, &amp;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                       -21.67936, -21.54218, -21.37958, -21.25172, -21.17584, &amp;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                       -21.15783, -21.14491, -21.13527, -21.12837, -21.12485, &amp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                       -21.12439, -21.12642, -21.12802, -21.12548, -21.08965, &amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                       -21.08812, -21.19542, -21.34582, -21.34839, -21.31701, &amp;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                       -21.29072, -21.28900, -21.34104, -21.43122, -21.62448, &amp;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                       -21.86694, -22.02897, -22.08051, -22.06057, -22.01973, &amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                       -22.00000, -22.05161, -22.22175, -22.41452, -22.52581, &amp;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                       -22.56914, -22.57486, -22.56151, -22.53969, -22.51490  /</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">n_dm</a> / 71 /</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#af18323578e93aa12585a85a929bbc71b">t_dm</a> / 2.0, 2.1, 2.2, 2.3, 2.4, &amp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                 2.5, 2.6, 2.7, 2.8, 2.9, &amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                 3.0, 3.1, 3.2, 3.3, 3.4, &amp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                 3.5, 3.6, 3.7, 3.8, 3.9, &amp;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                 4.0, 4.1, 4.2, 4.3, 4.4, &amp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                 4.5, 4.6, 4.7, 4.8, 4.9, &amp;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                 5.0, 5.1, 5.2, 5.3, 5.4, &amp;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                 5.5, 5.6, 5.7, 5.8, 5.9, &amp;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                 6.0, 6.1, 6.2, 6.3, 6.4, &amp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                 6.5, 6.6, 6.7, 6.8, 6.9, &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                 7.0, 7.1, 7.2, 7.3, 7.4, &amp;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                 7.5, 7.6, 7.7, 7.8, 7.9, &amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                 8.0, 8.1, 8.2, 8.3, 8.4, &amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                 8.5, 8.6, 8.7, 8.8, 8.9, &amp;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                 9.0 /</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a9217661a6d1b782ac684c8513e4bf01c">l_dm</a> / -26.523, -26.398, -26.301, -26.222, -26.097 &amp; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               , -26.011, -25.936, -25.866, -25.807, -25.754 &amp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               , -25.708, -25.667, -25.630, -25.595, -25.564 &amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;               , -25.534, -25.506, -25.479, -25.453, -25.429 &amp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;               , -25.407, -23.019, -21.762, -21.742, -21.754 &amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;               , -21.730, -21.523, -21.455, -21.314, -21.229 &amp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;               , -21.163, -21.126, -21.092, -21.060, -21.175 &amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;               , -21.280, -21.390, -21.547, -21.762, -22.050 &amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;               , -22.271, -22.521, -22.646, -22.660, -22.676 &amp;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;               , -22.688, -22.690, -22.662, -22.635, -22.609 &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               , -22.616, -22.646, -22.697, -22.740, -22.788 &amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;               , -22.815, -22.785, -22.754, -22.728, -22.703 &amp;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;               , -22.680, -22.630, -22.580, -22.530, -22.480 &amp; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;               , -22.430, -22.380, -22.330, -22.280, -22.230 &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;               , -22.180 /</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                 </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">n_mb</a> / 51 /</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a7a1c8e0f0aa6cea768bd790d1368e6a8">t_mb</a> / 4.0, 4.1, 4.2, 4.3, 4.4, &amp;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                 4.5, 4.6, 4.7, 4.8, 4.9, &amp;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                 5.0, 5.1, 5.2, 5.3, 5.4, &amp;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                 5.5, 5.6, 5.7, 5.8, 5.9, &amp;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                 6.0, 6.1, 6.2, 6.3, 6.4, &amp;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                 6.5, 6.6, 6.7, 6.8, 6.9, &amp;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                 7.0, 7.1, 7.2, 7.3, 7.4, &amp;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                 7.5, 7.6, 7.7, 7.8, 7.9, &amp;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                 8.0, 8.1, 8.2, 8.3, 8.4, &amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                 8.5, 8.6, 8.7, 8.8, 8.9, &amp;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                 9.0 /</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a11746fc81a29be58a85270c35a8799f3">l_mb</a>  / -23.133, -22.895, -22.548, -22.285, -22.099 &amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                , -21.970, -21.918, -21.826, -21.743, -21.638 &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                , -21.552, -21.447, -21.431, -21.418, -21.461 &amp;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                , -21.570, -21.743, -21.832, -21.908, -21.981 &amp;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                , -22.000, -21.998, -21.992, -22.013, -22.095 &amp;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                , -22.262, -22.397, -22.445, -22.448, -22.446 &amp;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                , -22.448, -22.465, -22.575, -22.725, -22.749 &amp;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                , -22.768, -22.753, -22.717, -22.678, -22.637 &amp;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                , -22.603, -22.553, -22.503, -22.453, -22.403 &amp;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                , -22.353, -22.303, -22.253, -22.203, -22.153 &amp;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                , -22.103 /</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">n_mlcosmol</a> / 71 /</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a72c7bb2cb2adcbdcf17aa70c36dc9ef6">t_mlcosmol</a> / &amp;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                 2.0, 2.1, 2.2, 2.3, 2.4, &amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                 2.5, 2.6, 2.7, 2.8, 2.9, &amp;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                 3.0, 3.1, 3.2, 3.3, 3.4, &amp;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                 3.5, 3.6, 3.7, 3.8, 3.9, &amp;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                 4.0, 4.1, 4.2, 4.3, 4.4, &amp;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                 4.5, 4.6, 4.7, 4.8, 4.9, &amp;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                 5.0, 5.1, 5.2, 5.3, 5.4, &amp;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                 5.5, 5.6, 5.7, 5.8, 5.9, &amp;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                 6.0, 6.1, 6.2, 6.3, 6.4, &amp;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                 6.5, 6.6, 6.7, 6.8, 6.9, &amp;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                 7.0, 7.1, 7.2, 7.3, 7.4, &amp;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                 7.5, 7.6, 7.7, 7.8, 7.9, &amp;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                 8.0, 8.1, 8.2, 8.3, 8.4, &amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                 8.5, 8.6, 8.7, 8.8, 8.9, &amp;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                 9.0 /</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a07c0aa1271a169576349e6deda1d219c">l_mlcosmol</a> / &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                 -99.000, -99.000, -99.000, -99.000, -99.000 &amp; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;               , -99.000, -99.000, -99.000, -99.000, -99.000 &amp;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;               , -99.000, -99.000, -99.000, -99.000, -99.000 &amp;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;               , -99.000, -44.649, -38.362, -33.324, -29.292 &amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;               , -26.063, -23.532, -22.192, -22.195, -22.454 &amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               , -22.676, -22.909, -22.925, -22.499, -22.276 &amp;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;               , -22.440, -22.688, -22.917, -23.116, -23.274 &amp;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;               , -23.394, -23.472, -23.516, -23.530, -23.525 &amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               , -23.506, -23.478, -23.444, -23.408, -23.368 &amp;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;               , -23.328, -23.286, -23.244, -23.201, -23.157 &amp;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               , -23.114, -23.070, -23.026, -22.981, -22.937 &amp;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;               , -22.893, -22.848, -22.803, -22.759, -22.714 &amp;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;               , -22.669, -22.619, -22.569, -22.519, -22.469 &amp;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;               , -22.419, -22.369, -22.319, -22.269, -22.190 &amp;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               , -22.169 /</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">n_mlwc</a> / 71 /</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#aa00eb7c5323358031d1d923adb79ee45">t_mlwc</a> / &amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                 2.0, 2.1, 2.2, 2.3, 2.4, &amp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                 2.5, 2.6, 2.7, 2.8, 2.9, &amp;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                 3.0, 3.1, 3.2, 3.3, 3.4, &amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                 3.5, 3.6, 3.7, 3.8, 3.9, &amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                 4.0, 4.1, 4.2, 4.3, 4.4, &amp;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                 4.5, 4.6, 4.7, 4.8, 4.9, &amp;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                 5.0, 5.1, 5.2, 5.3, 5.4, &amp;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                 5.5, 5.6, 5.7, 5.8, 5.9, &amp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                 6.0, 6.1, 6.2, 6.3, 6.4, &amp;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                 6.5, 6.6, 6.7, 6.8, 6.9, &amp;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                 7.0, 7.1, 7.2, 7.3, 7.4, &amp;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                 7.5, 7.6, 7.7, 7.8, 7.9, &amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                 8.0, 8.1, 8.2, 8.3, 8.4, &amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                 8.5, 8.6, 8.7, 8.8, 8.9, &amp;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                 9.0 /</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#ac7895ee8cc93a8e76b2a30be3faacab2">l_mlwc</a> / &amp;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                 -21.192, -21.160, -21.150, -21.150, -21.166 &amp; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               , -21.191, -21.222, -21.264, -21.308, -21.357 &amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;               , -21.408, -21.449, -21.494, -21.544, -21.587 &amp;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;               , -21.638, -21.686, -21.736, -21.780, -21.800 &amp;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;               , -21.744, -21.547, -21.208, -20.849, -20.345 &amp;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;               , -19.771, -19.409, -19.105, -18.827, -18.555 &amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;               , -18.460, -18.763, -19.168, -19.334, -19.400 &amp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;               , -19.701, -20.090, -20.288, -20.337, -20.301 &amp;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;               , -20.233, -20.275, -20.363, -20.508, -20.675 &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;               , -20.856, -21.025, -21.159, -21.256, -21.320 &amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;               , -21.354, -21.366, -21.361, -21.343, -21.317 &amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;               , -21.285, -21.250, -21.212, -21.172, -21.131 &amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;               , -21.089, -21.039, -20.989, -20.939, -20.889 &amp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;               , -20.839, -20.789, -20.739, -20.689, -20.639 &amp; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;               , -20.589 /</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">n_mlsolar1</a> / 71 /</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#aa61b47ca3f179f19eebb33541903ed04">t_mlsolar1</a> / &amp;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                       2.0, 2.1, 2.2, 2.3, 2.4, &amp;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                       2.5, 2.6, 2.7, 2.8, 2.9, &amp;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                        3.0, 3.1, 3.2, 3.3, 3.4, &amp;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                       3.5, 3.6, 3.7, 3.8, 3.9, &amp;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                       4.0, 4.1, 4.2, 4.3, 4.4, &amp;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                       4.5, 4.6, 4.7, 4.8, 4.9, &amp;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                       5.0, 5.1, 5.2, 5.3, 5.4, &amp;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                       5.5, 5.6, 5.7, 5.8, 5.9, &amp;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                       6.0, 6.1, 6.2, 6.3, 6.4, &amp;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                       6.5, 6.6, 6.7, 6.8, 6.9, &amp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                       7.0, 7.1, 7.2, 7.3, 7.4, &amp;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                       7.5, 7.6, 7.7, 7.8, 7.9, &amp;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                       8.0, 8.1, 8.2, 8.3, 8.4, &amp;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                       8.5, 8.6, 8.7, 8.8, 8.9, &amp;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                       9.0 /</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#ae3bf50014c5f9b160a1b9aa1d9b984e2">l_mlsolar1</a> / &amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                       -26.983, -26.951, -26.941, -26.940, -26.956 &amp;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                     , -26.980, -27.011, -27.052, -27.097, -27.145 &amp;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                     , -27.195, -27.235, -27.279, -27.327, -27.368 &amp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                     , -27.415, -27.456, -27.485, -27.468, -27.223 &amp;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                     , -25.823, -23.501, -22.162, -22.084, -22.157 &amp;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                     , -22.101, -21.974, -21.782, -21.542, -21.335 &amp;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                     , -21.251, -21.275, -21.236, -21.173, -21.167 &amp;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                     , -21.407, -21.670, -21.788, -21.879, -22.008 &amp;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                     , -22.192, -22.912, -22.918, -22.887, -22.929 &amp;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                     , -23.023, -23.094, -23.117, -23.108, -23.083 &amp;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                     , -23.049, -23.011, -22.970, -22.928, -22.885 &amp;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                     , -22.842, -22.798, -22.754, -22.709, -22.665 &amp;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                     , -22.620, -22.570, -22.520, -22.470, -22.420 &amp;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                     , -22.370, -22.320, -22.270, -22.220, -22.170 &amp;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                     , -22.120 /</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a> / 110 /</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#aea74a2a9c1a2b8083c5d0faa0591bc97">t_spex</a> / &amp;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                       3.80, 3.84, 3.88, 3.92, 3.96, &amp;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                       4.00, 4.04, 4.08, 4.12, 4.16, &amp;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                       4.20, 4.24, 4.28, 4.32, 4.36, &amp;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                       4.40, 4.44, 4.48, 4.52, 4.56, &amp;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                       4.60, 4.64, 4.68, 4.72, 4.76, &amp;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                       4.80, 4.84, 4.88, 4.92, 4.96, &amp;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                       5.00, 5.04, 5.08, 5.12, 5.16, &amp;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                       5.20, 5.24, 5.28, 5.32, 5.36, &amp;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                       5.40, 5.44, 5.48, 5.52, 5.56, &amp;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                       5.60, 5.64, 5.68, 5.72, 5.76, &amp;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                       5.80, 5.84, 5.88, 5.92, 5.96, &amp;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                       6.00, 6.04, 6.08, 6.12, 6.16, &amp;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                       6.20, 6.24, 6.28, 6.32, 6.36, &amp;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                       6.40, 6.44, 6.48, 6.52, 6.56, &amp;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                       6.60, 6.64, 6.68, 6.72, 6.76, &amp;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                       6.80, 6.84, 6.88, 6.92, 6.96, &amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                       7.00, 7.04, 7.08, 7.12, 7.16, &amp;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                       7.20, 7.24, 7.28, 7.32, 7.36, &amp;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                       7.40, 7.44, 7.48, 7.52, 7.56, &amp;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                       7.60, 7.64, 7.68, 7.72, 7.76, &amp;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                       7.80, 7.84, 7.88, 7.92, 7.96, &amp;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                       8.00, 8.04, 8.08, 8.12, 8.16  /</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a23553172a22d868a17b7600720fd97f7">l_spex</a> / &amp;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                      -25.7331, -25.0383, -24.4059, -23.8288, -23.3027 &amp;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    , -22.8242, -22.3917, -22.0067, -21.6818, -21.4529 &amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    , -21.3246, -21.3459, -21.4305, -21.5293, -21.6138 &amp;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    , -21.6615, -21.6551, -21.5919, -21.5092, -21.4124 &amp;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    , -21.3085, -21.2047, -21.1067, -21.0194, -20.9413 &amp;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    , -20.8735, -20.8205, -20.7805, -20.7547, -20.7455 &amp;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    , -20.7565, -20.7820, -20.8008, -20.7994, -20.7847 &amp;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    , -20.7687, -20.7590, -20.7544, -20.7505, -20.7545 &amp;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    , -20.7888, -20.8832, -21.0450, -21.2286, -21.3737 &amp;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    , -21.4573, -21.4935, -21.5098, -21.5345, -21.5863 &amp;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    , -21.6548, -21.7108, -21.7424, -21.7576, -21.7696 &amp;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    , -21.7883, -21.8115, -21.8303, -21.8419, -21.8514 &amp;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    , -21.8690, -21.9057, -21.9690, -22.0554, -22.1488 &amp;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    , -22.2355, -22.3084, -22.3641, -22.4033, -22.4282 &amp;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    , -22.4408, -22.4443, -22.4411, -22.4334, -22.4242 &amp;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    , -22.4164, -22.4134, -22.4168, -22.4267, -22.4418 &amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    , -22.4603, -22.4830, -22.5112, -22.5449, -22.5819 &amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    , -22.6177, -22.6483, -22.6719, -22.6883, -22.6985 &amp;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    , -22.7032, -22.7037, -22.7008, -22.6950, -22.6869 &amp;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    , -22.6769, -22.6655, -22.6531, -22.6397, -22.6258 &amp;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    , -22.6111, -22.5964, -22.5816, -22.5668, -22.5519 &amp;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    , -22.5367, -22.5216, -22.5062, -22.4912, -22.4753 /</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">nenh_spex</a> / &amp;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            0.000013264, 0.000042428, 0.000088276, 0.00017967 &amp;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          , 0.00084362,  0.0034295,   0.013283,    0.042008   &amp;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          , 0.12138,     0.30481,     0.53386,     0.76622    &amp;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          , 0.89459,     0.95414,     0.98342 &amp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          , 1.0046,    1.0291,    1.0547    &amp;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          , 1.0767,    1.0888    &amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          , 1.0945,    1.0972,    1.0988    &amp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          , 1.1004,    1.1034    &amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          , 1.1102,    1.1233,    1.1433    &amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          , 1.1638,    1.1791    &amp;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          , 1.1885,    1.1937,    1.1966    &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          , 1.1983,    1.1993    &amp;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          , 1.1999,    1.2004,    1.2008    &amp;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          , 1.2012,    1.2015    &amp;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          , 1.2020,    1.2025,    1.2030    &amp;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          , 1.2035,    1.2037    &amp;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          , 1.2039,    1.2040,    1.2041    &amp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          , 1.2042,    1.2044    &amp;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          , 1.2045,    1.2046,    1.2047    &amp;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          , 1.2049,    1.2050    &amp;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          , 1.2051,    1.2053,    1.2055    &amp;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          , 1.2056,    1.2058    &amp;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          , 1.2060,    1.2062,    1.2065    &amp;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          , 1.2067,    1.2070    &amp;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          , 1.2072,    1.2075,    1.2077    &amp;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          , 1.2078,    1.2079    &amp;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          , 1.2080,    1.2081,    1.2082    &amp;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          , 1.2083,    1.2083    &amp;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          , 1.2084,    1.2084,    1.2085    &amp;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          , 1.2085,    1.2086    &amp;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          , 1.2086,    1.2087,    1.2087    &amp;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          , 1.2088,    1.2088    &amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          , 1.2089,    1.2089,    1.2089    &amp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          , 1.2089,    1.2089    &amp;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          , 1.2090,    1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          , 1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          , 1.2090,    1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          , 1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          , 1.2090,    1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          , 1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          , 1.2090,    1.2090,    1.2090    &amp;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          , 1.2090,    1.2090    /   </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">! To be used together with the SPEX table for the SPEX_DM option</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">! Assuming an ionization fraction of 10^-3</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a> / 76 /</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a> / 1.00, 1.04, 1.08, 1.12, 1.16, 1.20 &amp;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                 , 1.24, 1.28, 1.32, 1.36, 1.40 &amp;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                 , 1.44, 1.48, 1.52, 1.56, 1.60 &amp;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                 , 1.64, 1.68, 1.72, 1.76, 1.80 &amp;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                 , 1.84, 1.88, 1.92, 1.96, 2.00 &amp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                 , 2.04, 2.08, 2.12, 2.16, 2.20 &amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                 , 2.24, 2.28, 2.32, 2.36, 2.40 &amp;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                 , 2.44, 2.48, 2.52, 2.56, 2.60 &amp; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                 , 2.64, 2.68, 2.72, 2.76, 2.80 &amp;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                 , 2.84, 2.88, 2.92, 2.96, 3.00 &amp;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                 , 3.04, 3.08, 3.12, 3.16, 3.20 &amp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                 , 3.24, 3.28, 3.32, 3.36, 3.40 &amp;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                 , 3.44, 3.48, 3.52, 3.56, 3.60 &amp; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                 , 3.64, 3.68, 3.72, 3.76, 3.80 &amp;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 , 3.84, 3.88, 3.92, 3.96, 4.00 /</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a> / -30.0377, -29.7062, -29.4055, -29.1331, -28.8864, -28.6631 &amp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                 , -28.4614, -28.2791, -28.1146, -27.9662, -27.8330 &amp;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                 , -27.7129, -27.6052, -27.5088, -27.4225, -27.3454 &amp;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                 , -27.2767, -27.2153, -27.1605, -27.1111, -27.0664 &amp;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                 , -27.0251, -26.9863, -26.9488, -26.9119, -26.8742 &amp;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                 , -26.8353, -26.7948, -26.7523, -26.7080, -26.6619 &amp;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                 , -26.6146, -26.5666, -26.5183, -26.4702, -26.4229 &amp;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                 , -26.3765, -26.3317, -26.2886, -26.2473, -26.2078 &amp;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                 , -26.1704, -26.1348, -26.1012, -26.0692, -26.0389 &amp;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                 , -26.0101, -25.9825, -25.9566, -25.9318, -25.9083 &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                 , -25.8857, -25.8645, -25.8447, -25.8259, -25.8085 &amp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                 , -25.7926, -25.7778, -25.7642, -25.7520, -25.7409 &amp;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                 , -25.7310, -25.7222, -25.7142, -25.7071, -25.7005 &amp;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                 , -25.6942, -25.6878, -25.6811, -25.6733, -25.6641 &amp;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                 , -25.6525, -25.6325, -25.6080, -25.5367, -25.4806  /</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">n_cl_solar</a> / 151 /</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a144fc5db0c90b80c011a46f75e83cc7a">t_cl_solar</a> /    &amp;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     1.000   ,   1.050   ,   1.100   ,   1.150   , &amp;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     1.200   ,   1.250   ,   1.300   ,   1.350   , &amp;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;     1.400   ,   1.450   ,   1.500   ,   1.550   , &amp;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;     1.600   ,   1.650   ,   1.700   ,   1.750   , &amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;     1.800   ,   1.850   ,   1.900   ,   1.950   , &amp;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;     2.000   ,   2.050   ,   2.100   ,   2.150   , &amp;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;     2.200   ,   2.250   ,   2.300   ,   2.350   , &amp; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     2.400   ,   2.450   ,   2.500   ,   2.550   , &amp;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     2.600   ,   2.650   ,   2.700   ,   2.750   , &amp;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     2.800   ,   2.850   ,   2.900   ,   2.950   , &amp;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     3.000   ,   3.050   ,   3.100   ,   3.150   , &amp;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;     3.200   ,   3.250   ,   3.300   ,   3.350   , &amp;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     3.400   ,   3.450   ,   3.500   ,   3.550   , &amp;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;     3.600   ,   3.650   ,   3.700   ,   3.750   , &amp;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;     3.800   ,   3.850   ,   3.900   ,   3.950   , &amp;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     4.000   ,   4.050   ,   4.100   ,   4.150   , &amp;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     4.200   ,   4.250   ,   4.300   ,   4.350   , &amp;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     4.400   ,   4.450   ,   4.500   ,   4.550   , &amp;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;     4.600   ,   4.650   ,   4.700   ,   4.750   , &amp;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;     4.800   ,   4.850   ,   4.900   ,   4.950   , &amp;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;     5.000   ,   5.050   ,   5.100   ,   5.150   , &amp;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;     5.200   ,   5.250   ,   5.300   ,   5.350   , &amp;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     5.400   ,   5.450   ,   5.500   ,   5.550   , &amp;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;     5.600   ,   5.650   ,   5.700   ,   5.750   , &amp;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;     5.800   ,   5.850   ,   5.900   ,   5.950   , &amp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;     6.000   ,   6.050   ,   6.100   ,   6.150   , &amp;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     6.200   ,   6.250   ,   6.300   ,   6.350   , &amp;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;     6.400   ,   6.450   ,   6.500   ,   6.550   , &amp;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;     6.600   ,   6.650   ,   6.700   ,   6.750   , &amp;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;     6.800   ,   6.850   ,   6.900   ,   6.950   , &amp;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;     7.000   ,   7.050   ,   7.100   ,   7.150   , &amp;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;     7.200   ,   7.250   ,   7.300   ,   7.350   , &amp;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;     7.400   ,   7.450   ,   7.500   ,   7.550   , &amp;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     7.600   ,   7.650   ,   7.700   ,   7.750   , &amp;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;     7.800   ,   7.850   ,   7.900   ,   7.950   , &amp;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;     8.000   ,   8.100   ,   8.200   ,   8.300   , &amp;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;     8.400   ,   8.500   ,   8.600   ,   8.700   , &amp;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;     8.800   ,   8.900   ,   9.00  / </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a90afb884c1b454cc032bbf9c4918136e">l_cl_solar</a> / &amp;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   -28.375   , -28.251   , -28.137   , -28.029   , &amp;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   -27.929   , -27.834   , -27.745   , -27.662   , &amp;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   -27.584   , -27.512   , -27.445   , -27.383   , &amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   -27.326   , -27.273   , -27.223   , -27.175   , &amp;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   -27.128   , -27.079   , -27.027   , -26.972   , &amp;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   -26.911   , -26.846   , -26.777   , -26.705   , &amp;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   -26.632   , -26.554   , -26.479   , -26.407   , &amp;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   -26.338   , -26.274   , -26.213   , -26.156   , &amp;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   -26.101   , -26.049   , -25.999   , -25.949   , &amp;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   -25.901   , -25.852   , -25.803   , -25.754   , &amp;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   -25.707   , -25.662   , -25.621   , -25.588   , &amp;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   -25.561   , -25.538   , -25.518   , -25.497   , &amp;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   -25.475   , -25.452   , -25.426   , -25.400   , &amp;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   -25.374   , -25.333   , -25.295   , -25.261   , &amp;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   -25.228   , -25.189   , -25.136   , -25.053   , &amp;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   -24.888   , -24.454   , -23.480   , -22.562   , &amp;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   -22.009   , -21.826   , -21.840   , -21.905   , &amp;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   -21.956   , -21.971   , -21.958   , -21.928   , &amp;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   -21.879   , -21.810   , -21.724   , -21.623   , &amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   -21.512   , -21.404   , -21.321   , -21.273   , &amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   -21.250   , -21.253   , -21.275   , -21.287   , &amp;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   -21.282   , -21.275   , -21.272   , -21.267   , &amp;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   -21.281   , -21.357   , -21.496   , -21.616   , &amp;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   -21.677   , -21.698   , -21.708   , -21.730   , &amp;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   -21.767   , -21.793   , -21.794   , -21.787   , &amp;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   -21.787   , -21.802   , -21.826   , -21.859   , &amp;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   -21.911   , -21.987   , -22.082   , -22.173   , &amp;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   -22.253   , -22.325   , -22.392   , -22.448   , &amp;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   -22.487   , -22.512   , -22.524   , -22.528   , &amp;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   -22.524   , -22.516   , -22.507   , -22.501   , &amp;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   -22.502   , -22.511   , -22.533   , -22.565   , &amp;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   -22.600   , -22.630   , -22.648   , -22.656   , &amp;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   -22.658   , -22.654   , -22.647   , -22.634   , &amp;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   -22.619   , -22.602   , -22.585   , -22.566   , &amp;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   -22.546   , -22.525   , -22.505   , -22.480   , &amp;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   -22.465   , -22.415   , -22.365   , -22.315   , &amp;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   -22.265   , -22.215   , -22.165   , -22.115   , &amp;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   -22.065   , -22.015   , -21.965   / </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">n_cl_ism</a> / 151 /</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#ab31b3d92c98eedfda0c3052596ff2672">t_cl_ism</a> / &amp;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;     1.000   ,   1.050   ,   1.100   ,   1.150   , &amp;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;     1.200   ,   1.250   ,   1.300   ,   1.350   , &amp;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     1.400   ,   1.450   ,   1.500   ,   1.550   , &amp;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;     1.600   ,   1.650   ,   1.700   ,   1.750   , &amp;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     1.800   ,   1.850   ,   1.900   ,   1.950   , &amp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;     2.000   ,   2.050   ,   2.100   ,   2.150   , &amp;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;     2.200   ,   2.250   ,   2.300   ,   2.350   , &amp;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;     2.400   ,   2.450   ,   2.500   ,   2.550   , &amp;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;     2.600   ,   2.650   ,   2.700   ,   2.750   , &amp;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     2.800   ,   2.850   ,   2.900   ,   2.950   , &amp;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     3.000   ,   3.050   ,   3.100   ,   3.150   , &amp;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     3.200   ,   3.250   ,   3.300   ,   3.350   , &amp;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;     3.400   ,   3.450   ,   3.500   ,   3.550   , &amp;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     3.600   ,   3.650   ,   3.700   ,   3.750   , &amp;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     3.800   ,   3.850   ,   3.900   ,   3.950   , &amp;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;     4.000   ,   4.050   ,   4.100   ,   4.150   , &amp;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;     4.200   ,   4.250   ,   4.300   ,   4.350   , &amp;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;     4.400   ,   4.450   ,   4.500   ,   4.550   , &amp;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;     4.600   ,   4.650   ,   4.700   ,   4.750   , &amp;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;     4.800   ,   4.850   ,   4.900   ,   4.950   , &amp;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     5.000   ,   5.050   ,   5.100   ,   5.150   , &amp;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;     5.200   ,   5.250   ,   5.300   ,   5.350   , &amp;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     5.400   ,   5.450   ,   5.500   ,   5.550   , &amp;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;     5.600   ,   5.650   ,   5.700   ,   5.750   , &amp;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;     5.800   ,   5.850   ,   5.900   ,   5.950   , &amp;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;     6.000   ,   6.050   ,   6.100   ,   6.150   , &amp;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     6.200   ,   6.250   ,   6.300   ,   6.350   , &amp;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;     6.400   ,   6.450   ,   6.500   ,   6.550   , &amp;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     6.600   ,   6.650   ,   6.700   ,   6.750   , &amp;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;     6.800   ,   6.850   ,   6.900   ,   6.950   , &amp;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     7.000   ,   7.050   ,   7.100   ,   7.150   , &amp;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;     7.200   ,   7.250   ,   7.300   ,   7.350   , &amp;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     7.400   ,   7.450   ,   7.500   ,   7.550   , &amp;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     7.600   ,   7.650   ,   7.700   ,   7.750   , &amp;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;     7.800   ,   7.850   ,   7.900   ,   7.950   , &amp;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     8.000   ,   8.100   ,   8.200   ,   8.300   , &amp;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     8.400   ,   8.500   ,   8.600   ,   8.700   , &amp;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     8.800   ,   8.900   ,   9.00    /</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keyword">data</span> <a class="code" href="namespacemod__radiative__cooling.html#ac62b4885715b9d9d8b142f39a1d69e59">l_cl_ism</a> / &amp;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   -28.365   , -28.242   , -28.127   , -28.020   , &amp;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   -27.919   , -27.825   , -27.736   , -27.653   , &amp;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   -27.575   , -27.504   , -27.437   , -27.376   , &amp;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   -27.319   , -27.267   , -27.220   , -27.176   , &amp;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   -27.134   , -27.095   , -27.058   , -27.021   , &amp;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   -26.985   , -26.948   , -26.910   , -26.870   , &amp;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   -26.827   , -26.775   , -26.721   , -26.664   , &amp;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   -26.608   , -26.552   , -26.495   , -26.437   , &amp;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   -26.378   , -26.317   , -26.255   , -26.190   , &amp;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   -26.123   , -26.053   , -25.984   , -25.913   , &amp;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   -25.847   , -25.786   , -25.736   , -25.702   , &amp;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   -25.678   , -25.662   , -25.649   , -25.636   , &amp;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   -25.621   , -25.604   , -25.587   , -25.571   , &amp;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   -25.562   , -25.526   , -25.505   , -25.499   , &amp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   -25.499   , -25.491   , -25.468   , -25.410   , &amp;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   -25.268   , -24.888   , -23.702   , -22.624   , &amp;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   -22.036   , -21.843   , -21.854   , -21.924   , &amp;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   -21.986   , -22.017   , -22.021   , -22.005   , &amp;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   -21.964   , -21.896   , -21.806   , -21.699   , &amp;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   -21.580   , -21.463   , -21.370   , -21.312   , &amp;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   -21.284   , -21.290   , -21.322   , -21.345   , &amp; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   -21.354   , -21.366   , -21.385   , -21.396   , &amp;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   -21.414   , -21.483   , -21.600   , -21.696   , &amp;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   -21.742   , -21.759   , -21.776   , -21.816   , &amp;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   -21.885   , -21.939   , -21.946   , -21.918   , &amp;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   -21.873   , -21.818   , -21.756   , -21.689   , &amp;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   -21.618   , -21.547   , -21.475   , -21.403   , &amp;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   -21.331   , -21.260   , -21.188   , -21.114   , &amp;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   -21.039   , -20.963   , -20.887   , -20.810   , &amp;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   -20.734   , -20.657   , -20.581   , -20.505   , &amp;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   -20.429   , -20.352   , -20.276   , -20.200   , &amp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   -20.125   , -20.049   , -19.973   , -19.898   , &amp;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   -19.822   , -19.747   , -19.671   , -19.596   , &amp;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   -19.520   , -19.445   , -19.370   , -19.295   , &amp;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   -19.220   , -19.144   , -19.069   , -18.994   , &amp;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   -18.919   , -18.869   , -18.819   , -18.769   , &amp;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   -18.719   , -18.669   , -18.619   , -18.569   , &amp;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   -18.519   , -18.469   , -18.419   /</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a> / 101 /</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a> / 4.00, 4.05, 4.10, 4.15, 4.20, 4.25, 4.30, 4.35, &amp;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                   4.40, 4.45, 4.50, 4.55, 4.60, 4.65, 4.70, 4.75, &amp;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                   4.80, 4.85, 4.90, 4.95, 5.00, 5.05, 5.10, 5.15, &amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                   5.20, 5.25, 5.30, 5.35, 5.40, 5.45, 5.50, 5.55, &amp;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                   5.60, 5.65, 5.70, 5.75, 5.80, 5.85, 5.90, 5.95, &amp;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                   6.00, 6.05, 6.10, 6.15, 6.20, 6.25, 6.30, 6.35, &amp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                   6.40, 6.45, 6.50, 6.55, 6.60, 6.65, 6.70, 6.75, &amp;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                   6.80, 6.85, 6.90, 6.95, 7.00, 7.05, 7.10, 7.15, &amp;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                   7.20, 7.25, 7.30, 7.35, 7.40, 7.45, 7.50, 7.55, &amp;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                   7.60, 7.65, 7.70, 7.75, 7.80, 7.85, 7.90, 7.95, &amp;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                   8.00, 8.05, 8.10, 8.15, 8.20, 8.25, 8.30, 8.35, &amp;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                   8.40, 8.45, 8.50, 8.55, 8.60, 8.65, 8.70, 8.75, &amp;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                   8.80, 8.85, 8.90, 8.95, 9.00                    /</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a8fbfc551634dce377658b2b1ab8a9413">l_dere_corona</a> / &amp;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; -23.00744648, -22.55439580, -22.15614458, -21.83268267, -21.64589156, &amp;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; -21.61618463, -21.68402965, -21.79048499, -21.87614836, -21.91009489, &amp;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; -21.89962945, -21.86012091, -21.79588002, -21.71669877, -21.62342304, &amp;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; -21.52143350, -21.41793664, -21.33068312, -21.27736608, -21.25181197, &amp;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; -21.24184538, -21.25806092, -21.27901426, -21.27164622, -21.24412514, &amp;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; -21.21467016, -21.19586057, -21.18309616, -21.18708664, -21.24108811, &amp;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; -21.35163999, -21.45099674, -21.48678240, -21.47625353, -21.45222529, &amp;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; -21.43297363, -21.42596873, -21.42021640, -21.41005040, -21.40120949, &amp;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; -21.40450378, -21.42250820, -21.44977165, -21.47755577, -21.51144928, &amp;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; -21.55909092, -21.63451202, -21.73754891, -21.85078089, -21.95467702, &amp;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; -22.03526908, -22.08990945, -22.11804503, -22.12436006, -22.11633856, &amp;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; -22.10072681, -22.08301995, -22.06701918, -22.05650548, -22.05551733, &amp;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; -22.06803389, -22.10072681, -22.15926677, -22.24033216, -22.32882716, &amp;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; -22.40782324, -22.47108330, -22.51855737, -22.54975089, -22.57024772, &amp;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; -22.58004425, -22.58335949, -22.58169871, -22.57511836, -22.56543110, &amp;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; -22.55439580, -22.54060751, -22.52724355, -22.51427857, -22.49894074, &amp;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; -22.48545225, -22.47108330, -22.45593196, -22.44009337, -22.42365865, &amp;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; -22.40671393, -22.38933984, -22.37059040, -22.35163999, -22.33161408, &amp;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; -22.31158018, -22.29073004, -22.26921772, -22.24795155, -22.22621356, &amp;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; -22.20411998, -22.18111459, -22.15864053, -22.13608262, -22.11294562, &amp;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; -22.08937560                                                          /</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a7f116c412a6622b43c3e6e58c6b35fb7">l_dere_photo</a> / &amp;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; -23.25649024, -22.74232143, -22.28988263, -21.93554201, -21.74232143, &amp;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; -21.72353820, -21.80410035, -21.91009489, -22.00000000, -22.04143612, &amp;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; -22.04575749, -22.02502801, -21.97469413, -21.89962945, -21.80410035, &amp;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; -21.69250396, -21.57511836, -21.46852108, -21.38827669, -21.33629907, &amp;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; -21.31069114, -21.31966449, -21.33724217, -21.32882716, -21.30189945, &amp;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; -21.27408837, -21.25649024, -21.24718357, -21.25649024, -21.32148162, &amp;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; -21.46092390, -21.61083392, -21.70774393, -21.74958000, -21.76955108, &amp;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; -21.79588002, -21.84466396, -21.88941029, -21.91009489, -21.91721463, &amp;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; -21.92811799, -21.94692156, -21.96657624, -21.99139983, -22.01412464, &amp;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; -22.04963515, -22.10402527, -22.17848647, -22.26201267, -22.34390180, &amp;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; -22.41680123, -22.47237010, -22.50723961, -22.52578374, -22.53313238, &amp;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; -22.53165267, -22.52578374, -22.51855737, -22.51286162, -22.51286162, &amp;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; -22.52143350, -22.54211810, -22.57839607, -22.62708800, -22.67366414, &amp;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; -22.70996539, -22.73282827, -22.74714697, -22.75202673, -22.74958000, &amp;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; -22.74232143, -22.73282827, -22.72124640, -22.70553377, -22.69036983, &amp;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; -22.67162040, -22.65364703, -22.63638802, -22.61618463, -22.59687948, &amp;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; -22.57675413, -22.55752023, -22.53610701, -22.51570016, -22.49485002, &amp;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; -22.47366072, -22.45222529, -22.42945706, -22.40782324, -22.38510278, &amp;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; -22.36251027, -22.33913452, -22.31605287, -22.29242982, -22.26921772, &amp;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; -22.24565166, -22.22184875, -22.19859629, -22.17457388, -22.15058059, &amp;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; -22.12609840                                                          /           </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a> / 55 /</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a4cf4f74ba22dc1a976d3ecea5f283b31">t_colgan</a> / 4.06460772, 4.14229559, 4.21995109, 4.29760733, 4.37527944, 4.45293587, &amp;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                     4.53060946, 4.60826923, 4.68592974, 4.76359269, 4.79704583, 4.83049243, &amp;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                     4.86394114, 4.89738514, 4.93083701, 4.96428321, 4.99773141, 5.03116600, &amp;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                     5.06460772, 5.17574368, 5.28683805, 5.39795738, 5.50906805, 5.62017771, &amp;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                     5.73129054, 5.84240328, 5.95351325, 6.06460772, 6.17574368, 6.28683805, &amp;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                     6.39795738, 6.50906805, 6.62017771, 6.73129054, 6.84240328, 6.95351325, &amp;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                     7.06460772, 7.17574368, 7.28683805, 7.39795738, 7.50906805, 7.62017771, &amp;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                     7.73129054, 7.84240328, 7.95351325, 8.06460772, 8.17574368, 8.28683805, &amp;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                     8.39795738, 8.50906805, 8.62017771, 8.73129054, 8.84240328, 8.95351325, &amp; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                     9.06460772                                                              /</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">data</span>    <a class="code" href="namespacemod__radiative__cooling.html#a378372e4dbb44f94e26e1b7e67d59f9f">l_colgan</a> / -22.18883401, -21.78629635, -21.60383554, -21.68480662, -21.76444630, &amp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                     -21.67935529, -21.54217864, -21.37958284, -21.25171892, -21.17584161, &amp;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                     -21.15783402, -21.14491111, -21.13526945, -21.12837453, -21.12485189, &amp;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                     -21.12438898, -21.12641785, -21.12802448, -21.12547760, -21.08964778, &amp;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                     -21.08812360, -21.19542445, -21.34582346, -21.34839251, -21.31700703, &amp;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                     -21.29072156, -21.28900309, -21.34104468, -21.43122351, -21.62448270, &amp;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                     -21.86694036, -22.02897478, -22.08050874, -22.06057061, -22.01973295, &amp;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                     -22.00000434, -22.05161149, -22.22175466, -22.41451671, -22.52581288, &amp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                     -22.56913516, -22.57485721, -22.56150512, -22.53968863, -22.51490350, &amp;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                     -22.48895932, -22.46071057, -22.42908363, -22.39358639, -22.35456791, &amp;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                     -22.31261375, -22.26827428, -22.22203698, -22.17422996, -22.12514145  /</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keyword">contains</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">    !&gt; Radiative cooling initialization</span></div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#ae450293b5673565067dbec5188ed3325">  780</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ae450293b5673565067dbec5188ed3325">radiative_cooling_init_params</a>(phys_gamma,He_abund)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: phys_gamma,He_abund</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      rc_gamma=phys_gamma</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      he_abundance=he_abund</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ae450293b5673565067dbec5188ed3325">radiative_cooling_init_params</a></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a2c0aab05964e01b97b9ae65c6d2ea830">  789</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a2c0aab05964e01b97b9ae65c6d2ea830">radiative_cooling_init</a>(fl,read_params)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keyword">interface</span> </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keyword">subroutine </span>read_params(fl)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">unitpar</a>,<a class="code" href="namespacemod__global__parameters.html#a551004039cf74031e6bf9e613eb24e64">par_files</a></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keywordtype">import </span><a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(inout)</span> :: fl</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keyword">end subroutine </span>read_params</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keyword">end interface  </span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(inout)</span> :: fl</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: t_table</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: L_table</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordtype">double precision</span> :: ratt, Lerror</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordtype">double precision</span> ::fact1, fact2, fact3, dL1, dL2</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordtype">double precision</span> :: tstep, Lstep</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordtype">integer</span> :: ntable, i, j, ic, idir</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordtype">logical</span> :: jump</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordtype">Character(len=65)</span> :: PPL_curves(1:6)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      fl%ncool=4000</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      fl%coolcurve=<span class="stringliteral">&#39;JCcorona&#39;</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      fl%coolmethod=<span class="stringliteral">&#39;exact&#39;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      fl%tlow=bigdouble</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      fl%Tfix=.false.</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      fl%rc_split=.false.</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keyword">call </span>read_params(fl)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">! Checks if coolcurve is a piecewise power law (PPL)</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      ppl_curves = [<span class="keywordtype">Character(len=65)</span> :: <span class="stringliteral">&#39;Hildner&#39;</span>,<span class="stringliteral">&#39;FM&#39;</span>, <span class="stringliteral">&#39;Rosner&#39;</span>, <span class="stringliteral">&#39;Klimchuk&#39;</span>,<span class="stringliteral">&#39;SPEX_DM_rough&#39;</span>,<span class="stringliteral">&#39;SPEX_DM_fine&#39;</span>]</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(ppl_curves)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         <span class="keywordflow">if</span> (ppl_curves(i)==fl%coolcurve) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            fl%isPPL = .true.</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">! Init for PPL</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">if</span> (fl%isPPL) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         <span class="comment">! Read in tables and create t_PPL, l_PPL, a_PPL</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         <span class="keywordflow">select case</span>(fl%coolcurve)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Hildner&#39;</span>)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            print *,<span class="stringliteral">&#39;Use Hildner (1974) piecewise power law&#39;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#a29b26e00937bc4f9a21b3b0606b23b77">t_hildner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a>+1)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#a28ef07b7764445dfe9169b10ed165c00">a_hildner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a>)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#a77a4bb25c093933a6a0dee150cbf348f">x_hildner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">n_hildner</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL)        </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;FM&#39;</span>)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            print *,<span class="stringliteral">&#39;Use Forbes and Malherbe (1991)-like piecewise power law&#39;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;             </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#a0091341d39b71e093c116406e851d6f1">t_fm</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a>+1)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#a51b6cce389bb5faf48cc0778a9c6abf5">a_fm</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a>)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#a9c8d50c8c6c519a6b3c7d1a916d42b91">x_fm</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">n_fm</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL) </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Rosner&#39;</span>)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            print *,<span class="stringliteral">&#39;Use piecewise power law according to Rosner (1978)&#39;</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            print *,<span class="stringliteral">&#39;and extended by Priest (1982) from Van Der Linden (1991)&#39;</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;             </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;         </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#a49f6dbe5de1126c72f6ecf2c77c23da7">t_rosner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a>+1)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#ae1c63cc7af1e58b105cfa0b2861bd275">a_rosner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a>)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#a93998291fb002bd7160c79cba04994b3">x_rosner</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">n_rosner</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL)  </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Klimchuk&#39;</span>)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            print *,<span class="stringliteral">&#39;Use Klimchuk (2008) piecewise power law&#39;</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;             </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;         </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#ab92582fd2be7a4f7caf8ee633e26f60f">t_klimchuk</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a>+1)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#adf796515078f438e7309b608f5e63454">a_klimchuk</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a>)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#a94896dac9a3cf4e4d7c5c927bcce4dad">x_klimchuk</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">n_klimchuk</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL)  </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;SPEX_DM_rough&#39;</span>)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            print *,<span class="stringliteral">&#39;Use the rough piece wise power law fit to the SPEX_DM curve (2009)&#39;</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;             </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;         </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#ad973210231bc7335c3c8ef47f0d49adf">t_spex_dm_rough</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a>+1)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#a991bb73b9d368ac04331bb070bba0870">a_spex_dm_rough</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a>)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#a34cec942eec1a95a875a92d2e87719e5">x_spex_dm_rough</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">n_spex_dm_rough</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL)  </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;SPEX_DM_fine&#39;</span>)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            print *,<span class="stringliteral">&#39;Use the fine, detailed piece wise power law fit to the SPEX_DM curve (2009)&#39;</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            fl%n_PPL = <a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;         </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keyword">allocate</span>(fl%t_PPL(1:fl%n_PPL+1), fl%l_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="keyword">allocate</span>(fl%a_PPL(1:fl%n_PPL))</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            fl%t_PPL(1:fl%n_PPL+1) = <a class="code" href="namespacemod__radiative__cooling.html#a757a058f85b83b210fb6429d656bef0b">t_spex_dm_fine</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a>+1)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            fl%a_PPL(1:fl%n_PPL) = <a class="code" href="namespacemod__radiative__cooling.html#a7bd34991ed29076faea8d491271e5413">a_spex_dm_fine</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a>)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            fl%l_PPL(1:fl%n_PPL) = 10.d0**<a class="code" href="namespacemod__radiative__cooling.html#aef014e49d490cee95079a24f8e1f1771">x_spex_dm_fine</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">n_spex_dm_fine</a>) * (10.d0**fl%t_PPL(1:fl%n_PPL))**fl%a_PPL(1:fl%n_PPL) </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keywordflow">         case default</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keyword">call </span><a class="code" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a>(<span class="stringliteral">&quot;This piecewise power law is unknown&quot;</span>)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordflow">         end select</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         <span class="comment">! Go from logarithmic to actual values.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;         fl%t_PPL(1:fl%n_PPL+1) = 10.d0**fl%t_PPL(1:fl%n_PPL+1)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;         </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;         <span class="comment">! Change unit of table if SI is used instead of cgs</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__global__parameters.html#aa772c499c35e8325d16e2a8a824f1660">si_unit</a>) fl%l_PPL(1:fl%n_PPL) = fl%l_PPL(1:fl%n_PPL) * 10.0d0**(-13)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;         </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         <span class="comment">! Make dimensionless</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;         fl%t_PPL(1:fl%n_PPL+1) = fl%t_PPL(1:fl%n_PPL+1) / <a class="code" href="namespacemod__global__parameters.html#aa1fac5bb69ce3e968348d1435b29f1ac">unit_temperature</a></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;         fl%l_PPL(1:fl%n_PPL) = fl%l_PPL(1:fl%n_PPL) * <a class="code" href="namespacemod__global__parameters.html#a4296e156fded38497eb361e3acc27355">unit_numberdensity</a>**2 * <a class="code" href="namespacemod__global__parameters.html#a1e1a3e9685ff4fd0cafa15061c6d0d8f">unit_time</a> / <a class="code" href="namespacemod__global__parameters.html#a444384f0dec61b149b0b1f969a8b5e77">unit_pressure</a> * (1.d0+2.d0*he_abundance)        </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         <span class="comment">! Set tref en lref</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         fl%l_PPL(fl%n_PPL+1) = fl%l_PPL(fl%n_PPL) * ( fl%t_PPL(fl%n_PPL+1) / fl%t_PPL(fl%n_PPL) )**fl%a_PPL(fl%n_PPL)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         fl%lref = fl%l_PPL(fl%n_PPL+1)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         fl%tref = fl%t_PPL(fl%n_PPL+1)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         <span class="comment">! Set tcoolmin and tcoolmax</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         fl%tcoolmin = fl%t_PPL(1)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;         fl%tcoolmax = fl%t_PPL(fl%n_PPL+1)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;         <span class="comment">! smaller value for lowest temperatures from cooling table and user&#39;s choice</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;         <span class="keywordflow">if</span> (fl%tlow==bigdouble) fl%tlow=fl%tcoolmin</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;         <span class="comment">!create y_PPL</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a5e673c837df3fbd572820caf874c3c7f">create_y_ppl</a>(fl)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;         <span class="comment">! Init for interpolatable tables</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;         <span class="keyword">allocate</span>(fl%tcool(1:fl%ncool), fl%Lcool(1:fl%ncool), fl%dLdtcool(1:fl%ncool))</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;         <span class="keyword">allocate</span>(fl%Yc(1:fl%ncool), fl%invYc(1:fl%ncool))</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;         fl%tcool(1:fl%ncool)    = zero</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;         fl%Lcool(1:fl%ncool)    = zero</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;         fl%dLdtcool(1:fl%ncool) = zero</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;         </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;         <span class="comment">! Read in the selected cooling curve</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         <span class="keywordflow">select case</span>(fl%coolcurve)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;JCcorona&#39;</span>)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            print *,<span class="stringliteral">&#39;Use Colgan &amp; Feldman (2008) cooling curve&#39;</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            print *,<span class="stringliteral">&#39;This version only till 10000 K, beware for floor T treatment&#39;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">n_jccorona</a></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a9e7237a0a6c123c52f3c517ad882475f">t_jccorona</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">n_jccorona</a>)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a8936dfcd3aefa0a853fe4153ac850e92">l_jccorona</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">n_jccorona</a>)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;DM&#39;</span>)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            print *,<span class="stringliteral">&#39;Use Dalgarno &amp; McCray (1972) cooling curve&#39;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">n_dm</a></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#af18323578e93aa12585a85a929bbc71b">t_dm</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">n_dm</a>)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a9217661a6d1b782ac684c8513e4bf01c">l_dm</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">n_dm</a>)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MB&#39;</span>)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;Use MacDonald &amp; Bailey (1981) cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                 ,<span class="stringliteral">&#39;as implemented in ZEUS-3D, with the values &#39;</span>&amp;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                 ,<span class="stringliteral">&#39;from Dalgarno &amp; McCRay (1972) for low temperatures.&#39;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">n_mb</a> + 20</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#af18323578e93aa12585a85a929bbc71b">t_dm</a>(1:21)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a9217661a6d1b782ac684c8513e4bf01c">l_dm</a>(1:21)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            t_table(22:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a7a1c8e0f0aa6cea768bd790d1368e6a8">t_mb</a>(2:<a class="code" href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">n_mb</a>)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            l_table(22:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a11746fc81a29be58a85270c35a8799f3">l_mb</a>(2:<a class="code" href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">n_mb</a>)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MLcosmol&#39;</span>)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            print *,<span class="stringliteral">&#39;Use Mellema &amp; Lundqvist (2002) cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                 ,<span class="stringliteral">&#39;for zero metallicity &#39;</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">n_mlcosmol</a></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a72c7bb2cb2adcbdcf17aa70c36dc9ef6">t_mlcosmol</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">n_mlcosmol</a>)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a07c0aa1271a169576349e6deda1d219c">l_mlcosmol</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">n_mlcosmol</a>)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MLwc&#39;</span>)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            print *,<span class="stringliteral">&#39;Use Mellema &amp; Lundqvist (2002) cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                 ,<span class="stringliteral">&#39;for WC-star metallicity &#39;</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">n_mlwc</a></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#aa00eb7c5323358031d1d923adb79ee45">t_mlwc</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">n_mlwc</a>)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#ac7895ee8cc93a8e76b2a30be3faacab2">l_mlwc</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">n_mlwc</a>)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;MLsolar1&#39;</span>)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            print *,<span class="stringliteral">&#39;Use Mellema &amp; Lundqvist (2002) cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                 ,<span class="stringliteral">&#39;for solar metallicity &#39;</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">n_mlsolar1</a></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#aa61b47ca3f179f19eebb33541903ed04">t_mlsolar1</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">n_mlsolar1</a>)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#ae3bf50014c5f9b160a1b9aa1d9b984e2">l_mlsolar1</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">n_mlsolar1</a>)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;cloudy_ism&#39;</span>)</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            print *,<span class="stringliteral">&#39;Use Cloudy based cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                 ,<span class="stringliteral">&#39;for ism metallicity &#39;</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">n_cl_ism</a></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#ab31b3d92c98eedfda0c3052596ff2672">t_cl_ism</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">n_cl_ism</a>)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#ac62b4885715b9d9d8b142f39a1d69e59">l_cl_ism</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">n_cl_ism</a>)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;cloudy_solar&#39;</span>)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            print *,<span class="stringliteral">&#39;Use Cloudy based cooling curve &#39;</span>&amp;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                 ,<span class="stringliteral">&#39;for solar metallicity &#39;</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">n_cl_solar</a></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a144fc5db0c90b80c011a46f75e83cc7a">t_cl_solar</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">n_cl_solar</a>)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a90afb884c1b454cc032bbf9c4918136e">l_cl_solar</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">n_cl_solar</a>)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;SPEX&#39;</span>)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            print *,<span class="stringliteral">&#39;Use SPEX cooling curve (Schure et al. 2009) &#39;</span>&amp;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                 ,<span class="stringliteral">&#39;for solar metallicity &#39;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#aea74a2a9c1a2b8083c5d0faa0591bc97">t_spex</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a23553172a22d868a17b7600720fd97f7">l_spex</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>) + log10(<a class="code" href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">nenh_spex</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>))</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;SPEX_DM&#39;</span>)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;               print *, <span class="stringliteral">&#39;Use SPEX cooling curve for solar metallicity above 10^4 K. &#39;</span> </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;               print *, <span class="stringliteral">&#39;At lower temperatures,use Dalgarno &amp; McCray (1972), &#39;</span> </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;               print *, <span class="stringliteral">&#39;with a pre-set ionization fraction of 10^-3. &#39;</span> </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;               print *, <span class="stringliteral">&#39;as described by Schure et al. (2009). &#39;</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a> + <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a> - 6</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            t_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            l_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            t_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#aea74a2a9c1a2b8083c5d0faa0591bc97">t_spex</a>(6:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            l_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a23553172a22d868a17b7600720fd97f7">l_spex</a>(6:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>) + log10(<a class="code" href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">nenh_spex</a>(6:<a class="code" href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">n_spex</a>))</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Dere_corona&#39;</span>)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            print *,<span class="stringliteral">&#39;Use Dere (2009) cooling curve for solar corona&#39;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a8fbfc551634dce377658b2b1ab8a9413">l_dere_corona</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Dere_corona_DM&#39;</span>)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            print *, <span class="stringliteral">&#39;Combination of Dere_corona (2009) for high temperatures and&#39;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            print *, <span class="stringliteral">&#39;Dalgarno &amp; McCray (1972), DM2, for low temperatures&#39;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a> + <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a> - 1 </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            t_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            l_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            t_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            l_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a8fbfc551634dce377658b2b1ab8a9413">l_dere_corona</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Dere_photo&#39;</span>)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a> ==0) &amp;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            print *,<span class="stringliteral">&#39;Use Dere (2009) cooling curve for solar photophere&#39;</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;         </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a7f116c412a6622b43c3e6e58c6b35fb7">l_dere_photo</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Dere_photo_DM&#39;</span>)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            print *, <span class="stringliteral">&#39;Combination of Dere_photo (2009) for high temperatures and&#39;</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            print *, <span class="stringliteral">&#39;Dalgarno &amp; McCray (1972), DM2, for low temperatures&#39;</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a> + <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a> - 1 </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            t_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            l_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1) = <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>-1)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            t_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">t_dere</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            l_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a7f116c412a6622b43c3e6e58c6b35fb7">l_dere_photo</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">n_dere</a>)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Colgan&#39;</span>)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0) &amp;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            print *, <span class="stringliteral">&#39;Use Colgan (2008) cooling curve&#39;</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            t_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a4cf4f74ba22dc1a976d3ecea5f283b31">t_colgan</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a>)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            l_table(1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a378372e4dbb44f94e26e1b7e67d59f9f">l_colgan</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a>)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         <span class="keywordflow">case</span>(<span class="stringliteral">&#39;Colgan_DM&#39;</span>)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            print *, <span class="stringliteral">&#39;Combination of Colgan (2008) for high temperatures and&#39;</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)&amp;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            print *, <span class="stringliteral">&#39;Dalgarno &amp; McCray (1972), DM2, for low temperatures&#39;</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            ntable = <a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a> + <a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keyword">allocate</span>(t_table(1:ntable))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keyword">allocate</span>(l_table(1:ntable))</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            t_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>) = <a class="code" href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">t_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            l_table(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>) = <a class="code" href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">l_dm_2</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            t_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>+1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a4cf4f74ba22dc1a976d3ecea5f283b31">t_colgan</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a>)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            l_table(<a class="code" href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">n_dm_2</a>+1:ntable) = <a class="code" href="namespacemod__radiative__cooling.html#a378372e4dbb44f94e26e1b7e67d59f9f">l_colgan</a>(1:<a class="code" href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">n_colgan</a>)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="keywordflow">         case default</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <span class="keyword">call </span><a class="code" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a>(<span class="stringliteral">&quot;This coolingcurve is unknown&quot;</span>)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="keywordflow">         end select</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;         <span class="comment">! create cooling table(s) for use in amrvac</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;         fl%tcoolmax = t_table(ntable)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         fl%tcoolmin = t_table(1)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         ratt     = (fl%tcoolmax-fl%tcoolmin)/( dble(fl%ncool-1) + smalldouble)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         fl%tcool(1) = fl%tcoolmin</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;         fl%Lcool(1) = l_table(1)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;         </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         fl%tcool(fl%ncool) = fl%tcoolmax</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         fl%Lcool(fl%ncool) = l_table(ntable)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;         </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;         <span class="keywordflow">do</span> i=2,fl%ncool        <span class="comment">! loop to create one table</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;           fl%tcool(i) = fl%tcool(i-1)+ratt</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;           <span class="keywordflow">do</span> j=1,ntable-1   <span class="comment">! loop to create one spot on a table</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;           <span class="comment">! Second order polynomial interpolation, except at the outer edge, </span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;           <span class="comment">! or in case of a large jump.</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;             <span class="keywordflow">if</span>(fl%tcool(i) &lt; t_table(j+1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                <span class="keywordflow">if</span>(j.eq. ntable-1 )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                  fact1 = (fl%tcool(i)-t_table(j+1))     &amp;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                        /(t_table(j)-t_table(j+1)) </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                  fact2 = (fl%tcool(i)-t_table(j))       &amp;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        /(t_table(j+1)-t_table(j)) </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                  fl%Lcool(i) = l_table(j)*fact1 + l_table(j+1)*fact2 </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                  <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                  dl1 = l_table(j+1)-l_table(j)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                  dl2 = l_table(j+2)-l_table(j+1)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                  jump =(max(dabs(dl1),dabs(dl2)) &gt; 2*min(dabs(dl1),dabs(dl2)))</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">                endif</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                  </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <span class="keywordflow">if</span>( jump ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                  fact1 = (fl%tcool(i)-t_table(j+1))     &amp;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        /(t_table(j)-t_table(j+1)) </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                  fact2 = (fl%tcool(i)-t_table(j))       &amp;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                        /(t_table(j+1)-t_table(j)) </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                         </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                  fl%Lcool(i) = l_table(j)*fact1 + l_table(j+1)*fact2</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                  <span class="keywordflow">exit</span>          </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                  fact1 = ((fl%tcool(i)-t_table(j+1))     &amp;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        * (fl%tcool(i)-t_table(j+2)))   &amp;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                        / ((t_table(j)-t_table(j+1)) &amp;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        * (t_table(j)-t_table(j+2)))</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                  fact2 = ((fl%tcool(i)-t_table(j))       &amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        * (fl%tcool(i)-t_table(j+2)))   &amp;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                        / ((t_table(j+1)-t_table(j)) &amp;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                        * (t_table(j+1)-t_table(j+2)))</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                  fact3 = ((fl%tcool(i)-t_table(j))       &amp;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                        * (fl%tcool(i)-t_table(j+1)))   &amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                        / ((t_table(j+2)-t_table(j)) &amp;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                        * (t_table(j+2)-t_table(j+1)))</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;         </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                  fl%Lcool(i) = l_table(j)*fact1 + l_table(j+1)*fact2 &amp;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                           + l_table(j+2)*fact3</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                  <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="keywordflow">                endif</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="keywordflow">             endif</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordflow">           enddo</span>  <span class="comment">! end loop to find create one spot on a table</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="keywordflow">         enddo</span>    <span class="comment">! end loop to create one table</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         <span class="comment">! Go from logarithmic to actual values.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         fl%tcool(1:fl%ncool) = 10.0d0**fl%tcool(1:fl%ncool)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;         fl%Lcool(1:fl%ncool) = 10.0d0**fl%Lcool(1:fl%ncool)</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         <span class="comment">! Change unit of table if SI is used instead of cgs</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__global__parameters.html#aa772c499c35e8325d16e2a8a824f1660">si_unit</a>) fl%Lcool(1:fl%ncool) = fl%Lcool(1:fl%ncool) * 10.0d0**(-13)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;         </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="comment">! Scale both T and Lambda</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         fl%tcool(1:fl%ncool) = fl%tcool(1:fl%ncool) / <a class="code" href="namespacemod__global__parameters.html#aa1fac5bb69ce3e968348d1435b29f1ac">unit_temperature</a></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         fl%Lcool(1:fl%ncool) = fl%Lcool(1:fl%ncool) * <a class="code" href="namespacemod__global__parameters.html#a4296e156fded38497eb361e3acc27355">unit_numberdensity</a>**2 * <a class="code" href="namespacemod__global__parameters.html#a1e1a3e9685ff4fd0cafa15061c6d0d8f">unit_time</a> / <a class="code" href="namespacemod__global__parameters.html#a444384f0dec61b149b0b1f969a8b5e77">unit_pressure</a> * (1.d0+2.d0*he_abundance) </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;         fl%tcoolmin       = fl%tcool(1)+smalldouble  <span class="comment">! avoid pointless interpolation</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;         <span class="comment">! smaller value for lowest temperatures from cooling table and user&#39;s choice</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         <span class="keywordflow">if</span> (fl%tlow==bigdouble) fl%tlow=fl%tcoolmin</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;         fl%tcoolmax       = fl%tcool(fl%ncool)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;         fl%lgtcoolmin = dlog10(fl%tcoolmin)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;         fl%lgtcoolmax = dlog10(fl%tcoolmax)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         fl%lgstep = (fl%lgtcoolmax-fl%lgtcoolmin) * 1.d0 / (fl%ncool-1)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         fl%dLdtcool(1)     = (fl%Lcool(2)-fl%Lcool(1))/(fl%tcool(2)-fl%tcool(1))</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         fl%dLdtcool(fl%ncool) = (fl%Lcool(fl%ncool)-fl%Lcool(fl%ncool-1))/(fl%tcool(fl%ncool)-fl%tcool(fl%ncool-1))</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;         <span class="keywordflow">do</span> i=2,fl%ncool-1</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;           fl%dLdtcool(i) = (fl%Lcool(i+1)-fl%Lcool(i-1))/(fl%tcool(i+1)-fl%tcool(i-1))</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;         <span class="keyword">deallocate</span>(t_table)</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;         <span class="keyword">deallocate</span>(l_table)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;         <span class="keywordflow">if</span>( fl%coolmethod == <span class="stringliteral">&#39;exact&#39;</span> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            fl%tref = fl%tcoolmax</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            fl%lref = fl%Lcool(fl%ncool)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            fl%Yc(fl%ncool) = zero</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="keywordflow">do</span> i=fl%ncool-1, 1, -1</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;               fl%Yc(i) = fl%Yc(i+1)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;               <span class="keywordflow">do</span> j=1,100</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                  tstep = 1.0<a class="code" href="namespacemod__global__parameters.html#a68549065c490d02e1de338e8a60c3f12">d</a>-2*(fl%tcool(i+1)-fl%tcool(i))</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(fl%tcool(i+1)-j*tstep, lstep, fl)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                  fl%Yc(i) = fl%Yc(i) + fl%lref/fl%tref*tstep/lstep</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="keywordflow">               enddo</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="keywordflow">            enddo</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="keywordflow">      endif</span>       </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a2c0aab05964e01b97b9ae65c6d2ea830">radiative_cooling_init</a></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a5e673c837df3fbd572820caf874c3c7f"> 1286</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a5e673c837df3fbd572820caf874c3c7f">create_y_ppl</a> (fl)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">!  creates the constants of integration needed for solving</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">!  the cooling law exact for a piecewise power law </span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">!  In correspondence with eq. A6 of Townsend (2009)</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>) :: fl</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordtype">double precision</span> :: y_extra, factor</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keyword">allocate</span>(fl%y_PPL(1:fl%n_PPL+1))</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      fl%y_PPL(1:fl%n_PPL+1) = zero</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordflow">do</span> i=fl%n_PPL, 1, -1 </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;          factor = fl%l_PPL(fl%n_PPL+1) * fl%t_PPL(i) / (fl%l_PPL(i) * fl%t_PPL(fl%n_PPL+1))</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;          <span class="keywordflow">if</span> (fl%a_PPL(i) == 1.d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;             y_extra =  log( fl%t_PPL(i) / fl%t_PPL(i+1) )</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;             y_extra = 1 / (1 - fl%a_PPL(i)) * (1 - ( fl%t_PPL(i) / fl%t_PPL(i+1) )**(fl%a_PPL(i)-1) )</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          fl%y_PPL(i) = fl%y_PPL(i+1) - factor*y_extra</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a5e673c837df3fbd572820caf874c3c7f">create_y_ppl</a></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a6ce0229b23f942e86c22b3c89f7f96dd"> 1314</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a6ce0229b23f942e86c22b3c89f7f96dd">cooling_get_dt</a>(w,ixI^L,ixO^L,dtnew,dx^D,x,fl)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ixI^L, ixO^L</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: dx^D, x(ixI^S,1:ndim), w(ixI^S,1:nw)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: dtnew</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordtype">double precision</span> :: etherm(ixI^S), rho(ixI^S)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordtype">double precision</span> :: L1,Tlocal1, ptherm(ixI^S), lum(ixI^S), Rfactor(ixI^S)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordtype">double precision</span> :: Lmax</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="comment">! Limit timestep to avoid cooling problems when using explicit cooling</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keywordflow">if</span>(fl%coolmethod == <span class="stringliteral">&#39;explicit1&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;       <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,ptherm)   </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;       <span class="keyword">call </span>fl%get_rho(w,x,ixi^l,ixo^l,rho)   </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;       <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="keywordflow">       endif</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;       {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;         tlocal1       = max(plocal/(rfactor(ix^d) * rholocal),smalldouble)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;         <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;         <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            l1 = zero</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1, fl)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="comment">!L1         = fl%Lcool(fl%ncool)*sqrt(Tlocal1/fl%tcoolmax)</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;         <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;         lum(ix^d) = l1</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        {enddo^d&amp;\}</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        etherm(ixo^s)=ptherm(ixo^s)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        dtnew =fl%cfrac*minval(etherm(ixo^s)/max(lum(ixo^s),smalldouble))</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a6ce0229b23f942e86c22b3c89f7f96dd">cooling_get_dt</a></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#ad4443dccc06f84fa778fea1d541b7f4d"> 1367</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ad4443dccc06f84fa778fea1d541b7f4d">getvar_cooling</a>(ixI^L,ixO^L,w,x,coolrate,fl)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">! Create extra variable to show cooling rate in the output</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">! Uses a simple explicit scheme. </span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">! N.B. Since there is no knowledge of the timestep size, </span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">! there is no upper limit for the cooling rate.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>          :: ixI^L,ixO^L</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: x(ixI^S,1:ndim)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordtype">double precision</span>             :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(out)</span>:: coolrate(ixI^S)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordtype">double precision</span> :: etherm(ixI^S),rho(ixI^S),Rfactor(ixI^S)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordtype">double precision</span> :: L1,Tlocal1, ptherm(ixI^S)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordtype">double precision</span> :: emin</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,ptherm) </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keyword">call </span>fl%get_rho(w,x,ixi^l,ixo^l,rho) </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;         tlocal1       = max(plocal/(rholocal * rfactor(ix^d)),smalldouble)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;         <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            l1 = zero</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         coolrate(ix^d) = l1</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ad4443dccc06f84fa778fea1d541b7f4d">getvar_cooling</a></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    </div>
<div class="line"><a name="l01418"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a11c64c538c697e3f91d97dbf02b5b0e5"> 1418</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a11c64c538c697e3f91d97dbf02b5b0e5">getvar_cooling_exact</a>(qdt, ixI^L, ixO^L, wCT, w, x, coolrate, fl)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">! Calculates cooling rate using the exact cooling method,</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">! for usage in eg. source_terms subroutine.</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="comment">! The TEF must be known, so this routine can only be used</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="comment">! together with the &quot;exact&quot; cooling method.</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>           :: ixI^L, ixO^L</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>  :: qdt, x(ixI^S, 1:ndim), wCT(ixI^S, 1:nw)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keywordtype">double precision</span>              :: w(ixI^S, 1:nw)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(out)</span> :: coolrate(ixI^S)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span>   :: fl</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keywordtype">double precision</span>              :: y1, y2, l1, l2</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordtype">double precision</span>              :: plocal, rholocal, tlocal1, tlocal2, invgam</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keywordtype">double precision</span>              :: ptherm(ixI^S), pnew(ixI^S), rho(ixI^S), rhonew(ixI^S), Rfactor(ixI^S)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordtype">double precision</span>              :: emin, Lmax, fact</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordtype">integer</span>                       :: ix^D</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="comment">! Check cooling method</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">if</span>( fl%coolmethod /= <span class="stringliteral">&#39;exact&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;         <span class="keyword">call </span><a class="code" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a>(<span class="stringliteral">&quot;Subroutine getvar_cooling_exact needs the exact cooling method&quot;</span>)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct, x, ixi^l, ixo^l, ptherm)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w, x, ixi^l, ixo^l, pnew)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct, x, ixi^l, ixo^l, rho)</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keyword">call </span>fl%get_rho(w, x, ixi^l, ixo^l, rhonew)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      fact   =fl%lref*qdt/fl%tref</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      invgam = 1.d0/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         tlocal1  = max(plocal/(rholocal*rfactor(ix^d)), smalldouble)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;       </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         emin     = rhonew(ix^d) * fl%tlow * rfactor(ix^d)* invgam</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         lmax     = max(zero, ( pnew(ix^d)*invgam - emin ) / qdt)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;       </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;         <span class="comment">! No cooling if temperature is below floor level.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         <span class="comment">! Assuming Bremsstrahlung if temperature is higher than maximum.</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         <span class="keywordflow">if</span>( tlocal1 &lt;= fl%tcoolmin) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            l1 = zero</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1 &gt;= fl%tcoolmax ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1, fl)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            l1 = l1 * (rholocal**2)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            l1 = min(l1, lmax)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1, l1, fl)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">findy</a>(tlocal1, y1, fl)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            y2   = y1 +  fact * rholocal / invgam</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">findt</a>(tlocal2, y2, fl)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordflow">if</span>( tlocal2 &lt;= fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;               l1 = lmax</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;               l1 = (tlocal1 - tlocal2) * invgam / (rholocal * qdt)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;               l1 = l1 * (rholocal**2)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            l1 = min(l1, lmax)</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        coolrate(ix^d) = l1</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a11c64c538c697e3f91d97dbf02b5b0e5">getvar_cooling_exact</a></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    </div>
<div class="line"><a name="l01493"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a7b37d80a2bb954fedb9fa305980f3bc0"> 1493</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a7b37d80a2bb954fedb9fa305980f3bc0">radiative_cooling_add_source</a>(qdt,ixI^L,ixO^L,wCT,w,x,&amp;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;         qsourcesplit,active,fl)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">! w[iw]=w[iw]+qdt*S[wCT,x] where S is the source based on wCT within ixO</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ixI^L, ixO^L</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: qsourcesplit</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span> :: active</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:^D&amp;)</span> :: Lequi</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">if</span>(qsourcesplit .eqv.fl%rc_split) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        active = .true.</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">select case</span>(fl%coolmethod)</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;explicit1&#39;</span>)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mype</a>==0)<span class="keywordflow">then</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#a37c8bbe2457c57b29f0bca3f7e1387fa">it</a>==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;              <span class="keyword">write</span>(*,*)<span class="stringliteral">&#39;Fully explicit cooling is not completely safe in this version&#39;</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;              <span class="keyword">write</span>(*,*)<span class="stringliteral">&#39;PROCEED WITH CAUTION!&#39;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a3912adcfd51ea9dc7c65d325396eb200">cool_explicit1</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;explicit2&#39;</span>)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a26d74cb12048674f7149afb2e83dda54">cool_explicit2</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;semiimplicit&#39;</span>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a0f13a192d248031e2dfc8499e97d7be6">cool_semiimplicit</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;implicit&#39;</span>)   </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a3ec0fc412f0cfd218de5eb2fedc3b701">cool_implicit</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)   </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&#39;exact&#39;</span>)   </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#af83676692c75ed5298df09d2a07b7dde">cool_exact</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <span class="keyword">call </span><a class="code" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a>(<span class="stringliteral">&quot;This cooling method is unknown&quot;</span>)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="keywordflow">        end select</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="keywordflow">if</span>(fl%has_equi) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          <span class="keyword">allocate</span>(lequi(ixi^s))</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          <span class="keyword">call  </span><a class="code" href="namespacemod__radiative__cooling.html#a84f06307c52394c171e290466a8aa195">get_cool_equi</a>(qdt,ixi^l,ixo^l,wct,w,x,fl,lequi)</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          w(ixo^s,fl%e_) = w(ixo^s,fl%e_)+lequi(ixo^s)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ixo^s,fl%eaux_)=w(ixo^s,fl%eaux_)+lequi(ixo^s) </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          <span class="keyword">deallocate</span>(lequi)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="keywordflow">if</span>( fl%Tfix ) <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a194994d6a6159308586974cd1cdc63fa">floortemperature</a>(qdt,ixi^l,ixo^l,wct,w,x,fl)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a7b37d80a2bb954fedb9fa305980f3bc0">radiative_cooling_add_source</a></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a194994d6a6159308586974cd1cdc63fa"> 1541</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a194994d6a6159308586974cd1cdc63fa">floortemperature</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">!  Force minimum temperature to a fixed temperature</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <span class="keywordtype">double precision</span> :: etherm(ixI^S), rho(ixI^S), emin, tfloor</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      tfloor = fl%tlow</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,etherm)  </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keyword">call </span>fl%get_rho(w,x,ixi^l,ixo^l,rho)  </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;         emin         = rho(ix^d)*tfloor</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;         <span class="keywordflow">if</span>( etherm(ix^d) &lt; emin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;             <span class="comment">!print*, ix1,ix2, &quot; FIXT &quot;,  (emin-etherm(ix^D))/(rc_gamma-1.d0)</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;             w(ix^d,fl%e_)=w(ix^d,fl%e_)+(emin-etherm(ix^d))/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a194994d6a6159308586974cd1cdc63fa">floortemperature</a></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a84f06307c52394c171e290466a8aa195"> 1567</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a84f06307c52394c171e290466a8aa195">get_cool_equi</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl,res)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">! explicit cooling routine that depends on getdt to </span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="comment">! adjust the timestep. Accurate but incredibly slow</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(out)</span> :: res(ixI^S)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordtype">double precision</span> :: ptherm(ixI^S),rho(ixI^S),Rfactor(ixI^S),L1,Tlocal1,Tlocal2</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, ttofflocal</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordtype">double precision</span> :: Y1, Y2, invgam</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordtype">double precision</span> :: de, emax,fact</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordtype">integer</span> :: icool</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keyword">call </span>fl%get_pthermal_equi(wct,x,ixi^l,ixo^l,ptherm)     </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="keyword">call </span>fl%get_rho_equi(wct,x,ixi^l,ixo^l,rho)     </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      res=0d0</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">if</span>  (fl%coolmethod == <span class="stringliteral">&#39;exact&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        ttofflocal=zero</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        fact = fl%lref*qdt/fl%tref</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        invgam=1.d0/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;           plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;           rholocal = rho(ix^d)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;             ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;           emin     = rho(ix^d)*fl%tlow*rfactor(ix^d)*invgam</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;           lmax     = max(zero,(ptherm(ix^d)*invgam-emin)/qdt)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;           emax     = max(zero, ptherm(ix^d)*invgam-emin)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;           <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;           tlocal1   = max(plocal/(rholocal*rfactor(ix^d)),smalldouble)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;           <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;           <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;           <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;           <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;           <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;           <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;              l1 = zero</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;              l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;              l1         = min(l1,lmax)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;              res(ix^d) =  l1*qdt</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;           <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">findy</a>(tlocal1,y1,fl)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;              y2         = y1 + fact * rholocal / invgam</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">findt</a>(tlocal2,y2,fl)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;              <span class="keywordflow">if</span>(tlocal2&lt;=fl%tcoolmin) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                de = emax</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                de = (tlocal1-tlocal2)*invgam*rholocal</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordflow">              endif</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                de=de*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;              de          = min(de,emax)   </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;              res(ix^d)  =  de</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="keywordflow">           endif</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        {enddo^d&amp;\}</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        ttofflocal=zero</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;           plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;           rholocal = rho(ix^d)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;             ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;           emin     = rholocal*fl%tlow*rfactor(ix^d)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;           lmax            = max(zero,plocal/(rc_gamma-1.d0)-emin)/qdt</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;           <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;           tlocal1       = max(plocal/(rfactor(ix^d) * rholocal),smalldouble)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;           <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;           <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;           <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;           <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;           <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;           <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              l1 = zero</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;           <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="keywordflow">           endif</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;           l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;             l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;           l1         = min(l1,lmax)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;           res(ix^d) =l1*qdt</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        {enddo^d&amp;\}</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="keywordflow">     endif</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a84f06307c52394c171e290466a8aa195">get_cool_equi</a></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a3912adcfd51ea9dc7c65d325396eb200"> 1687</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3912adcfd51ea9dc7c65d325396eb200">cool_explicit1</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">! explicit cooling routine that depends on getdt to </span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">! adjust the timestep. Accurate but incredibly slow</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordtype">double precision</span> :: L1,Tlocal1, ptherm(ixI^S),pnew(ixI^S),rho(ixI^S),Rfactor(ixI^S)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, ttofflocal</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keywordtype">integer</span> :: icool</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct,x,ixi^l,ixo^l,ptherm)     </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,pnew)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct,x,ixi^l,ixo^l,rho)     </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      ttofflocal=zero</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;           ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         emin     = rholocal*fl%tlow*rfactor(ix^d)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;         lmax            = max(zero,pnew(ix^d)/(rc_gamma-1.d0)-emin)/qdt</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;         tlocal1       = max(plocal/(rfactor(ix^d) * rholocal),smalldouble)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;         <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;         <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            l1 = zero</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;              l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            l1         = min(l1,lmax)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            w(ix^d,fl%e_) = w(ix^d,fl%e_)-l1*qdt</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-l1*qdt </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;         <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <span class="comment">!print*, it, ix^D, &quot; L1 &quot;, L1 </span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            l1         = l1*(rholocal**2)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;              l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            l1         = min(l1,lmax)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="comment">!print*, &quot;it: &quot;, it , &quot; coords &quot;, ix^D,&quot; EXPLICIT1 &quot;, L1, &amp;</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="comment">!  &quot;VARS &quot;, rholocal, Tlocal1, plocal, pnew(ix^D)</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            w(ix^d,fl%e_) = w(ix^d,fl%e_)-l1*qdt</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-l1*qdt </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="comment">!print* , it,&quot; SUM E &quot;,  sum(w(ixO^S,fl%e_)) + &amp;</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <span class="comment">!  sum(block%equi_vars(ixO^S,2,0))/(rc_gamma-1.d0)</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3912adcfd51ea9dc7c65d325396eb200">cool_explicit1</a></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a26d74cb12048674f7149afb2e83dda54"> 1761</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a26d74cb12048674f7149afb2e83dda54">cool_explicit2</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl)</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">! explicit cooling routine that does a series </span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">! of small forward integration steps, to make </span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="comment">! sure the amount of cooling remains correct</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">! Not as accurate as &#39;explicit1&#39;, but a lot faster</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">! tends to overestimate cooling</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordtype">double precision</span> :: Ltest, etherm, de</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordtype">double precision</span> :: dtmax, dtstep</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordtype">integer</span> :: idt,ndtstep</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <span class="keywordtype">double precision</span> :: L1,Tlocal1,ptherm(ixI^S),pnew(ixI^S),rho(ixI^S),Rfactor(ixI^S)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, ttofflocal</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="keywordtype">integer</span> :: icool</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct,x,ixi^l,ixo^l,ptherm) </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,pnew ) </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct,x,ixi^l,ixo^l,rho) </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      ttofflocal=zero</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;         <span class="comment">!  Calculate explicit cooling value</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;         dtmax    = qdt</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;         etherm   = plocal/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;           ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;         emin     = rholocal*fl%tlow*rfactor(ix^d)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;         lmax            = max(zero,(pnew(ix^d)/(rc_gamma-1.d0))-emin)/qdt</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;         tlocal1       = plocal/(rholocal*rfactor(ix^d))</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;         <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;         <span class="comment">!  assume Bremmstrahlung</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            ltest = zero</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, ltest,fl)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            ltest = l1*(rholocal**2)</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;              ltest=ltest*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            ltest = min(l1,lmax)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="keywordflow">if</span>( dtmax&gt;fl%cfrac*etherm/ltest) dtmax = fl%cfrac*etherm/ltest</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;         <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,ltest,fl)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            ltest = ltest*(rholocal**2)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;              ltest=ltest*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            ltest = min(ltest,lmax)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <span class="keywordflow">if</span>( dtmax&gt;fl%cfrac*etherm/ltest) dtmax = fl%cfrac*etherm/ltest</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;         <span class="comment">!  Calculate number of steps for cooling</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;         ndtstep = max(nint(qdt/dtmax),1)+1</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;         dtstep = qdt/ndtstep</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;         <span class="comment">!  Use explicit cooling value for first step</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;         de     = ltest*dtstep</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;         etherm = etherm - de</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;         </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;         <span class="keywordflow">do</span> idt=2,ndtstep</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            plocal = etherm*(rc_gamma-1.d0)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            lmax   = max(zero,etherm-emin)/dtstep</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            tlocal1 = plocal/(rholocal * rfactor(ix^d))</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;               l1 = zero</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;               <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;              l1 = l1*(rholocal**2)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;              l1 = min(l1,lmax)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;              l1 = l1*(rholocal**2)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;              l1 = min(l1,lmax)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            de     = de + l1*dtstep</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            etherm = etherm - l1*dtstep</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;         w(ix^d,fl%e_) = w(ix^d,fl%e_) -de </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-de</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a26d74cb12048674f7149afb2e83dda54">cool_explicit2</a></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a0f13a192d248031e2dfc8499e97d7be6"> 1883</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a0f13a192d248031e2dfc8499e97d7be6">cool_semiimplicit</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">! Semi-implicit cooling method based on a two point </span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">! average</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">! Fast, but tends to underestimate cooling</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordtype">double precision</span> :: L1,L2,Tlocal1, Tlocal2</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordtype">double precision</span> :: etemp</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, ttofflocal</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordtype">double precision</span> :: ptherm(ixI^S),pnew(ixI^S),rho(ixI^S),Rfactor(ixI^S)</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct,x,ixi^l,ixo^l,ptherm)   </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,pnew )  </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct,x,ixi^l,ixo^l,rho)   </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      ttofflocal=zero</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;           ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;         emin     = rholocal*fl%tlow*rfactor(ix^d)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;         lmax            = max(zero,pnew(ix^d)/(rc_gamma-1.d0)-emin)/qdt</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;         tlocal1       = max(plocal/(rholocal * rfactor(ix^d)),smalldouble)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;         <span class="comment">!  Determine explicit cooling at present temperature</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;         <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            l1 = zero</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            l2 = zero</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;           <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;           <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)            </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="keywordflow">           end if</span>                       </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;           l1      = l1*(rholocal**2)</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;             l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;           etemp   = plocal/(rc_gamma-1.d0) - l1*qdt</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;           tlocal2 = etemp*(rc_gamma-1.d0)/(rholocal)</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;           <span class="comment">!  Determine explicit cooling at new temperature</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;           <span class="comment">!</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;           <span class="keywordflow">if</span>( tlocal2&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;              l2 = zero</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal2&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal2, l2,fl)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;           <span class="keywordflow">else</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal2,l2,fl)</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;           l2  = l2*(rholocal**2)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal2 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;             l2=l2*sqrt((tlocal2/ttofflocal)**5)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="keywordflow">           end if</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;           w(ix^d,fl%e_) = w(ix^d,fl%e_) - min(half*(l1+l2),lmax)*qdt</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) &amp;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;             w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-min(half*(l1+l2),lmax)*qdt</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="keywordflow">         endif</span> </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a0f13a192d248031e2dfc8499e97d7be6">cool_semiimplicit</a></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a3ec0fc412f0cfd218de5eb2fedc3b701"> 1969</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3ec0fc412f0cfd218de5eb2fedc3b701">cool_implicit</a>(qdt,ixI^L,ixO^L,wCT,w,x,fl)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">! Implicit cooling method based on a half-step</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">! refinement algorithm</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <span class="keywordtype">double precision</span> :: Ltemp,Tlocal1,Tnew,f1,f2,ptherm(ixI^S), pnew(ixI^S), rho(ixI^S), Rfactor(ixI^S)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, elocal, ttofflocal</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax, eold, enew, estep</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: maxiter = 100</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">parameter</span> :: e_error = 1.0<a class="code" href="namespacemod__global__parameters.html#a68549065c490d02e1de338e8a60c3f12">d</a>-6</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keywordtype">integer</span> :: ix^D, j</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct,x,ixi^l,ixo^l,ptherm)   </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,pnew )  </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct,x,ixi^l,ixo^l,rho)   </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      ttofflocal=zero</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;         plocal   = ptherm(ix^d)  </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;         elocal   = plocal/(rc_gamma-1.d0)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;           ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;         emin     = rholocal*fl%tlow*rfactor(ix^d)/(rc_gamma-1.d0)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;         lmax            = max(zero,pnew(ix^d)/(rc_gamma-1.d0)-emin)/qdt</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;         tlocal1       = max(plocal/(rholocal * rfactor(ix^d)),smalldouble)</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;         <span class="comment">!  Determine explicit cooling at present temperature</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;         <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            ltemp = zero</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;           eold  = elocal</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;           enew  = elocal</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;           estep = -(smalldouble)</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;           f2    = 1.d0</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;           <span class="keywordflow">do</span> j=1,maxiter+1</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;             <span class="keywordflow">if</span>( j&gt;maxiter ) <span class="keyword">call </span><a class="code" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a>(<span class="stringliteral">&quot;Implicit cooling exceeds maximum iterations&quot;</span>)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;             tnew  = enew*(rc_gamma-1.d0)/(rholocal * rfactor(ix^d))   </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;             <span class="keywordflow">if</span>( tnew&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;               ltemp = lmax</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;               <span class="keywordflow">exit</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tnew&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;               <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tnew, ltemp,fl)</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;             <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;               <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tnew,ltemp,fl)</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="keywordflow">             end if</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;             ltemp = ltemp*(rholocal**2)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;             eold  = enew + ltemp*qdt</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;             f1 = elocal -eold</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;             <span class="keywordflow">if</span>( abs(half*f1/(elocal+eold)) &lt; e_error  ) <span class="keywordflow">exit</span> </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;             <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tnew .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;               ltemp=ltemp*sqrt((tnew/ttofflocal)**5)</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="keywordflow">             end if</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;             <span class="keywordflow">if</span>(j==1) estep = max((elocal-emin)*half,smalldouble)</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;             <span class="keywordflow">if</span>(f1*f2 &lt; zero ) estep = -half*estep   </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;             f2 = f1</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;             enew = enew +estep</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keywordflow">           enddo</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="keywordflow">         endif</span>     </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;         w(ix^d,fl%e_)     = w(ix^d,fl%e_) - min(ltemp,lmax)*qdt</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-min(ltemp,lmax)*qdt</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;       </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3ec0fc412f0cfd218de5eb2fedc3b701">cool_implicit</a></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#af83676692c75ed5298df09d2a07b7dde"> 2057</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#af83676692c75ed5298df09d2a07b7dde">cool_exact</a>(qdt,ixI^L,ixO^L,wCT,w,x, fl)</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="comment">!  Cooling routine using exact integration method from Townsend 2009</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>             :: ixI^L, ixO^L</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>    :: qdt, x(ixI^S,1:ndim), wCT(ixI^S,1:nw)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: w(ixI^S,1:nw)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; </div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordtype">double precision</span> :: Y1, Y2</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keywordtype">double precision</span> :: L1,Tlocal1, ptherm(ixI^S), Tlocal2, pnew(ixI^S)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordtype">double precision</span> :: rho(ixI^S), rhonew(ixI^S), Rfactor(ixI^S)</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="keywordtype">double precision</span> :: plocal, rholocal, invgam, ttofflocal</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordtype">double precision</span> :: emin, Lmax, fact</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="keywordtype">double precision</span> :: de, emax</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <span class="keywordtype">integer</span> :: ix^D</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      <span class="keywordtype">integer</span> :: icool</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(wct,x,ixi^l,ixo^l,ptherm)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="keyword">call </span>fl%get_pthermal(w,x,ixi^l,ixo^l,pnew)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <span class="keyword">call </span>fl%get_rho(wct,x,ixi^l,ixo^l,rho)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="keyword">call </span>fl%get_rho(w,x,ixi^l,ixo^l,rhonew)</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">associated</span>(fl%get_var_Rfactor)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keyword">call </span>fl%get_var_Rfactor(w,x,ixi^l,ixo^l,rfactor)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        rfactor(ixo^s)=fl%Rfactor </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      ttofflocal=zero</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      fact = fl%lref*qdt/fl%tref</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      invgam=1.d0/(rc_gamma-1.d0)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      {<span class="keywordflow">do</span> ix^db = ixo^lim^db\}</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;         plocal   = ptherm(ix^d)</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;         rholocal = rho(ix^d)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;           ttofflocal=<a class="code" href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">block</a>%wextra(ix^d,fl%Tcoff_)</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;         emin = rhonew(ix^d)*fl%tlow*rfactor(ix^d)*invgam</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;         lmax = max(zero,(pnew(ix^d)*invgam-emin)/qdt)</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;         emax = max(zero, pnew(ix^d)*invgam-emin)</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;         <span class="comment">!  Tlocal = P/rho</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;         tlocal1 = max(plocal/(rholocal*rfactor(ix^d)),smalldouble)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;         <span class="comment">!  Determine explicit cooling</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;         <span class="comment">!</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;         <span class="comment">!  If temperature is below floor level, no cooling. </span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;         <span class="comment">!  Stop wasting time and go to next gridpoint.</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;         <span class="comment">!  If the temperature is higher than the maximum,</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;         <span class="comment">!  assume Bremsstrahlung</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;         <span class="keywordflow">if</span>( tlocal1&lt;=fl%tcoolmin ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            l1 = zero</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tlocal1&gt;=fl%tcoolmax )<span class="keywordflow">then</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a>(tlocal1, l1,fl)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            l1 = l1*(rholocal**2)</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;              l1=l1*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            l1 = min(l1,lmax)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            w(ix^d,fl%e_) = w(ix^d,fl%e_)-l1*qdt</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-l1*qdt</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a>(tlocal1,l1,fl)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">findy</a>(tlocal1,y1,fl)</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            y2 = y1 + fact * rholocal * (rc_gamma-1.d0)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">findt</a>(tlocal2,y2,fl)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            <span class="keywordflow">if</span>(tlocal2&lt;=fl%tcoolmin) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;              de = emax</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;              de = (tlocal1-tlocal2)*invgam*rholocal</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">phys_trac</a> .and. tlocal1 .lt. ttofflocal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;              de=de*sqrt((tlocal1/ttofflocal)**5)</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            de = min(de,emax)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            w(ix^d,fl%e_)  = w(ix^d,fl%e_)-de</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">phys_solve_eaux</a>) w(ix^d,fl%eaux_)=w(ix^d,fl%eaux_)-de              </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      {enddo^d&amp;\}</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#af83676692c75ed5298df09d2a07b7dde">cool_exact</a></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718"> 2143</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a> (tpoint, lpoint,fl)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">!  Calculate l for t beyond tcoolmax</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="comment">!  Assumes Bremsstrahlung for the interpolated tables</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="comment">!  Uses the power law for piecewise power laws</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(IN)</span>  :: tpoint</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(OUT)</span> :: lpoint    </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl   </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;   </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <span class="keywordflow">if</span> (fl%isPPL) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;         lpoint =fl%l_PPL(fl%n_PPL) * ( tpoint / fl%t_PPL(fl%n_PPL) )**fl%a_PPL(fl%n_PPL) </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;         lpoint = fl%Lcool(fl%ncool) * sqrt( tpoint / fl%tcoolmax)</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">calc_l_extended</a></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5"> 2160</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a> (tpoint,Lpoint,fl)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">!  Fast search option to find correct point </span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">!  in cooling curve</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">intent(IN)</span>   :: tpoint</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(OUT)</span> :: Lpoint</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl   </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keywordtype">integer</span> :: ipoint</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordtype">integer</span> :: jl,jc,jh</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordtype">double precision</span> :: lgtp</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="keywordflow">if</span> (fl%isPPL) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;         i = maxloc(fl%t_PPL, dim=1, mask=fl%t_PPL&lt;tpoint)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;         lpoint = fl%l_PPL(i) * (tpoint / fl%t_PPL(i))**fl%a_PPL(i)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;         lgtp = dlog10(tpoint)</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;         jl = int((lgtp - fl%lgtcoolmin) /fl%lgstep) + 1</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;         lpoint = fl%Lcool(jl)+ (tpoint-fl%tcool(jl)) &amp;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                   * (fl%Lcool(jl+1)-fl%Lcool(jl)) &amp;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                   / (fl%tcool(jl+1)-fl%tcool(jl))</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">!      if (tpoint == fl%tcoolmin) then</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">!        Lpoint = fl%Lcool(1)</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">!      else if (tpoint == fl%tcoolmax) then</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">!        Lpoint = fl%Lcool(fl%ncool)</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">!      else</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">!        jl=0</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">!        jh=fl%ncool+1  </span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">!        do</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">!          if (jh-jl &lt;= 1) exit</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">!          jc=(jh+jl)/2</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">!          if (tpoint &gt;= fl%tcool(jc)) then</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">!              jl=jc</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">!          else</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">!              jh=jc</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">!          end if</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">!        end do</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">!        ! Linear interpolation to obtain correct cooling</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">!        Lpoint = fl%Lcool(jl)+ (tpoint-fl%tcool(jl)) &amp;</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">!                  * (fl%Lcool(jl+1)-fl%Lcool(jl)) &amp;</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">!                  / (fl%tcool(jl+1)-fl%tcool(jl))</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">!      end if</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">findl</a></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101"> 2209</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">findy</a> (tpoint,Ypoint,fl)</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="comment">!  Fast search option to find correct point in cooling time (TEF)</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">intent(IN)</span>   :: tpoint</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(OUT)</span> :: Ypoint</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl   </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordtype">integer</span> :: ipoint</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keywordtype">integer</span> :: jl,jc,jh</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keywordtype">double precision</span> :: lgtp</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordtype">double precision</span> :: y_extra,factor</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keywordflow">if</span> (fl%isPPL) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;         i = maxloc(fl%t_PPL, dim=1, mask=fl%t_PPL&lt;tpoint)</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;         factor = fl%l_PPL(fl%n_PPL+1) * fl%t_PPL(i) / (fl%l_PPL(i) * fl%t_PPL(fl%n_PPL+1))</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;         <span class="keywordflow">if</span> (fl%a_PPL(i)==1.d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            y_extra = log( fl%t_PPL(i) / tpoint )</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            y_extra = 1 / (1 - fl%a_PPL(i)) * (1 - ( fl%t_PPL(i) / tpoint )**(fl%a_PPL(i)-1) )</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         ypoint = fl%y_PPL(i) + factor*y_extra</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;         lgtp = dlog10(tpoint)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;         jl = int((lgtp - fl%lgtcoolmin) / fl%lgstep) + 1</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;         ypoint = fl%Yc(jl)+ (tpoint-fl%tcool(jl)) &amp;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                   * (fl%Yc(jl+1)-fl%Yc(jl)) &amp;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                   / (fl%tcool(jl+1)-fl%tcool(jl))</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="comment">!    integer i</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="comment">!    </span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="comment">!    if (tpoint == tcoolmin) then</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="comment">!      Ypoint = Yc(1)</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">!    else if (tpoint == tcoolmax) then</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">!      Ypoint = Yc(ncool)</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="comment">!    else</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">!      jl=0</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="comment">!      jh=ncool+1  </span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="comment">!      do</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="comment">!        if (jh-jl &lt;= 1) exit</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="comment">!        jc=(jh+jl)/2</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="comment">!        if (tpoint &gt;= tcool(jc)) then</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="comment">!           jl=jc</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">!        else</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">!           jh=jc</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">!        end if</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">!      end do</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="comment">!      ! Linear interpolation to obtain correct value</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="comment">!      Ypoint = Yc(jl)+ (tpoint-tcool(jl)) &amp;</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="comment">!                * (Yc(jl+1)-Yc(jl)) &amp;</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="comment">!                / (tcool(jl+1)-tcool(jl))</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="comment">!    end if</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">findy</a></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d"> 2268</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">findt</a> (tpoint,Ypoint,fl)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">!  Fast search option to find correct temperature </span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="comment">!  from temporal evolution function. Only possible this way because T is a monotonously </span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="comment">!  decreasing function for the interpolated tables </span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="comment">!  Uses eq. A7 from Townsend 2009 for piecewise power laws</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">intent(OUT)</span>   :: tpoint</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(IN)</span> :: Ypoint</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl   </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordtype">integer</span> :: ipoint</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordtype">integer</span> :: jl,jc,jh</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      <span class="keywordtype">double precision</span> :: factor</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="keywordflow">if</span> (fl%isPPL) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;         i = minloc(fl%y_PPL, dim=1, mask=fl%y_PPL&gt;ypoint)</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;         factor =  fl%l_PPL(i) * fl%t_PPL(fl%n_PPL+1) / (fl%l_PPL(fl%n_PPL+1) * fl%t_PPL(i))</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;         <span class="keywordflow">if</span> (fl%a_PPL(i)==1.d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            tpoint = fl%t_PPL(i) * exp( -1.d0 * factor * ( ypoint - fl%y_PPL(i)))</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            tpoint = fl%t_PPL(i) * (1 - (1 - fl%a_PPL(i)) * factor * (ypoint - fl%y_PPL(i)))**(1 / (1 - fl%a_PPL(i)))</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;         <span class="keywordflow">if</span> (ypoint &gt;= fl%Yc(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            tpoint = fl%tcoolmin</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ypoint == fl%Yc(fl%ncool)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            tpoint = fl%tcoolmax</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            jl=0</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            jh=fl%ncool+1</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            <span class="keywordflow">do</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;               <span class="keywordflow">if</span> (jh-jl &lt;= 1) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;               jc=(jh+jl)/2</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;               <span class="keywordflow">if</span> (ypoint &lt;= fl%Yc(jc)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                  jl=jc</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                  jh=jc</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            <span class="comment">! Linear interpolation to obtain correct temperature</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            tpoint = fl%tcool(jl)+ (ypoint-fl%Yc(jl)) &amp;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                   * (fl%tcool(jl+1)-fl%tcool(jl)) &amp;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                   / (fl%Yc(jl+1)-fl%Yc(jl))</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">findt</a></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"><a class="line" href="namespacemod__radiative__cooling.html#a5ffef432da8691f3b02e79800e6a385b"> 2320</a></span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a5ffef432da8691f3b02e79800e6a385b">finddldt</a> (tpoint,dLpoint,fl)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">!  Fast search option to find correct point </span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="comment">!  in derivative of cooling curve</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="comment">!  Does not work for the piecewise power laws</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemod__global__parameters.html">mod_global_parameters</a></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">intent(IN)</span>   :: tpoint</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(OUT)</span> :: dLpoint</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__radiative__cooling_1_1rc__fluid.html">rc_fluid</a>), <span class="keywordtype">intent(in)</span> :: fl   </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <span class="keywordtype">integer</span> :: ipoint</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      <span class="keywordtype">integer</span> :: jl,jc,jh</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="keywordtype">double precision</span> :: lgtp</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      lgtp = dlog10(tpoint)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      jl = int((lgtp -fl%lgtcoolmin) / fl%lgstep) + 1</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      dlpoint = fl%dLdtcool(jl)+ (tpoint-fl%tcool(jl)) &amp;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                * (fl%dLdtcool(jl+1)-fl%dLdtcool(jl)) &amp;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                / (fl%tcool(jl+1)-fl%tcool(jl))</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">!      if (tpoint == tcoolmin) then</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">!        dLpoint = dLdtcool(1)</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">!      else if (tpoint == tcoolmax) then</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">!        dLpoint = dLdtcool(ncool)</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">!      else</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">!        jl=0</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment">!        jh=ncool+1  </span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment">!        do</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">!          if (jh-jl &lt;= 1) exit</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">!          jc=(jh+jl)/2</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">!          if (tpoint &gt;= tcool(jc)) then</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">!              jl=jc</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">!          else</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">!              jh=jc</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">!          end if</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">!        end do</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">!        ! Linear interpolation to obtain correct cooling derivative</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">!        dLpoint = dLdtcool(jl)+ (tpoint-tcool(jl)) &amp;</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">!                  * (dLdtcool(jl+1)-dLdtcool(jl)) &amp;</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">!                  / (tcool(jl+1)-tcool(jl))</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">!      end if</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keyword">end subroutine </span><a class="code" href="namespacemod__radiative__cooling.html#a5ffef432da8691f3b02e79800e6a385b">finddldt</a></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacemod__radiative__cooling.html">mod_radiative_cooling</a></div>
<div class="ttc" id="acomm__lib_8t_html_a49b49ea9ffbbadfe688e332921c4cddd"><div class="ttname"><a href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd">mpistop</a></div><div class="ttdeci">subroutine mpistop(message)</div><div class="ttdoc">Exit MPI-AMRVAC with an error message.</div><div class="ttdef"><b>Definition:</b> <a href="comm__lib_8t_source.html#l00193">comm_lib.t:194</a></div></div>
<div class="ttc" id="ainterfacemod__radiative__cooling_1_1get__subr1_html"><div class="ttname"><a href="interfacemod__radiative__cooling_1_1get__subr1.html">mod_radiative_cooling::get_subr1</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00038">mod_radiative_cooling.t:38</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html"><div class="ttname"><a href="namespacemod__global__parameters.html">mod_global_parameters</a></div><div class="ttdoc">This module contains definitions of global parameters and variables and some generic functions/subrou...</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00004">mod_global_parameters.t:4</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a026d4f7c417820e04a0731db6833204b"><div class="ttname"><a href="namespacemod__global__parameters.html#a026d4f7c417820e04a0731db6833204b">mod_global_parameters::block</a></div><div class="ttdeci">type(state), pointer block</div><div class="ttdoc">Block pointer for using one block and its previous state.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00724">mod_global_parameters.t:724</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a1e1a3e9685ff4fd0cafa15061c6d0d8f"><div class="ttname"><a href="namespacemod__global__parameters.html#a1e1a3e9685ff4fd0cafa15061c6d0d8f">mod_global_parameters::unit_time</a></div><div class="ttdeci">double precision unit_time</div><div class="ttdoc">Physical scaling factor for time.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00307">mod_global_parameters.t:307</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a2643b30397384bf36289b3afb2d7dda3"><div class="ttname"><a href="namespacemod__global__parameters.html#a2643b30397384bf36289b3afb2d7dda3">mod_global_parameters::unitpar</a></div><div class="ttdeci">integer, parameter unitpar</div><div class="ttdoc">file handle for IO</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00233">mod_global_parameters.t:233</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a37c8bbe2457c57b29f0bca3f7e1387fa"><div class="ttname"><a href="namespacemod__global__parameters.html#a37c8bbe2457c57b29f0bca3f7e1387fa">mod_global_parameters::it</a></div><div class="ttdeci">integer it</div><div class="ttdoc">Number of time steps taken.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00503">mod_global_parameters.t:503</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a4296e156fded38497eb361e3acc27355"><div class="ttname"><a href="namespacemod__global__parameters.html#a4296e156fded38497eb361e3acc27355">mod_global_parameters::unit_numberdensity</a></div><div class="ttdeci">double precision unit_numberdensity</div><div class="ttdoc">Physical scaling factor for number density.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00325">mod_global_parameters.t:325</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a444384f0dec61b149b0b1f969a8b5e77"><div class="ttname"><a href="namespacemod__global__parameters.html#a444384f0dec61b149b0b1f969a8b5e77">mod_global_parameters::unit_pressure</a></div><div class="ttdeci">double precision unit_pressure</div><div class="ttdoc">Physical scaling factor for pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00319">mod_global_parameters.t:319</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a551004039cf74031e6bf9e613eb24e64"><div class="ttname"><a href="namespacemod__global__parameters.html#a551004039cf74031e6bf9e613eb24e64">mod_global_parameters::par_files</a></div><div class="ttdeci">character(len=std_len), dimension(:), allocatable par_files</div><div class="ttdoc">Which par files are used as input.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00251">mod_global_parameters.t:251</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a605b2c8e7a386f644c7f8817421b6d67"><div class="ttname"><a href="namespacemod__global__parameters.html#a605b2c8e7a386f644c7f8817421b6d67">mod_global_parameters::mype</a></div><div class="ttdeci">integer mype</div><div class="ttdoc">The rank of the current MPI task.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00022">mod_global_parameters.t:22</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_a68549065c490d02e1de338e8a60c3f12"><div class="ttname"><a href="namespacemod__global__parameters.html#a68549065c490d02e1de338e8a60c3f12">mod_global_parameters::d</a></div><div class="ttdeci">integer, dimension(:), allocatable, parameter d</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00074">mod_global_parameters.t:74</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_aa1fac5bb69ce3e968348d1435b29f1ac"><div class="ttname"><a href="namespacemod__global__parameters.html#aa1fac5bb69ce3e968348d1435b29f1ac">mod_global_parameters::unit_temperature</a></div><div class="ttdeci">double precision unit_temperature</div><div class="ttdoc">Physical scaling factor for temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00316">mod_global_parameters.t:316</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_aa772c499c35e8325d16e2a8a824f1660"><div class="ttname"><a href="namespacemod__global__parameters.html#aa772c499c35e8325d16e2a8a824f1660">mod_global_parameters::si_unit</a></div><div class="ttdeci">logical si_unit</div><div class="ttdoc">Use SI units (.true.) or use cgs units (.false.)</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00362">mod_global_parameters.t:362</a></div></div>
<div class="ttc" id="anamespacemod__global__parameters_html_ab908e5eeaa29a966331d7211514c1ade"><div class="ttname"><a href="namespacemod__global__parameters.html#ab908e5eeaa29a966331d7211514c1ade">mod_global_parameters::phys_trac</a></div><div class="ttdeci">logical phys_trac</div><div class="ttdoc">Use TRAC (Johnston 2019 ApJL, 873, L22) for MHD or 1D HD.</div><div class="ttdef"><b>Definition:</b> <a href="mod__global__parameters_8t_source.html#l00365">mod_global_parameters.t:365</a></div></div>
<div class="ttc" id="anamespacemod__physics_html"><div class="ttname"><a href="namespacemod__physics.html">mod_physics</a></div><div class="ttdoc">This module defines the procedures of a physics module. It contains function pointers for the various...</div><div class="ttdef"><b>Definition:</b> <a href="mod__physics_8t_source.html#l00004">mod_physics.t:4</a></div></div>
<div class="ttc" id="anamespacemod__physics_html_a51bbbee51ccb77a7bdab0f091872fa3d"><div class="ttname"><a href="namespacemod__physics.html#a51bbbee51ccb77a7bdab0f091872fa3d">mod_physics::phys_solve_eaux</a></div><div class="ttdeci">logical phys_solve_eaux</div><div class="ttdoc">Solve internal energy and total energy equations.</div><div class="ttdef"><b>Definition:</b> <a href="mod__physics_8t_source.html#l00039">mod_physics.t:39</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html"><div class="ttname"><a href="namespacemod__radiative__cooling.html">mod_radiative_cooling</a></div><div class="ttdoc">module radiative cooling  add optically thin radiative cooling for HD and MHD</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00014">mod_radiative_cooling.t:14</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a0091341d39b71e093c116406e851d6f1"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a0091341d39b71e093c116406e851d6f1">mod_radiative_cooling::t_fm</a></div><div class="ttdeci">double precision, dimension(1:5) t_fm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a068f9455545c03be1bcecb19f65db537"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a068f9455545c03be1bcecb19f65db537">mod_radiative_cooling::n_mlcosmol</a></div><div class="ttdeci">integer n_mlcosmol</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a07c0aa1271a169576349e6deda1d219c"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a07c0aa1271a169576349e6deda1d219c">mod_radiative_cooling::l_mlcosmol</a></div><div class="ttdeci">double precision, dimension(1:71) l_mlcosmol</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a0f13a192d248031e2dfc8499e97d7be6"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a0f13a192d248031e2dfc8499e97d7be6">mod_radiative_cooling::cool_semiimplicit</a></div><div class="ttdeci">subroutine cool_semiimplicit(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01883">mod_radiative_cooling.t:1884</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a1093086a28630a72337a7ab64e8792f3"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a1093086a28630a72337a7ab64e8792f3">mod_radiative_cooling::n_jccorona</a></div><div class="ttdeci">integer n_jccorona</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a11746fc81a29be58a85270c35a8799f3"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a11746fc81a29be58a85270c35a8799f3">mod_radiative_cooling::l_mb</a></div><div class="ttdeci">double precision, dimension(1:51) l_mb</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a11c64c538c697e3f91d97dbf02b5b0e5"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a11c64c538c697e3f91d97dbf02b5b0e5">mod_radiative_cooling::getvar_cooling_exact</a></div><div class="ttdeci">subroutine getvar_cooling_exact(qdt, ixIL, ixOL, wCT, w, x, coolrate, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01418">mod_radiative_cooling.t:1419</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a144fc5db0c90b80c011a46f75e83cc7a"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a144fc5db0c90b80c011a46f75e83cc7a">mod_radiative_cooling::t_cl_solar</a></div><div class="ttdeci">double precision, dimension(1:151) t_cl_solar</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a17fae6e2c941e2ce661aa826ad479020"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a17fae6e2c941e2ce661aa826ad479020">mod_radiative_cooling::l_dm_2</a></div><div class="ttdeci">double precision, dimension(1:76) l_dm_2</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a194994d6a6159308586974cd1cdc63fa"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a194994d6a6159308586974cd1cdc63fa">mod_radiative_cooling::floortemperature</a></div><div class="ttdeci">subroutine floortemperature(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01541">mod_radiative_cooling.t:1542</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a23553172a22d868a17b7600720fd97f7"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a23553172a22d868a17b7600720fd97f7">mod_radiative_cooling::l_spex</a></div><div class="ttdeci">double precision, dimension(1:110) l_spex</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a2518c73f1692936fd8a8509e76e5de0d"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a2518c73f1692936fd8a8509e76e5de0d">mod_radiative_cooling::n_fm</a></div><div class="ttdeci">integer n_fm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a26d74cb12048674f7149afb2e83dda54"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a26d74cb12048674f7149afb2e83dda54">mod_radiative_cooling::cool_explicit2</a></div><div class="ttdeci">subroutine cool_explicit2(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01761">mod_radiative_cooling.t:1762</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a28ef07b7764445dfe9169b10ed165c00"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a28ef07b7764445dfe9169b10ed165c00">mod_radiative_cooling::a_hildner</a></div><div class="ttdeci">double precision, dimension(1:5) a_hildner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a29b26e00937bc4f9a21b3b0606b23b77"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a29b26e00937bc4f9a21b3b0606b23b77">mod_radiative_cooling::t_hildner</a></div><div class="ttdeci">double precision, dimension(1:6) t_hildner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a2c0aab05964e01b97b9ae65c6d2ea830"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a2c0aab05964e01b97b9ae65c6d2ea830">mod_radiative_cooling::radiative_cooling_init</a></div><div class="ttdeci">subroutine radiative_cooling_init(fl, read_params)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00789">mod_radiative_cooling.t:790</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a34cec942eec1a95a875a92d2e87719e5"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a34cec942eec1a95a875a92d2e87719e5">mod_radiative_cooling::x_spex_dm_rough</a></div><div class="ttdeci">double precision, dimension(1:7) x_spex_dm_rough</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a378372e4dbb44f94e26e1b7e67d59f9f"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a378372e4dbb44f94e26e1b7e67d59f9f">mod_radiative_cooling::l_colgan</a></div><div class="ttdeci">double precision, dimension(1:55) l_colgan</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a3912adcfd51ea9dc7c65d325396eb200"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a3912adcfd51ea9dc7c65d325396eb200">mod_radiative_cooling::cool_explicit1</a></div><div class="ttdeci">subroutine cool_explicit1(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01687">mod_radiative_cooling.t:1688</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a3b087c36d86398edccaaf7fe23afc0be"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a3b087c36d86398edccaaf7fe23afc0be">mod_radiative_cooling::n_spex</a></div><div class="ttdeci">integer n_spex</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a3ec0fc412f0cfd218de5eb2fedc3b701"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a3ec0fc412f0cfd218de5eb2fedc3b701">mod_radiative_cooling::cool_implicit</a></div><div class="ttdeci">subroutine cool_implicit(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01969">mod_radiative_cooling.t:1970</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a3efa422158192dbae4f18bc845584101"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a3efa422158192dbae4f18bc845584101">mod_radiative_cooling::findy</a></div><div class="ttdeci">subroutine findy(tpoint, Ypoint, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02209">mod_radiative_cooling.t:2210</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a49f6dbe5de1126c72f6ecf2c77c23da7"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a49f6dbe5de1126c72f6ecf2c77c23da7">mod_radiative_cooling::t_rosner</a></div><div class="ttdeci">double precision, dimension(1:10) t_rosner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a4cf4f74ba22dc1a976d3ecea5f283b31"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a4cf4f74ba22dc1a976d3ecea5f283b31">mod_radiative_cooling::t_colgan</a></div><div class="ttdeci">double precision, dimension(1:55) t_colgan</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a51b6cce389bb5faf48cc0778a9c6abf5"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a51b6cce389bb5faf48cc0778a9c6abf5">mod_radiative_cooling::a_fm</a></div><div class="ttdeci">double precision, dimension(1:4) a_fm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a55617900b3a8fa747c0f244031380122"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a55617900b3a8fa747c0f244031380122">mod_radiative_cooling::n_cl_solar</a></div><div class="ttdeci">integer n_cl_solar</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a5db8e1efa0d2578ecfd47577da6e52e4"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a5db8e1efa0d2578ecfd47577da6e52e4">mod_radiative_cooling::n_cl_ism</a></div><div class="ttdeci">integer n_cl_ism</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a5e673c837df3fbd572820caf874c3c7f"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a5e673c837df3fbd572820caf874c3c7f">mod_radiative_cooling::create_y_ppl</a></div><div class="ttdeci">subroutine create_y_ppl(fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01286">mod_radiative_cooling.t:1287</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a5ffef432da8691f3b02e79800e6a385b"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a5ffef432da8691f3b02e79800e6a385b">mod_radiative_cooling::finddldt</a></div><div class="ttdeci">subroutine finddldt(tpoint, dLpoint, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02320">mod_radiative_cooling.t:2321</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a61213c53128ffc5ee81b9e2cafa1192d"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a61213c53128ffc5ee81b9e2cafa1192d">mod_radiative_cooling::findt</a></div><div class="ttdeci">subroutine findt(tpoint, Ypoint, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02268">mod_radiative_cooling.t:2269</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a63386c2e6ffca4bbaba820242ef20e7a"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a63386c2e6ffca4bbaba820242ef20e7a">mod_radiative_cooling::t_dere</a></div><div class="ttdeci">double precision, dimension(1:101) t_dere</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a63f4ef9befdc17085584ea97a03330e9"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a63f4ef9befdc17085584ea97a03330e9">mod_radiative_cooling::n_hildner</a></div><div class="ttdeci">integer n_hildner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a69945f9f22b3720bee495c5ea96b4c44"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a69945f9f22b3720bee495c5ea96b4c44">mod_radiative_cooling::n_dere</a></div><div class="ttdeci">integer n_dere</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a6bf4d8dd78fac235e5fd0dae4459145e"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a6bf4d8dd78fac235e5fd0dae4459145e">mod_radiative_cooling::n_dm</a></div><div class="ttdeci">integer n_dm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a6ce0229b23f942e86c22b3c89f7f96dd"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a6ce0229b23f942e86c22b3c89f7f96dd">mod_radiative_cooling::cooling_get_dt</a></div><div class="ttdeci">subroutine cooling_get_dt(w, ixIL, ixOL, dtnew, dxD, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01314">mod_radiative_cooling.t:1315</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a72c7bb2cb2adcbdcf17aa70c36dc9ef6"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a72c7bb2cb2adcbdcf17aa70c36dc9ef6">mod_radiative_cooling::t_mlcosmol</a></div><div class="ttdeci">double precision, dimension(1:71) t_mlcosmol</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a757a058f85b83b210fb6429d656bef0b"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a757a058f85b83b210fb6429d656bef0b">mod_radiative_cooling::t_spex_dm_fine</a></div><div class="ttdeci">double precision, dimension(1:15) t_spex_dm_fine</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a77a4bb25c093933a6a0dee150cbf348f"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a77a4bb25c093933a6a0dee150cbf348f">mod_radiative_cooling::x_hildner</a></div><div class="ttdeci">double precision, dimension(1:5) x_hildner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a7961a939e49a748f32727184fafd6718"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a7961a939e49a748f32727184fafd6718">mod_radiative_cooling::calc_l_extended</a></div><div class="ttdeci">subroutine calc_l_extended(tpoint, lpoint, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02143">mod_radiative_cooling.t:2144</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a7a1c8e0f0aa6cea768bd790d1368e6a8"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a7a1c8e0f0aa6cea768bd790d1368e6a8">mod_radiative_cooling::t_mb</a></div><div class="ttdeci">double precision, dimension(1:51) t_mb</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a7b37d80a2bb954fedb9fa305980f3bc0"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a7b37d80a2bb954fedb9fa305980f3bc0">mod_radiative_cooling::radiative_cooling_add_source</a></div><div class="ttdeci">subroutine radiative_cooling_add_source(qdt, ixIL, ixOL, wCT, w, x, qsourcesplit, active, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01493">mod_radiative_cooling.t:1495</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a7bd34991ed29076faea8d491271e5413"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a7bd34991ed29076faea8d491271e5413">mod_radiative_cooling::a_spex_dm_fine</a></div><div class="ttdeci">double precision, dimension(1:14) a_spex_dm_fine</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a7f116c412a6622b43c3e6e58c6b35fb7"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a7f116c412a6622b43c3e6e58c6b35fb7">mod_radiative_cooling::l_dere_photo</a></div><div class="ttdeci">double precision, dimension(1:101) l_dere_photo</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a81371491ec33469383d33582db620b48"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a81371491ec33469383d33582db620b48">mod_radiative_cooling::n_spex_dm_fine</a></div><div class="ttdeci">integer n_spex_dm_fine</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a8381f20583d37a9494e2de33bd3ed8cb"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a8381f20583d37a9494e2de33bd3ed8cb">mod_radiative_cooling::n_rosner</a></div><div class="ttdeci">integer n_rosner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a84f06307c52394c171e290466a8aa195"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a84f06307c52394c171e290466a8aa195">mod_radiative_cooling::get_cool_equi</a></div><div class="ttdeci">subroutine get_cool_equi(qdt, ixIL, ixOL, wCT, w, x, fl, res)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01567">mod_radiative_cooling.t:1568</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a8936dfcd3aefa0a853fe4153ac850e92"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a8936dfcd3aefa0a853fe4153ac850e92">mod_radiative_cooling::l_jccorona</a></div><div class="ttdeci">double precision, dimension(1:45) l_jccorona</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a8cb61d871c1f67dbf213994e87d932be"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a8cb61d871c1f67dbf213994e87d932be">mod_radiative_cooling::t_dm_2</a></div><div class="ttdeci">double precision, dimension(1:76) t_dm_2</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a8e8273990816e7179b1b3b9b0846c135"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a8e8273990816e7179b1b3b9b0846c135">mod_radiative_cooling::n_dm_2</a></div><div class="ttdeci">integer n_dm_2</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a8fbfc551634dce377658b2b1ab8a9413"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a8fbfc551634dce377658b2b1ab8a9413">mod_radiative_cooling::l_dere_corona</a></div><div class="ttdeci">double precision, dimension(1:101) l_dere_corona</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a90afb884c1b454cc032bbf9c4918136e"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a90afb884c1b454cc032bbf9c4918136e">mod_radiative_cooling::l_cl_solar</a></div><div class="ttdeci">double precision, dimension(1:151) l_cl_solar</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a9217661a6d1b782ac684c8513e4bf01c"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a9217661a6d1b782ac684c8513e4bf01c">mod_radiative_cooling::l_dm</a></div><div class="ttdeci">double precision, dimension(1:71) l_dm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a93998291fb002bd7160c79cba04994b3"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a93998291fb002bd7160c79cba04994b3">mod_radiative_cooling::x_rosner</a></div><div class="ttdeci">double precision, dimension(1:9) x_rosner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a94896dac9a3cf4e4d7c5c927bcce4dad"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a94896dac9a3cf4e4d7c5c927bcce4dad">mod_radiative_cooling::x_klimchuk</a></div><div class="ttdeci">double precision, dimension(1:7) x_klimchuk</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a991bb73b9d368ac04331bb070bba0870"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a991bb73b9d368ac04331bb070bba0870">mod_radiative_cooling::a_spex_dm_rough</a></div><div class="ttdeci">double precision, dimension(1:7) a_spex_dm_rough</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a9ae0a5235a55413a338734c02f03d25c"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a9ae0a5235a55413a338734c02f03d25c">mod_radiative_cooling::n_mlwc</a></div><div class="ttdeci">integer n_mlwc</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a9c8d50c8c6c519a6b3c7d1a916d42b91"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a9c8d50c8c6c519a6b3c7d1a916d42b91">mod_radiative_cooling::x_fm</a></div><div class="ttdeci">double precision, dimension(1:4) x_fm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_a9e7237a0a6c123c52f3c517ad882475f"><div class="ttname"><a href="namespacemod__radiative__cooling.html#a9e7237a0a6c123c52f3c517ad882475f">mod_radiative_cooling::t_jccorona</a></div><div class="ttdeci">double precision, dimension(1:45) t_jccorona</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aa00eb7c5323358031d1d923adb79ee45"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aa00eb7c5323358031d1d923adb79ee45">mod_radiative_cooling::t_mlwc</a></div><div class="ttdeci">double precision, dimension(1:71) t_mlwc</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aa61b47ca3f179f19eebb33541903ed04"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aa61b47ca3f179f19eebb33541903ed04">mod_radiative_cooling::t_mlsolar1</a></div><div class="ttdeci">double precision, dimension(1:71) t_mlsolar1</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aa886c81ba2981c9c3cc43a0085058849"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aa886c81ba2981c9c3cc43a0085058849">mod_radiative_cooling::nenh_spex</a></div><div class="ttdeci">double precision, dimension(1:110) nenh_spex</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00195">mod_radiative_cooling.t:195</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aaa6bfaa8102cc71fa39a40d7fb872287"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aaa6bfaa8102cc71fa39a40d7fb872287">mod_radiative_cooling::n_mb</a></div><div class="ttdeci">integer n_mb</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ab2477d54f5f1250b8513b3bbb5a20ea5"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ab2477d54f5f1250b8513b3bbb5a20ea5">mod_radiative_cooling::findl</a></div><div class="ttdeci">subroutine findl(tpoint, Lpoint, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02160">mod_radiative_cooling.t:2161</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ab2920c6342f7f472e2ac36faf79b3c30"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ab2920c6342f7f472e2ac36faf79b3c30">mod_radiative_cooling::n_spex_dm_rough</a></div><div class="ttdeci">integer n_spex_dm_rough</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ab31b3d92c98eedfda0c3052596ff2672"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ab31b3d92c98eedfda0c3052596ff2672">mod_radiative_cooling::t_cl_ism</a></div><div class="ttdeci">double precision, dimension(1:151) t_cl_ism</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ab92582fd2be7a4f7caf8ee633e26f60f"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ab92582fd2be7a4f7caf8ee633e26f60f">mod_radiative_cooling::t_klimchuk</a></div><div class="ttdeci">double precision, dimension(1:8) t_klimchuk</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_abba25adbfbc95279ff263edee346dc35"><div class="ttname"><a href="namespacemod__radiative__cooling.html#abba25adbfbc95279ff263edee346dc35">mod_radiative_cooling::n_colgan</a></div><div class="ttdeci">integer n_colgan</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ac5928d214861b93e02a88018f37863f4"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ac5928d214861b93e02a88018f37863f4">mod_radiative_cooling::n_klimchuk</a></div><div class="ttdeci">integer n_klimchuk</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00112">mod_radiative_cooling.t:112</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ac62b4885715b9d9d8b142f39a1d69e59"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ac62b4885715b9d9d8b142f39a1d69e59">mod_radiative_cooling::l_cl_ism</a></div><div class="ttdeci">double precision, dimension(1:151) l_cl_ism</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ac7895ee8cc93a8e76b2a30be3faacab2"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ac7895ee8cc93a8e76b2a30be3faacab2">mod_radiative_cooling::l_mlwc</a></div><div class="ttdeci">double precision, dimension(1:71) l_mlwc</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ad4443dccc06f84fa778fea1d541b7f4d"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ad4443dccc06f84fa778fea1d541b7f4d">mod_radiative_cooling::getvar_cooling</a></div><div class="ttdeci">subroutine getvar_cooling(ixIL, ixOL, w, x, coolrate, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l01367">mod_radiative_cooling.t:1368</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ad973210231bc7335c3c8ef47f0d49adf"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ad973210231bc7335c3c8ef47f0d49adf">mod_radiative_cooling::t_spex_dm_rough</a></div><div class="ttdeci">double precision, dimension(1:8) t_spex_dm_rough</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00114">mod_radiative_cooling.t:114</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_adf796515078f438e7309b608f5e63454"><div class="ttname"><a href="namespacemod__radiative__cooling.html#adf796515078f438e7309b608f5e63454">mod_radiative_cooling::a_klimchuk</a></div><div class="ttdeci">double precision, dimension(1:7) a_klimchuk</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ae1c63cc7af1e58b105cfa0b2861bd275"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ae1c63cc7af1e58b105cfa0b2861bd275">mod_radiative_cooling::a_rosner</a></div><div class="ttdeci">double precision, dimension(1:9) a_rosner</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00120">mod_radiative_cooling.t:120</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ae3bf50014c5f9b160a1b9aa1d9b984e2"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ae3bf50014c5f9b160a1b9aa1d9b984e2">mod_radiative_cooling::l_mlsolar1</a></div><div class="ttdeci">double precision, dimension(1:71) l_mlsolar1</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00189">mod_radiative_cooling.t:189</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_ae450293b5673565067dbec5188ed3325"><div class="ttname"><a href="namespacemod__radiative__cooling.html#ae450293b5673565067dbec5188ed3325">mod_radiative_cooling::radiative_cooling_init_params</a></div><div class="ttdeci">subroutine radiative_cooling_init_params(phys_gamma, He_abund)</div><div class="ttdoc">Radiative cooling initialization.</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00780">mod_radiative_cooling.t:781</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aea74a2a9c1a2b8083c5d0faa0591bc97"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aea74a2a9c1a2b8083c5d0faa0591bc97">mod_radiative_cooling::t_spex</a></div><div class="ttdeci">double precision, dimension(1:110) t_spex</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_aef014e49d490cee95079a24f8e1f1771"><div class="ttname"><a href="namespacemod__radiative__cooling.html#aef014e49d490cee95079a24f8e1f1771">mod_radiative_cooling::x_spex_dm_fine</a></div><div class="ttdeci">double precision, dimension(1:14) x_spex_dm_fine</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00117">mod_radiative_cooling.t:117</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_af18323578e93aa12585a85a929bbc71b"><div class="ttname"><a href="namespacemod__radiative__cooling.html#af18323578e93aa12585a85a929bbc71b">mod_radiative_cooling::t_dm</a></div><div class="ttdeci">double precision, dimension(1:71) t_dm</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00184">mod_radiative_cooling.t:184</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_af43cf17b3fe8ed301f9d368bb219e33d"><div class="ttname"><a href="namespacemod__radiative__cooling.html#af43cf17b3fe8ed301f9d368bb219e33d">mod_radiative_cooling::n_mlsolar1</a></div><div class="ttdeci">integer n_mlsolar1</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00179">mod_radiative_cooling.t:179</a></div></div>
<div class="ttc" id="anamespacemod__radiative__cooling_html_af83676692c75ed5298df09d2a07b7dde"><div class="ttname"><a href="namespacemod__radiative__cooling.html#af83676692c75ed5298df09d2a07b7dde">mod_radiative_cooling::cool_exact</a></div><div class="ttdeci">subroutine cool_exact(qdt, ixIL, ixOL, wCT, w, x, fl)</div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l02057">mod_radiative_cooling.t:2058</a></div></div>
<div class="ttc" id="astructmod__radiative__cooling_1_1rc__fluid_html"><div class="ttname"><a href="structmod__radiative__cooling_1_1rc__fluid.html">mod_radiative_cooling::rc_fluid</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__radiative__cooling_8t_source.html#l00049">mod_radiative_cooling.t:49</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
