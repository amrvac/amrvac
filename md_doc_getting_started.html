<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: Getting started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page shows how to run a first problem after the <a class="el" href="md_doc_installation.html">Installation</a> is completed.</p>
<h1>The VAC problem</h1>
<p>Traditionally, the first test problem is the VAC advection located in <code>amrvac/tests/rho/vac</code>. Two files are present in this folder:</p>
<ul>
<li><code>mod_usr.t</code>: the user code for this problem (defining e.g. initial conditions)</li>
<li><code>amrvac.par</code>: a text file with settings</li>
</ul>
<h1><a class="anchor" id="vac_compilation"></a>
Compilation</h1>
<p>In the vac test folder, run the setup script with: </p><pre class="fragment">setup.pl -d=2
</pre><p> This will copy a makefile to the current folder, set the problem dimension to two, and use the default compiler settings, which is gfortran with openMPI. To select different compiler settings (present in <code>amrvac/arch/</code>) you could for example use: </p><pre class="fragment">setup.pl -d=2 -arch=intel
setup.pl -d=2 -arch=debug
</pre><p> You can also edit the <code>makefile</code> directly.</p>
<p>Then it is time to compile the code: </p><pre class="fragment">make -j 4
</pre><p> This will perform a parallel compilation using 4 cores. First, the AMRVAC library is compiled in <code>amrvac/lib/</code> if it is not available already. This is the generic part of AMRVAC that does not depend on your user code. Then your user code is also compiled, and an executable binary file called <code>amrvac</code> is produced.</p>
<p>There are a couple of useful commands to know about: </p><pre class="fragment">make clean        # clean the local object files
make ARCH=debug   # do a debug build (extra error checking)
make ARCH=&lt;name&gt;  # use the compilation flags from arch/&lt;name&gt;.defs
make allclean     # clean the local object files and the AMRVAC library
</pre> <h1><a class="anchor" id="vac_run"></a>
Running the test</h1>
<p>To run the test problem on 4 cores: </p><pre class="fragment">mpirun -np 4 ./amrvac -i amrvac.par
</pre><p> This will run amrvac with parameter-file amrvac.par. Then you have several new files ending in <code>.dat</code>, <code>.vtu</code> and one <code>.log</code> file. The <code>.dat</code> files are used for restarts and the <code>.vtu</code> files contain the output data to be visualized.</p>
<h1><a class="anchor" id="visualization"></a>
Visualization</h1>
<p>Simulation output in <code>.vtu</code> (VTK unstructured) format can directly be visualized using <a href="http://www.paraview.org/">Paraview</a> or <a href="https://wci.llnl.gov/simulation/computer-codes/visit">Visit</a>.</p>
<p>Visualization or analysis of the results can also be done by converting <code>.dat</code> files to e.g., Tecplot, or VTK native formats. This requires the same amrvac executable used to run the simulation. Using a csh script tool <code>aiconvert</code> in amrvac/tools folder, users can convert to a format defined by <b>convert_type</b> parameter in the <em>filelist</em> of an input par file: </p><pre class="fragment">aiconvert
</pre><p> to convert all <code>.dat</code> files related to amrvac.par file, or </p><pre class="fragment">aiconvert 10 20
</pre><p> from snapshot 10 to 20, or </p><pre class="fragment">aiconvert YOUR.par 0 20
</pre><p> to convert snapshot 0 to 20 related to YOUR.par file. You can find more information at <a class="el" href="md_doc_convert.html">convert</a> page. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
