!=====================================================
! Project : 2D Radiative MHD convection, with AMR
! Aim     : Hurlburt-Toomre setup with FLD
! Results :
! Update  : 04/08/2025
! configuration :
! $AMRVAC_DIR/setup.pl -d=2 -v=2
!=====================================================

 &filelist
        base_filename='Convection2d'
        saveprim=T
        autoconvert=T
        typefilelog='regression_test'
        convert_type='vtuBCCmpi'
        nwauxio=9
 /

 &savelist
        itsave(1,1)=0
        itsave(1,2)=0
        ditsave_log=1
        ditsave_dat=5
 /

 &stoplist
        dtmin=1.D-20    
        it_max=25
 /

 &methodlist
        time_stepper = 'threestep'   
        time_integrator = 'IMEX_ARS3'
        flux_scheme=    20*'hll'
        limiter= 20*'cada3'
        typesourcesplit = 'sfs'
        check_small_values=.true.
        small_values_method = 'replace'
        small_pressure = 1.d-12
        small_density = 1.d-12
 /

 &boundlist
        typeboundary_min1=7*'periodic'
        typeboundary_max1=7*'periodic'
        typeboundary_min2=7*'special' 
        typeboundary_max2=7*'special' 
 /

	logflag(1) = T
	logflag(4) = T
	logflag(7) = T
 &meshlist
        refine_criterion=3
        refine_max_level=5
        w_refine_weight(1)=0.3d0
	w_refine_weight(4)=0.3d0
	w_refine_weight(7)=0.4d0
        refine_threshold=20*0.5d0
        derefine_ratio=20*0.6d0
        block_nx1=10
        block_nx2=10
        domain_nx1=60
        domain_nx2=20
        xprobmin1=0.d0
        xprobmax1=3.d0
        xprobmin2=0.d0
        xprobmax2=1.d0
        iprob=1
 /

 &paramlist
        slowsteps=10  
        typecourant='maxsum'
        courantpar=0.9d0
        dtdiffpar=0.4d0
 /

 &rmhd_list
        rmhd_thermal_conduction=.true.
        rmhd_viscosity=.true.
        rmhd_gravity=.true.
        He_abundance = 0.d0 
        rmhd_energy = .true.
        radio_acoustic_filter = .false.
        rmhd_radiation_formalism = 'fld'
        rmhd_radiation_force = .true. 
        rmhd_energy_interact = .true.
        rmhd_radiation_diffusion = .true.
        rmhd_radiation_advection = .true.
/

 &fld_list
        fld_Eint_split = .false.
        fld_Radforce_split = .false.
        fld_opacity_law = 'const'
        fld_kappa0 = 0.4d0
        fld_diff_scheme = 'mg'
        fld_interaction_method = 'Halley'
        fld_fluxlimiter = 'Diffusion'
        fld_diff_tol = 1.d-7
 /
