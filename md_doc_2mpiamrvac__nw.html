<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: Auxiliary variables (nw...)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPI-AMRVAC<span id="projectnumber">&#160;3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Auxiliary variables (nw...)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="list"></a>
List of auxiliary variables</h1>
<p>This document describes the differences and the intended use of the <b>nwaux, nwextra</b> parameters. These global parameters are defined in the <code><a class="el" href="mod__variables_8t.html">mod_variables.t</a></code></p>
<h2><a class="anchor" id="nw"></a>
nw</h2>
<p>This global parameter sets the total number of variables, determining the (last dimension-independent) size of the <em>w(ixG^T,1:nw)</em> array, and is always </p><pre class="fragment"> nw = nwflux+nwaux+nwextra
</pre><p> The idea is that there are <em>nwflux</em> conservative variables for which corresponding fluxes are defined in the physics modules, and that we have in addition a set of <em>nwaux</em> auxiliary variables, together with some extra <em>nwextra</em> variables. For these latter two types of variables, one does not have a corresponding flux definition in <em>getflux, gefluxforhllc</em> subroutines, and they also have no boundary conditions imposed on them.</p>
<h2><a class="anchor" id="nwflux"></a>
nwflux</h2>
<p>The first <em>1:nwflux</em> variables should be the conservative variables of the physics module at hand, and these are the ones that are updated by means of fluxes across cell boundaries, and are influenced by source terms (geometric or real physical source terms). Also, those variables change their meaning/content in the subroutines <em>phys_to_primitive</em>, <em>phys_to_conserved</em>. These two subroutines are thus switching from conservative to primitive and vice versa at appropriate places in the code. For the first <em>1:nwflux</em> variables, the boundary conditions are to be imposed and existing boundary types have to be provided (like <em>symm, asymm, special, cont, periodic, ...</em>) in the par-file. For steady-state computations, the residual is based on only the temporal variation of these <em>1:nwflux</em> variables.</p>
<h2><a class="anchor" id="nwaux"></a>
nwaux</h2>
<p>When for the physics module at hand, one has <em>nwaux&gt;0</em>, the slots in the <em>w</em>- array corresponding to <em>nwflux+1:nwflux+nwaux</em> contain so-called auxiliary variables. They can be computed directly from instantaneous local values of the flux <em>1:nwflux</em> variables. These local auxiliary variables are all to be computed in the <em>getaux</em> subroutine in the physics module. Since they are to be used for facilitating flux specifications, they also need to be known in the ghost cells. This is taken care of by the <em>fix_auxiliary</em> call in the boundary condition treatment: note that they are thus computed from local (ghostcell) values from conservative variables (themselves computed according to their boundary type), so that we do not need to specify a boundary type for the <em>nwflux+1:nwflux+nwaux</em> variables. The local auxiliaries can in fact also be used to trigger refinement or coarsening. The current (Newtonian) physics modules of AMRVAC have no real use for these auxiliary variables.</p>
<h2><a class="anchor" id="nwextra"></a>
nwextra</h2>
<p>An extra set of <em>nwextra</em> variables can be defined in addition to the presently available ones in physics modules by using the function var_set_extravar (from <a class="el" href="mod__variables_8t.html">mod_variables.t</a>) in usr_init of mod_usr.t. Like auxiliaries, they are not advanced (no fluxes need to be defined for them in <em>get_flux</em>), there are no boundary conditions imposed on them, and they should not be used for basing refinement/derefinement on. They are not computed in the ghost cells, and they can be used to store additional physical variables like old pressure or temperature values, the accumulated luminosity (internal energy change) during a timestep, local variables that depend on gradients of the flux variables (divergence of the velocity, curl of the magnetic field), etc. they need to be computed/updated in the pointed <em>usr_process_grid</em> subroutine. They work to facilitate the understanding of simulation processes.</p>
<h2><a class="anchor" id="nwauxio"></a>
nwauxio</h2>
<p>Only for post-processing purposes on saved snapshots from the code, one may want to compute additional auxiliary variables for visualization. Hence, only at the <a class="el" href="md_doc_2convert.html">convert-stage</a> (from .dat data file to any of the available formats in the <em>convert</em> subroutine in src/amrvacio/convert.t file) do we need to enlarge the data size from <em>nw</em> to <em>nw+nwauxio</em>, and their calculation is to be done in the pointed <em>usr_aux_output</em> subroutine, for which the default interface is given in the <a class="el" href="mod__usr__methods_8t.html">mod_usr_methods.t</a> module. Correspondingly, the names have to be given in the pointed <em>usr_add_aux_names</em> subroutine strings. This means that normally <em>nwauxio=0</em>, but it can be at convert stage set to a nonzero value in the <em>filelist</em> part of the par- file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
