<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: Rotating frame for HD/MHD/RHD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPI-AMRVAC<span id="projectnumber">&#160;3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Rotating frame for HD/MHD/RHD</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>An overview of how to activate the rotating frame module. This module works for cylindrical and spherical problems in 1-D, 2-D, and 3-D.</p>
<h1>Physics</h1>
<p>For some problems it may be desirable to let the coordinate system rotate with a certain rate and perform computations in a rotating frame of reference. For example, one can anchor then the coordinate system to the object under study to yield simpler boundary conditions. This method will, however, lead to the introduction of fictitious or "pseudo" forces in the governing equations of the system. Particularly, the Coriolis force and the centrifugal force need to be taken into account.</p>
<p>When active, the rotating_frame.t module adds these fictitious sources to the momentum and energy equations. At all times the rotation axis of the frame is assumed to point along the \( z \)-axis of a Cartesian coordinate system. Similarly the rotating frame rotates at a <b>uniform</b> angular frequency \( \omega_0 \), meaning no fictitious Euler force can develop.</p>
<p><b>NOTE</b>: The user should be aware that the fictitious forces are <b>not</b> added in an angular momentum conserving fashion. The latter means that the azimuthal component of the Coriolis force is incorporated directly into the azimuthal flux computation within the conservative equations. Such angular momentum conserving formulation may be important for some applications, see for example <a href="https://ui.adsabs.harvard.edu/abs/1998A%26A...338L..37K/abstract">Kley (1998)</a>. The present implementation in MPI-AMRVAC adds all fictitious force components displayed below as source terms to the conservative equations.</p>
<h2>Cylindrical coordinates</h2>
<p>The extra fictitious sources added to the momentum equations:  </p><p class="formulaDsp">
\begin{eqnarray*}
 S_{\rho v_r}    &amp;=&amp; 2\omega_0 v_\phi + \omega_0**2 r, \\
 S_{\rho v_\phi} &amp;=&amp; -2\omega_0 v_r, 
\end{eqnarray*}
</p>
<p> and if doing non-isothermal simulations the fictitious work due to the centrifugal force will be added  </p><p class="formulaDsp">
\[
S_e = \rho v_r r \omega_0**2.
\]
</p>
<h2>Spherical coordinates</h2>
<p>The extra fictitious sources added to the momentum equations:  </p><p class="formulaDsp">
\begin{eqnarray*}
 S_{\rho v_r}  &amp;=&amp; 2\omega_0 v_\phi \sin \theta + r (\omega_0 \sin \theta)**2, \\
 S_{\rho v_\theta} &amp;=&amp; \cot \theta \left[ 2\omega_0 v_\phi \sin \theta + r (\omega_0 \sin \theta)**2 \right], \\
 S_{\rho v_\phi} &amp;=&amp; -2\omega_0 \sin \theta (v_r + v_\theta \cot \theta), 
\end{eqnarray*}
</p>
<p> and if doing non-isothermal simulations the fictitious work due to the centrifugal force will be added  </p><p class="formulaDsp">
\[
S_e = \rho r (\omega_0 \sin \theta)**2 (v_r + v_\theta \cot \theta).
\]
</p>
<h1>Practical use</h1>
<p>In order to activate the addition of fictitious forces, the user has to adjust the .par file as indicated in this section. For applications of the rotating frame physics, see the <code>CAKwind_spherical_2.5D</code> test problem in the HD tests folder or the <code>icarus</code> test problem in the MHD tests folder.</p>
<h2>Activating the module</h2>
<p>Depending whether the setup is in HD, MHD, or RHD the rotating frame needs to be activated in the physics-dependent namelist. This means that for a HD simulation one adds in the <code>&amp;hd_list</code> the following: </p><div class="fragment"><div class="line">&amp;hd_list</div>
<div class="line">  hd_rotating_frame = .true.</div>
<div class="line">/</div>
</div><!-- fragment --><p> and a similar procedure applies when employing the <code>&amp;mhd_list</code> or <code>&amp;rhd_list</code>. Additionally, a <code>&amp;rotating_frame_list</code> list has to be supplied with the (dimensionless) angular frequency of the frame: </p><div class="fragment"><div class="line">&amp;rotating_frame_list</div>
<div class="line">  omega_frame = DOUBLE</div>
<div class="line">/</div>
</div><!-- fragment --><p> This value can be overwritten with a computed value in the mod_usr.t if the uniform angular frequency happens to depend on other user input parameters.</p>
<h1>Numerics and implementation</h1>
<p>The rotating frame physics module is found in <a class="el" href="mod__rotating__frame_8t.html">mod_rotating_frame.t</a>. This module has some subroutines that are called in the <a class="el" href="mod__hd__phys_8t.html">mod_hd_phys.t</a>, <a class="el" href="mod__mhd__phys_8t.html">mod_mhd_phys.t</a>, and <a class="el" href="mod__rhd__phys_8t.html">mod_rhd_phys.t</a> module to allow to initialise, compute, and add the fictitious forces to the physics governing equations.</p>
<h2>Primary subroutines</h2>
<p><em>rotating_frame_add_source:</em> This subroutine computes the Coriolis and centrifugal contributions to the components of the momentum equation and the energy equation. Based on the geometry (cylindrical or spherical) and the problem dimension the source terms can assume different appearances. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
