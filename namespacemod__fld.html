<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: mod_fld Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mod_fld Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Nicolas Moens Module for including flux limited diffusion (FLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information.  
<a href="namespacemod__fld.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2fab030adfe37e60459f2f6c8140f091"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a2fab030adfe37e60459f2f6c8140f091">fld_params_read</a> (files)</td></tr>
<tr class="memdesc:a2fab030adfe37e60459f2f6c8140f091"><td class="mdescLeft">&#160;</td><td class="mdescRight">public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a>  <a href="namespacemod__fld.html#a2fab030adfe37e60459f2f6c8140f091">More...</a><br /></td></tr>
<tr class="separator:a2fab030adfe37e60459f2f6c8140f091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac391ad2256509da6e71540cbe251c37e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ac391ad2256509da6e71540cbe251c37e">fld_init</a> (He_abundance, rhd_radiation_diffusion, rhd_gamma)</td></tr>
<tr class="memdesc:ac391ad2256509da6e71540cbe251c37e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ...  <a href="namespacemod__fld.html#ac391ad2256509da6e71540cbe251c37e">More...</a><br /></td></tr>
<tr class="separator:ac391ad2256509da6e71540cbe251c37e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b296a7d3fd6af5af21981633281db6f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a8b296a7d3fd6af5af21981633281db6f">get_fld_rad_force</a> (qdt, ixIL, ixOL, wCT, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:a8b296a7d3fd6af5af21981633281db6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force  <a href="namespacemod__fld.html#a8b296a7d3fd6af5af21981633281db6f">More...</a><br /></td></tr>
<tr class="separator:a8b296a7d3fd6af5af21981633281db6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e37bb8ef924c82af5fc1d1263c9415a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a2e37bb8ef924c82af5fc1d1263c9415a">fld_radforce_get_dt</a> (w, ixIL, ixOL, dtnew, dxD, x)</td></tr>
<tr class="separator:a2e37bb8ef924c82af5fc1d1263c9415a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7aa7efd71997039f66577052264a90b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ad7aa7efd71997039f66577052264a90b">get_fld_energy_interact</a> (qdt, ixIL, ixOL, wCT, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:ad7aa7efd71997039f66577052264a90b"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the energy exchange between gas and radiation  <a href="namespacemod__fld.html#ad7aa7efd71997039f66577052264a90b">More...</a><br /></td></tr>
<tr class="separator:ad7aa7efd71997039f66577052264a90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f2df78330406043ccd51c94710a9f7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7">fld_get_opacity</a> (w, x, ixIL, ixOL, fld_kappa)</td></tr>
<tr class="memdesc:ac9f2df78330406043ccd51c94710a9f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in opacities from opal tables.">mod_opal_opacity</a>.  <a href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7">More...</a><br /></td></tr>
<tr class="separator:ac9f2df78330406043ccd51c94710a9f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ff35a06221274a626b1fbf804c1915"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915">fld_get_fluxlimiter</a> (w, x, ixIL, ixOL, fld_lambda, fld_R)</td></tr>
<tr class="memdesc:af3ff35a06221274a626b1fbf804c1915"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path.  <a href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915">More...</a><br /></td></tr>
<tr class="separator:af3ff35a06221274a626b1fbf804c1915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa4eeaef264e95fa1ce26c4e170adce"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a5fa4eeaef264e95fa1ce26c4e170adce">fld_get_radflux</a> (w, x, ixIL, ixOL, rad_flux)</td></tr>
<tr class="memdesc:a5fa4eeaef264e95fa1ce26c4e170adce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Flux stores radiation flux in w-array.  <a href="namespacemod__fld.html#a5fa4eeaef264e95fa1ce26c4e170adce">More...</a><br /></td></tr>
<tr class="separator:a5fa4eeaef264e95fa1ce26c4e170adce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e71ba3e0db60cc1ef67b2229621677e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a4e71ba3e0db60cc1ef67b2229621677e">fld_get_eddington</a> (w, x, ixIL, ixOL, eddington_tensor)</td></tr>
<tr class="memdesc:a4e71ba3e0db60cc1ef67b2229621677e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Eddington-tensor Stores Eddington-tensor in w-array.  <a href="namespacemod__fld.html#a4e71ba3e0db60cc1ef67b2229621677e">More...</a><br /></td></tr>
<tr class="separator:a4e71ba3e0db60cc1ef67b2229621677e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6de94c421ca190d4cc8fbd98890df60"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ab6de94c421ca190d4cc8fbd98890df60">fld_get_radpress</a> (w, x, ixIL, ixOL, rad_pressure)</td></tr>
<tr class="memdesc:ab6de94c421ca190d4cc8fbd98890df60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Pressure Returns Radiation Pressure as tensor.  <a href="namespacemod__fld.html#ab6de94c421ca190d4cc8fbd98890df60">More...</a><br /></td></tr>
<tr class="separator:ab6de94c421ca190d4cc8fbd98890df60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a252186780c5a68f744c09e61199eed1c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a252186780c5a68f744c09e61199eed1c">diffuse_e_rad_mg</a> (dtfactor, qdt, qtC, psa, psb)</td></tr>
<tr class="memdesc:a252186780c5a68f744c09e61199eed1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library.  <a href="namespacemod__fld.html#a252186780c5a68f744c09e61199eed1c">More...</a><br /></td></tr>
<tr class="separator:a252186780c5a68f744c09e61199eed1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade46e76ac547d6c1f1c27e324f94af46"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ade46e76ac547d6c1f1c27e324f94af46">evaluate_e_rad_mg</a> (qtC, psa)</td></tr>
<tr class="memdesc:ade46e76ac547d6c1f1c27e324f94af46"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <a href="namespacemod__fld.html#ade46e76ac547d6c1f1c27e324f94af46">More...</a><br /></td></tr>
<tr class="separator:ade46e76ac547d6c1f1c27e324f94af46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72319afced2bbf19fa978c888ca00e45"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a72319afced2bbf19fa978c888ca00e45">put_diffterm_onegrid</a> (ixIL, ixOL, w)</td></tr>
<tr class="memdesc:a72319afced2bbf19fa978c888ca00e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <a href="namespacemod__fld.html#a72319afced2bbf19fa978c888ca00e45">More...</a><br /></td></tr>
<tr class="separator:a72319afced2bbf19fa978c888ca00e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0cd21f12833bcf8f7c05412c7bc46a6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae0cd21f12833bcf8f7c05412c7bc46a6">fld_get_diffcoef_central</a> (w, wCT, x, ixIL, ixOL)</td></tr>
<tr class="memdesc:ae0cd21f12833bcf8f7c05412c7bc46a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates cell-centered diffusion coefficient to be used in multigrid.  <a href="namespacemod__fld.html#ae0cd21f12833bcf8f7c05412c7bc46a6">More...</a><br /></td></tr>
<tr class="separator:ae0cd21f12833bcf8f7c05412c7bc46a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e6e06ef18024f6865cadb7aab2aa00"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00">update_diffcoeff</a> (psa)</td></tr>
<tr class="separator:a38e6e06ef18024f6865cadb7aab2aa00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274a5ee4b7ee438bc3a3f538359cd7b3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a274a5ee4b7ee438bc3a3f538359cd7b3">fld_smooth_diffcoef</a> (w, ixIL, ixOL)</td></tr>
<tr class="memdesc:a274a5ee4b7ee438bc3a3f538359cd7b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use running average on Diffusion coefficient.  <a href="namespacemod__fld.html#a274a5ee4b7ee438bc3a3f538359cd7b3">More...</a><br /></td></tr>
<tr class="separator:a274a5ee4b7ee438bc3a3f538359cd7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03cf61257d6dd23014c08b06329d2b2c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a03cf61257d6dd23014c08b06329d2b2c">energy_interaction</a> (w, wCT, x, ixIL, ixOL)</td></tr>
<tr class="memdesc:a03cf61257d6dd23014c08b06329d2b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implicit scheme. These sourceterms are applied using the root-finding of a 4th order polynomial This routine loops over every cell in the domain and computes the coefficients of the polynomials in every cell.  <a href="namespacemod__fld.html#a03cf61257d6dd23014c08b06329d2b2c">More...</a><br /></td></tr>
<tr class="separator:a03cf61257d6dd23014c08b06329d2b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae111198d92df820a9edeaf0073f4107e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae111198d92df820a9edeaf0073f4107e">bisection_method</a> (e_gas, E_rad, c0, c1)</td></tr>
<tr class="memdesc:ae111198d92df820a9edeaf0073f4107e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the bisection method.  <a href="namespacemod__fld.html#ae111198d92df820a9edeaf0073f4107e">More...</a><br /></td></tr>
<tr class="separator:ae111198d92df820a9edeaf0073f4107e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1668b588f8b86ac4d95d46ee2ecd1f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#afd1668b588f8b86ac4d95d46ee2ecd1f">newton_method</a> (e_gas, E_rad, c0, c1)</td></tr>
<tr class="memdesc:afd1668b588f8b86ac4d95d46ee2ecd1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Newton-Ralphson method.  <a href="namespacemod__fld.html#afd1668b588f8b86ac4d95d46ee2ecd1f">More...</a><br /></td></tr>
<tr class="separator:afd1668b588f8b86ac4d95d46ee2ecd1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b4aeeffe4c5918e0bd2a8858efea215"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a6b4aeeffe4c5918e0bd2a8858efea215">halley_method</a> (e_gas, E_rad, c0, c1)</td></tr>
<tr class="memdesc:a6b4aeeffe4c5918e0bd2a8858efea215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Halley method.  <a href="namespacemod__fld.html#a6b4aeeffe4c5918e0bd2a8858efea215">More...</a><br /></td></tr>
<tr class="separator:a6b4aeeffe4c5918e0bd2a8858efea215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec89cf1950c713250b72d34680df7c0"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0">polynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a8ec89cf1950c713250b72d34680df7c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate polynomial at argument e_gas.  <a href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0">More...</a><br /></td></tr>
<tr class="separator:a8ec89cf1950c713250b72d34680df7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac956fe2dd223e2039a113a0d0c2991d0"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0">dpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:ac956fe2dd223e2039a113a0d0c2991d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate first derivative of polynomial at argument e_gas.  <a href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0">More...</a><br /></td></tr>
<tr class="separator:ac956fe2dd223e2039a113a0d0c2991d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c3cb192d4ff204d751bbabdc46570a3"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a5c3cb192d4ff204d751bbabdc46570a3">ddpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a5c3cb192d4ff204d751bbabdc46570a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate second derivative of polynomial at argument e_gas.  <a href="namespacemod__fld.html#a5c3cb192d4ff204d751bbabdc46570a3">More...</a><br /></td></tr>
<tr class="separator:a5c3cb192d4ff204d751bbabdc46570a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10a1413ec8612a5dd9a5b09eb68919a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a10a1413ec8612a5dd9a5b09eb68919a7">gradiento</a> (q, x, ixIL, ixOL, idir, gradq, n)</td></tr>
<tr class="memdesc:a10a1413ec8612a5dd9a5b09eb68919a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S), NOT gradq(ixI^S)  <a href="namespacemod__fld.html#a10a1413ec8612a5dd9a5b09eb68919a7">More...</a><br /></td></tr>
<tr class="separator:a10a1413ec8612a5dd9a5b09eb68919a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa33a1dcdba3d105c08f8da30c1561101"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#aa33a1dcdba3d105c08f8da30c1561101">fld_eint_split</a> = .false.</td></tr>
<tr class="memdesc:aa33a1dcdba3d105c08f8da30c1561101"><td class="mdescLeft">&#160;</td><td class="mdescRight">source split for energy interact and radforce:  <a href="namespacemod__fld.html#aa33a1dcdba3d105c08f8da30c1561101">More...</a><br /></td></tr>
<tr class="separator:aa33a1dcdba3d105c08f8da30c1561101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf910fa47bd4269dd49980e2f51efc46"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#abf910fa47bd4269dd49980e2f51efc46">fld_radforce_split</a> = .false.</td></tr>
<tr class="separator:abf910fa47bd4269dd49980e2f51efc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833746bb6e5dbd734a00ec94b4669b1b"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a833746bb6e5dbd734a00ec94b4669b1b">fld_kappa0</a> = 0.34d0</td></tr>
<tr class="memdesc:a833746bb6e5dbd734a00ec94b4669b1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opacity per unit of unit_density.  <a href="namespacemod__fld.html#a833746bb6e5dbd734a00ec94b4669b1b">More...</a><br /></td></tr>
<tr class="separator:a833746bb6e5dbd734a00ec94b4669b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a1b3ea3f3889855c64aeb21fd813bb7d3">fld_mu</a> = 0.6d0</td></tr>
<tr class="memdesc:a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">mean particle mass  <a href="namespacemod__fld.html#a1b3ea3f3889855c64aeb21fd813bb7d3">More...</a><br /></td></tr>
<tr class="separator:a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1baf3c3f8c4e68834dfedd8f7362663a"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a1baf3c3f8c4e68834dfedd8f7362663a">fld_bisect_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a1baf3c3f8c4e68834dfedd8f7362663a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy.  <a href="namespacemod__fld.html#a1baf3c3f8c4e68834dfedd8f7362663a">More...</a><br /></td></tr>
<tr class="separator:a1baf3c3f8c4e68834dfedd8f7362663a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23d86935a2e8d953c3ef8e5270eac0ff"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a23d86935a2e8d953c3ef8e5270eac0ff">fld_diff_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a23d86935a2e8d953c3ef8e5270eac0ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for adi method for radiative Energy diffusion.  <a href="namespacemod__fld.html#a23d86935a2e8d953c3ef8e5270eac0ff">More...</a><br /></td></tr>
<tr class="separator:a23d86935a2e8d953c3ef8e5270eac0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77876e7c2f8261a6c8a31f2d8659f05"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af77876e7c2f8261a6c8a31f2d8659f05">diff_crit</a></td></tr>
<tr class="memdesc:af77876e7c2f8261a6c8a31f2d8659f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number for splitting the diffusion module.  <a href="namespacemod__fld.html#af77876e7c2f8261a6c8a31f2d8659f05">More...</a><br /></td></tr>
<tr class="separator:af77876e7c2f8261a6c8a31f2d8659f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4717a388644e4cb1fe9b0e27860d2007"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a4717a388644e4cb1fe9b0e27860d2007">fld_opacity_law</a> = 'const'</td></tr>
<tr class="memdesc:a4717a388644e4cb1fe9b0e27860d2007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use constant Opacity?  <a href="namespacemod__fld.html#a4717a388644e4cb1fe9b0e27860d2007">More...</a><br /></td></tr>
<tr class="separator:a4717a388644e4cb1fe9b0e27860d2007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08359f6c5f97d728f29a27255f244fe"><td class="memItemLeft" align="right" valign="top">character(len=6)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae08359f6c5f97d728f29a27255f244fe">fld_opal_table</a> = 'Y09800'</td></tr>
<tr class="separator:ae08359f6c5f97d728f29a27255f244fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6653738fcac09ac966028771a78e4d52"><td class="memItemLeft" align="right" valign="top">character(len=16)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a6653738fcac09ac966028771a78e4d52">fld_fluxlimiter</a> = 'Pomraning'</td></tr>
<tr class="memdesc:a6653738fcac09ac966028771a78e4d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion limit lambda = 0.33.  <a href="namespacemod__fld.html#a6653738fcac09ac966028771a78e4d52">More...</a><br /></td></tr>
<tr class="separator:a6653738fcac09ac966028771a78e4d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada3e212a237e18cb9a3166799117c6fa"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ada3e212a237e18cb9a3166799117c6fa">i_diff_mg</a></td></tr>
<tr class="memdesc:ada3e212a237e18cb9a3166799117c6fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">diffusion coefficient for multigrid method  <a href="namespacemod__fld.html#ada3e212a237e18cb9a3166799117c6fa">More...</a><br /></td></tr>
<tr class="separator:ada3e212a237e18cb9a3166799117c6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a856d86414a9d106690e2f9f33976b705"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a856d86414a9d106690e2f9f33976b705">fld_diff_scheme</a> = 'mg'</td></tr>
<tr class="memdesc:a856d86414a9d106690e2f9f33976b705"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to solve diffusion part.  <a href="namespacemod__fld.html#a856d86414a9d106690e2f9f33976b705">More...</a><br /></td></tr>
<tr class="separator:a856d86414a9d106690e2f9f33976b705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52da06b97cae443e859349f1c04b5fa"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ab52da06b97cae443e859349f1c04b5fa">fld_interaction_method</a> = 'Halley'</td></tr>
<tr class="memdesc:ab52da06b97cae443e859349f1c04b5fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to find the root for the energy interaction polynomial.  <a href="namespacemod__fld.html#ab52da06b97cae443e859349f1c04b5fa">More...</a><br /></td></tr>
<tr class="separator:ab52da06b97cae443e859349f1c04b5fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae865a7dd858718239c52ff826e35bedd"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae865a7dd858718239c52ff826e35bedd">diff_coef_filter</a> = .false.</td></tr>
<tr class="memdesc:ae865a7dd858718239c52ff826e35bedd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take running average for Diffusion coefficient.  <a href="namespacemod__fld.html#ae865a7dd858718239c52ff826e35bedd">More...</a><br /></td></tr>
<tr class="separator:ae865a7dd858718239c52ff826e35bedd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ef494608b155112c93ba41930b05b7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a76ef494608b155112c93ba41930b05b7">size_d_filter</a> = 1</td></tr>
<tr class="separator:a76ef494608b155112c93ba41930b05b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25919ae30d513d31baef1185e5f3088"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae25919ae30d513d31baef1185e5f3088">flux_lim_filter</a> = .false.</td></tr>
<tr class="memdesc:ae25919ae30d513d31baef1185e5f3088"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a running average over the fluxlimiter.  <a href="namespacemod__fld.html#ae25919ae30d513d31baef1185e5f3088">More...</a><br /></td></tr>
<tr class="separator:ae25919ae30d513d31baef1185e5f3088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7471e33d67b7dfb4f836eb7b8df8ec0f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a7471e33d67b7dfb4f836eb7b8df8ec0f">size_l_filter</a> = 1</td></tr>
<tr class="separator:a7471e33d67b7dfb4f836eb7b8df8ec0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adb0b2d41f252cf64683544a14b47ef"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a8adb0b2d41f252cf64683544a14b47ef">lineforce_opacities</a> = .false.</td></tr>
<tr class="memdesc:a8adb0b2d41f252cf64683544a14b47ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use or dont use lineforce opacities.  <a href="namespacemod__fld.html#a8adb0b2d41f252cf64683544a14b47ef">More...</a><br /></td></tr>
<tr class="separator:a8adb0b2d41f252cf64683544a14b47ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f9f6143b297d23f4fc26012e98cf32"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a31f9f6143b297d23f4fc26012e98cf32">diffcrash_resume</a> = .true.</td></tr>
<tr class="memdesc:a31f9f6143b297d23f4fc26012e98cf32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume run when multigrid returns error.  <a href="namespacemod__fld.html#a31f9f6143b297d23f4fc26012e98cf32">More...</a><br /></td></tr>
<tr class="separator:a31f9f6143b297d23f4fc26012e98cf32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3c400ea76d816d13544c77938e78e9"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a3b3c400ea76d816d13544c77938e78e9">i_opf</a></td></tr>
<tr class="memdesc:a3b3c400ea76d816d13544c77938e78e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for Flux weighted opacities.  <a href="namespacemod__fld.html#a3b3c400ea76d816d13544c77938e78e9">More...</a><br /></td></tr>
<tr class="separator:a3b3c400ea76d816d13544c77938e78e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af736b4330bbe9b53d2a6effc9d2e1730"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af736b4330bbe9b53d2a6effc9d2e1730">dt_diff</a> = 0.d0</td></tr>
<tr class="memdesc:af736b4330bbe9b53d2a6effc9d2e1730"><td class="mdescLeft">&#160;</td><td class="mdescRight">running timestep for diffusion solver, initialised as zero  <a href="namespacemod__fld.html#af736b4330bbe9b53d2a6effc9d2e1730">More...</a><br /></td></tr>
<tr class="separator:af736b4330bbe9b53d2a6effc9d2e1730"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Nicolas Moens Module for including flux limited diffusion (FLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae111198d92df820a9edeaf0073f4107e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae111198d92df820a9edeaf0073f4107e">&#9670;&nbsp;</a></span>bisection_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::bisection_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>E_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the bisection method. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01236">1236</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ae111198d92df820a9edeaf0073f4107e_cgraph.png" border="0" usemap="#anamespacemod__fld_ae111198d92df820a9edeaf0073f4107e_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ae111198d92df820a9edeaf0073f4107e_cgraph" id="anamespacemod__fld_ae111198d92df820a9edeaf0073f4107e_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="5,27,147,69"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="235,5,309,32"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="195,57,349,98"/>
</map>
</div>

</div>
</div>
<a id="a5c3cb192d4ff204d751bbabdc46570a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c3cb192d4ff204d751bbabdc46570a3">&#9670;&nbsp;</a></span>ddpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::ddpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate second derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01406">1406</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a252186780c5a68f744c09e61199eed1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a252186780c5a68f744c09e61199eed1c">&#9670;&nbsp;</a></span>diffuse_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::diffuse_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dtfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psa</td><td>Advance psa=psb+dtfactor*qdt*F_im(psa) </td></tr>
  </table>
  </dd>
</dl>
<p>Set diffusion timestep, add previous timestep if mg did not converge:</p>
<p>replace call set_rhs(mg, -1/dt, 0.0_dp)</p>
<p>Reset dt_diff when diffusion worked out</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00721">721</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a252186780c5a68f744c09e61199eed1c_cgraph.png" border="0" usemap="#anamespacemod__fld_a252186780c5a68f744c09e61199eed1c_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a252186780c5a68f744c09e61199eed1c_cgraph" id="anamespacemod__fld_a252186780c5a68f744c09e61199eed1c_cgraph">
<area shape="rect" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="5,100,147,141"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#adba5ed257a7b740fc0152041faa8f490" title="Copy from multigrid tree with one layer of ghost cells. Corner ghost cells are not used/set." alt="" coords="197,5,379,47"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#a6844c00572acb078d62136c84a07a4c8" title="Copy a variable to the multigrid tree, including a layer of ghost cells." alt="" coords="199,71,377,112"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="251,137,325,163"/>
<area shape="rect" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00" title=" " alt="" coords="195,187,381,214"/>
</map>
</div>

</div>
</div>
<a id="ac956fe2dd223e2039a113a0d0c2991d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac956fe2dd223e2039a113a0d0c2991d0">&#9670;&nbsp;</a></span>dpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::dpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate first derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01395">1395</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a03cf61257d6dd23014c08b06329d2b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03cf61257d6dd23014c08b06329d2b2c">&#9670;&nbsp;</a></span>energy_interaction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::energy_interaction </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implicit scheme. These sourceterms are applied using the root-finding of a 4th order polynomial This routine loops over every cell in the domain and computes the coefficients of the polynomials in every cell. </p>
<p>e_gas is the INTERNAL ENERGY without KINETIC ENERGY</p>
<p>Calculate coefficients for polynomial</p>
<p>Loop over every cell for rootfinding method</p>
<p>advance E_rad</p>
<p>new w = w + dt f(wCT) e_gas,E_rad = wCT + dt f(wCT) dt f(wCT) = e_gas,E_rad - wCT new w = w + e_gas,E_rad - wCT</p>
<p>WAIT A SECOND?! DOES THIS EVEN WORK WITH THESE KIND OF IMPLICIT METHODS? NOT QUITE SURE TO BE HONEST IS IT POSSIBLE TO SHUT DOWN SOURCE SPLITTING FOR JUST THIS TERM? FIX BY PERFORMING Energy_interaction on (w,w,...)</p>
<p>Update gas-energy in w, internal + kinetic</p>
<p>Beginning of module substracted wCT Ekin So now add wCT Ekin</p>
<p>Update rad-energy in w</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01118">1118</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a03cf61257d6dd23014c08b06329d2b2c_cgraph.png" border="0" usemap="#anamespacemod__fld_a03cf61257d6dd23014c08b06329d2b2c_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a03cf61257d6dd23014c08b06329d2b2c_cgraph" id="anamespacemod__fld_a03cf61257d6dd23014c08b06329d2b2c_cgraph">
<area shape="rect" title="This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implic..." alt="" coords="5,44,209,71"/>
<area shape="rect" href="namespacemod__fld.html#ae111198d92df820a9edeaf0073f4107e" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="719,47,860,89"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="908,55,983,81"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="487,145,668,172"/>
<area shape="rect" href="namespacemod__fld.html#a6b4aeeffe4c5918e0bd2a8858efea215" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="257,44,436,71"/>
<area shape="rect" href="namespacemod__fld.html#afd1668b588f8b86ac4d95d46ee2ecd1f" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="484,44,671,71"/>
</map>
</div>

</div>
</div>
<a id="ade46e76ac547d6c1f1c27e324f94af46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade46e76ac547d6c1f1c27e324f94af46">&#9670;&nbsp;</a></span>evaluate_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::evaluate_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00962">962</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ade46e76ac547d6c1f1c27e324f94af46_cgraph.png" border="0" usemap="#anamespacemod__fld_ade46e76ac547d6c1f1c27e324f94af46_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ade46e76ac547d6c1f1c27e324f94af46_cgraph" id="anamespacemod__fld_ade46e76ac547d6c1f1c27e324f94af46_cgraph">
<area shape="rect" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="5,71,160,112"/>
<area shape="rect" href="namespacemod__ghostcells__update.html#abc70508ceb326fb28166d751e5de31fc" title="do update ghost cells of all blocks including physical boundaries" alt="" coords="213,5,389,47"/>
<area shape="rect" href="namespacemod__fld.html#a72319afced2bbf19fa978c888ca00e45" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="220,71,383,112"/>
<area shape="rect" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00" title=" " alt="" coords="208,137,395,163"/>
</map>
</div>

</div>
</div>
<a id="ae0cd21f12833bcf8f7c05412c7bc46a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0cd21f12833bcf8f7c05412c7bc46a6">&#9670;&nbsp;</a></span>fld_get_diffcoef_central()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_get_diffcoef_central </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates cell-centered diffusion coefficient to be used in multigrid. </p>
<p>calculate diffusion coefficient</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01019">1019</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ae0cd21f12833bcf8f7c05412c7bc46a6_cgraph.png" border="0" usemap="#anamespacemod__fld_ae0cd21f12833bcf8f7c05412c7bc46a6_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ae0cd21f12833bcf8f7c05412c7bc46a6_cgraph" id="anamespacemod__fld_ae0cd21f12833bcf8f7c05412c7bc46a6_cgraph">
<area shape="rect" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="236,5,436,32"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="484,31,665,57"/>
<area shape="rect" href="namespacemod__fld.html#a274a5ee4b7ee438bc3a3f538359cd7b3" title="Use running average on Diffusion coefficient." alt="" coords="259,107,413,149"/>
</map>
</div>

</div>
</div>
<a id="a4e71ba3e0db60cc1ef67b2229621677e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e71ba3e0db60cc1ef67b2229621677e">&#9670;&nbsp;</a></span>fld_get_eddington()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_get_eddington </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>eddington_tensor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Eddington-tensor Stores Eddington-tensor in w-array. </p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate radiation pressure P = (lambda + lambda^2 R^2)*E</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00621">621</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a4e71ba3e0db60cc1ef67b2229621677e_cgraph.png" border="0" usemap="#anamespacemod__fld_a4e71ba3e0db60cc1ef67b2229621677e_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a4e71ba3e0db60cc1ef67b2229621677e_cgraph" id="anamespacemod__fld_a4e71ba3e0db60cc1ef67b2229621677e_cgraph">
<area shape="rect" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="5,31,204,57"/>
<area shape="rect" href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="252,5,452,32"/>
<area shape="rect" href="namespacemod__fld.html#a10a1413ec8612a5dd9a5b09eb68919a7" title="Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S..." alt="" coords="500,31,644,57"/>
</map>
</div>

</div>
</div>
<a id="af3ff35a06221274a626b1fbf804c1915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3ff35a06221274a626b1fbf804c1915">&#9670;&nbsp;</a></span>fld_get_fluxlimiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_fluxlimiter </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path. </p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Levermore and Pomraning: lambda = (2 + R)/(6 + 3R + R^2)</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Levermore and Pomraning: lambda = 1/R(coth(R)-1/R)</p>
<p>WHAT HAPPENS WHEN R=0 (full diffusion) =&gt; 1/R = NAN =&gt; dtanh(1/R) =????</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Minerbo:</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00427">427</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_af3ff35a06221274a626b1fbf804c1915_cgraph.png" border="0" usemap="#anamespacemod__fld_af3ff35a06221274a626b1fbf804c1915_cgraph" alt=""/></div>
<map name="anamespacemod__fld_af3ff35a06221274a626b1fbf804c1915_cgraph" id="anamespacemod__fld_af3ff35a06221274a626b1fbf804c1915_cgraph">
<area shape="rect" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="5,56,205,83"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="253,5,435,32"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="483,56,557,83"/>
<area shape="rect" href="namespacemod__fld.html#a10a1413ec8612a5dd9a5b09eb68919a7" title="Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S..." alt="" coords="272,107,416,133"/>
</map>
</div>

</div>
</div>
<a id="ac9f2df78330406043ccd51c94710a9f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f2df78330406043ccd51c94710a9f7">&#9670;&nbsp;</a></span>fld_get_opacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_opacity </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in opacities from opal tables.">mod_opal_opacity</a>. </p>
<p>Take lower value of rho in domain</p>
<p>Opacity bump</p>
<p>Take lower value of rho in domain</p>
<p>Hard limit on kappa</p>
<p>Limit kappa through T</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00342">342</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ac9f2df78330406043ccd51c94710a9f7_cgraph.png" border="0" usemap="#anamespacemod__fld_ac9f2df78330406043ccd51c94710a9f7_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ac9f2df78330406043ccd51c94710a9f7_cgraph" id="anamespacemod__fld_ac9f2df78330406043ccd51c94710a9f7_cgraph">
<area shape="rect" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="5,35,187,61"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="281,5,356,32"/>
<area shape="rect" href="namespacemod__opal__opacity.html#a8a6b7571280893a4d5716c993e03c910" title="This subroutine calculates the opacity for a given temperature&#45;density structure. The opacities are r..." alt="" coords="235,57,403,98"/>
</map>
</div>

</div>
</div>
<a id="a5fa4eeaef264e95fa1ce26c4e170adce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa4eeaef264e95fa1ce26c4e170adce">&#9670;&nbsp;</a></span>fld_get_radflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_radflux </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s, 1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_flux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Flux stores radiation flux in w-array. </p>
<p>Calculate the Flux using the fld closure relation F = -c*lambda/(kappa*rho) *grad E</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00588">588</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a5fa4eeaef264e95fa1ce26c4e170adce_cgraph.png" border="0" usemap="#anamespacemod__fld_a5fa4eeaef264e95fa1ce26c4e170adce_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a5fa4eeaef264e95fa1ce26c4e170adce_cgraph" id="anamespacemod__fld_a5fa4eeaef264e95fa1ce26c4e170adce_cgraph">
<area shape="rect" title="Calculate Radiation Flux stores radiation flux in w&#45;array." alt="" coords="5,31,184,57"/>
<area shape="rect" href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="232,31,432,57"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="480,5,661,32"/>
<area shape="rect" href="namespacemod__fld.html#a10a1413ec8612a5dd9a5b09eb68919a7" title="Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S..." alt="" coords="499,68,643,95"/>
</map>
</div>

</div>
</div>
<a id="ab6de94c421ca190d4cc8fbd98890df60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6de94c421ca190d4cc8fbd98890df60">&#9670;&nbsp;</a></span>fld_get_radpress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_radpress </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Pressure Returns Radiation Pressure as tensor. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00695">695</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ab6de94c421ca190d4cc8fbd98890df60_cgraph.png" border="0" usemap="#anamespacemod__fld_ab6de94c421ca190d4cc8fbd98890df60_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ab6de94c421ca190d4cc8fbd98890df60_cgraph" id="anamespacemod__fld_ab6de94c421ca190d4cc8fbd98890df60_cgraph">
<area shape="rect" title="Calculate Radiation Pressure Returns Radiation Pressure as tensor." alt="" coords="5,5,195,32"/>
<area shape="rect" href="namespacemod__fld.html#a4e71ba3e0db60cc1ef67b2229621677e" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="243,5,441,32"/>
</map>
</div>

</div>
</div>
<a id="ac391ad2256509da6e71540cbe251c37e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac391ad2256509da6e71540cbe251c37e">&#9670;&nbsp;</a></span>fld_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_init </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>He_abundance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>rhd_radiation_diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>rhd_gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ... </p>
<p>read par files</p>
<p>Set lineforce opacities as variable</p>
<p>Need mean molecular weight</p>
<p>set rhd_gamma</p>
<p>Read in opacity table if necesary</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00116">116</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ac391ad2256509da6e71540cbe251c37e_cgraph.png" border="0" usemap="#anamespacemod__fld_ac391ad2256509da6e71540cbe251c37e_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ac391ad2256509da6e71540cbe251c37e_cgraph" id="anamespacemod__fld_ac391ad2256509da6e71540cbe251c37e_cgraph">
<area shape="rect" title="Initialising FLD&#45;module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variable..." alt="" coords="5,137,132,163"/>
<area shape="rect" href="namespacemod__fld.html#a252186780c5a68f744c09e61199eed1c" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="211,5,353,47"/>
<area shape="rect" href="namespacemod__fld.html#ade46e76ac547d6c1f1c27e324f94af46" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="205,71,359,112"/>
<area shape="rect" href="namespacemod__fld.html#a2fab030adfe37e60459f2f6c8140f091" title="public methods these are called in mod_rhd_phys" alt="" coords="187,137,377,163"/>
<area shape="rect" href="namespacemod__opal__opacity.html#ac42d05a1ff082e78575d8b017da6010b" title="This routine is called when the fld radiation module is initialised. Here, the tables for different H..." alt="" coords="180,187,384,214"/>
<area shape="rect" href="namespacemod__variables.html#a924c3b2f4e13f6f6432de212ac790966" title="Set extra variable in w, which is not advected and has no boundary conditions. This has to be done af..." alt="" coords="209,239,355,280"/>
</map>
</div>

</div>
</div>
<a id="a2fab030adfe37e60459f2f6c8140f091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fab030adfe37e60459f2f6c8140f091">&#9670;&nbsp;</a></span>fld_params_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_params_read </td>
          <td>(</td>
          <td class="paramtype">character(len=*), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>files</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a> </p>
<p>Reading in fld-list parameters from .par file </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00089">89</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a2e37bb8ef924c82af5fc1d1263c9415a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e37bb8ef924c82af5fc1d1263c9415a">&#9670;&nbsp;</a></span>fld_radforce_get_dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_radforce_get_dt </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>dtnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00287">287</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a2e37bb8ef924c82af5fc1d1263c9415a_cgraph.png" border="0" usemap="#anamespacemod__fld_a2e37bb8ef924c82af5fc1d1263c9415a_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a2e37bb8ef924c82af5fc1d1263c9415a_cgraph" id="anamespacemod__fld_a2e37bb8ef924c82af5fc1d1263c9415a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,47"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="439,13,620,39"/>
<area shape="rect" href="namespacemod__fld.html#a5fa4eeaef264e95fa1ce26c4e170adce" title="Calculate Radiation Flux stores radiation flux in w&#45;array." alt="" coords="212,38,391,65"/>
</map>
</div>

</div>
</div>
<a id="a274a5ee4b7ee438bc3a3f538359cd7b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274a5ee4b7ee438bc3a3f538359cd7b3">&#9670;&nbsp;</a></span>fld_smooth_diffcoef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_smooth_diffcoef </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use running average on Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01076">1076</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a274a5ee4b7ee438bc3a3f538359cd7b3_cgraph.png" border="0" usemap="#anamespacemod__fld_a274a5ee4b7ee438bc3a3f538359cd7b3_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a274a5ee4b7ee438bc3a3f538359cd7b3_cgraph" id="anamespacemod__fld_a274a5ee4b7ee438bc3a3f538359cd7b3_cgraph">
<area shape="rect" title="Use running average on Diffusion coefficient." alt="" coords="5,5,160,47"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="208,13,283,39"/>
</map>
</div>

</div>
</div>
<a id="ad7aa7efd71997039f66577052264a90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7aa7efd71997039f66577052264a90b">&#9670;&nbsp;</a></span>get_fld_energy_interact()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::get_fld_energy_interact </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the energy exchange between gas and radiation </p>
<p>Calculate and add sourceterms</p>
<p>Add energy sourceterms</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00317">317</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ad7aa7efd71997039f66577052264a90b_cgraph.png" border="0" usemap="#anamespacemod__fld_ad7aa7efd71997039f66577052264a90b_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ad7aa7efd71997039f66577052264a90b_cgraph" id="anamespacemod__fld_ad7aa7efd71997039f66577052264a90b_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles th..." alt="" coords="5,5,184,47"/>
<area shape="rect" href="namespacemod__fld.html#a03cf61257d6dd23014c08b06329d2b2c" title="This subroutine calculates the radiation heating, radiation cooling and photon tiring using an implic..." alt="" coords="232,13,436,39"/>
</map>
</div>

</div>
</div>
<a id="a8b296a7d3fd6af5af21981633281db6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b296a7d3fd6af5af21981633281db6f">&#9670;&nbsp;</a></span>get_fld_rad_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::get_fld_rad_force </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force </p>
<p>Calculate and add sourceterms</p>
<p>Radiation force = kappa*rho/c *Flux = lambda gradE</p>
<p>Momentum equation source term</p>
<p>Energy equation source term (kinetic energy)</p>
<p>Photon tiring calculate tensor div_v !$OMP PARALLEL DO</p>
<p>!$OMP END PARALLEL DO</p>
<p>VARIABLE NAMES DIV ARE ACTUALLY GRADIENTS</p>
<p>eq 34 Turner and stone (Only 2D)</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00178">178</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a8b296a7d3fd6af5af21981633281db6f_cgraph.png" border="0" usemap="#anamespacemod__fld_a8b296a7d3fd6af5af21981633281db6f_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a8b296a7d3fd6af5af21981633281db6f_cgraph" id="anamespacemod__fld_a8b296a7d3fd6af5af21981633281db6f_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles th..." alt="" coords="5,75,160,116"/>
<area shape="rect" href="namespacemod__fld.html#a4e71ba3e0db60cc1ef67b2229621677e" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="208,32,407,58"/>
<area shape="rect" href="namespacemod__fld.html#af3ff35a06221274a626b1fbf804c1915" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="455,32,655,58"/>
<area shape="rect" href="namespacemod__fld.html#ac9f2df78330406043ccd51c94710a9f7" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="703,82,884,109"/>
<area shape="rect" href="namespacemod__fld.html#a5fa4eeaef264e95fa1ce26c4e170adce" title="Calculate Radiation Flux stores radiation flux in w&#45;array." alt="" coords="218,82,397,109"/>
<area shape="rect" href="namespacemod__geometry.html#a92ec4e2c8ae00a42bf5bf2c1ce3a26c4" title="Calculate gradient of a scalar q within ixL in direction idir." alt="" coords="216,184,399,210"/>
</map>
</div>

</div>
</div>
<a id="a10a1413ec8612a5dd9a5b09eb68919a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10a1413ec8612a5dd9a5b09eb68919a7">&#9670;&nbsp;</a></span>gradiento()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::gradiento </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>gradq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S), NOT gradq(ixI^S) </p>
<p>Using higher order derivatives with wider stencil according to: <a href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">https://en.wikipedia.org/wiki/Finite_difference_coefficient</a></p>
<p>coef 2/3</p>
<p>coef -1/12</p>
<p>divide by dx</p>
<p>coef 3/4</p>
<p>coef -3/20</p>
<p>coef 1/60</p>
<p>divide by dx</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01418">1418</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a10a1413ec8612a5dd9a5b09eb68919a7_cgraph.png" border="0" usemap="#anamespacemod__fld_a10a1413ec8612a5dd9a5b09eb68919a7_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a10a1413ec8612a5dd9a5b09eb68919a7_cgraph" id="anamespacemod__fld_a10a1413ec8612a5dd9a5b09eb68919a7_cgraph">
<area shape="rect" title="Calculate gradient of a scalar q within ixL in direction idir difference with gradient is gradq(ixO^S..." alt="" coords="5,5,149,32"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="197,5,272,32"/>
</map>
</div>

</div>
</div>
<a id="a6b4aeeffe4c5918e0bd2a8858efea215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b4aeeffe4c5918e0bd2a8858efea215">&#9670;&nbsp;</a></span>halley_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::halley_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>E_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Halley method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01347">1347</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a6b4aeeffe4c5918e0bd2a8858efea215_cgraph.png" border="0" usemap="#anamespacemod__fld_a6b4aeeffe4c5918e0bd2a8858efea215_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a6b4aeeffe4c5918e0bd2a8858efea215_cgraph" id="anamespacemod__fld_a6b4aeeffe4c5918e0bd2a8858efea215_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="5,97,184,123"/>
<area shape="rect" href="namespacemod__fld.html#a5c3cb192d4ff204d751bbabdc46570a3" title="Evaluate second derivative of polynomial at argument e_gas." alt="" coords="240,5,411,47"/>
<area shape="rect" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="467,73,629,115"/>
<area shape="rect" href="namespacemod__fld.html#afd1668b588f8b86ac4d95d46ee2ecd1f" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="232,122,419,149"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="471,148,625,189"/>
</map>
</div>

</div>
</div>
<a id="afd1668b588f8b86ac4d95d46ee2ecd1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1668b588f8b86ac4d95d46ee2ecd1f">&#9670;&nbsp;</a></span>newton_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::newton_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>E_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Newton-Ralphson method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01312">1312</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_afd1668b588f8b86ac4d95d46ee2ecd1f_cgraph.png" border="0" usemap="#anamespacemod__fld_afd1668b588f8b86ac4d95d46ee2ecd1f_cgraph" alt=""/></div>
<map name="anamespacemod__fld_afd1668b588f8b86ac4d95d46ee2ecd1f_cgraph" id="anamespacemod__fld_afd1668b588f8b86ac4d95d46ee2ecd1f_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="5,71,192,98"/>
<area shape="rect" href="namespacemod__fld.html#ae111198d92df820a9edeaf0073f4107e" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="251,5,392,47"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="451,35,605,76"/>
<area shape="rect" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="240,123,403,164"/>
</map>
</div>

</div>
</div>
<a id="a8ec89cf1950c713250b72d34680df7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec89cf1950c713250b72d34680df7c0">&#9670;&nbsp;</a></span>polynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::polynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01384">1384</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a72319afced2bbf19fa978c888ca00e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72319afced2bbf19fa978c888ca00e45">&#9670;&nbsp;</a></span>put_diffterm_onegrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::put_diffterm_onegrid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00990">990</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a38e6e06ef18024f6865cadb7aab2aa00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38e6e06ef18024f6865cadb7aab2aa00">&#9670;&nbsp;</a></span>update_diffcoeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::update_diffcoeff </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l01054">1054</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph.png" border="0" usemap="#anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph" id="anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,192,39"/>
<area shape="rect" href="namespacemod__fld.html#ae0cd21f12833bcf8f7c05412c7bc46a6" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="240,5,423,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae865a7dd858718239c52ff826e35bedd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae865a7dd858718239c52ff826e35bedd">&#9670;&nbsp;</a></span>diff_coef_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::diff_coef_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take running average for Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00049">49</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="af77876e7c2f8261a6c8a31f2d8659f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af77876e7c2f8261a6c8a31f2d8659f05">&#9670;&nbsp;</a></span>diff_crit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::diff_crit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number for splitting the diffusion module. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00030">30</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a31f9f6143b297d23f4fc26012e98cf32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f9f6143b297d23f4fc26012e98cf32">&#9670;&nbsp;</a></span>diffcrash_resume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::diffcrash_resume = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume run when multigrid returns error. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00060">60</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="af736b4330bbe9b53d2a6effc9d2e1730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af736b4330bbe9b53d2a6effc9d2e1730">&#9670;&nbsp;</a></span>dt_diff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision mod_fld::dt_diff = 0.d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>running timestep for diffusion solver, initialised as zero </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00069">69</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a1baf3c3f8c4e68834dfedd8f7362663a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1baf3c3f8c4e68834dfedd8f7362663a">&#9670;&nbsp;</a></span>fld_bisect_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_bisect_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00024">24</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a856d86414a9d106690e2f9f33976b705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a856d86414a9d106690e2f9f33976b705">&#9670;&nbsp;</a></span>fld_diff_scheme</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_diff_scheme = 'mg'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to solve diffusion part. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00043">43</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a23d86935a2e8d953c3ef8e5270eac0ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23d86935a2e8d953c3ef8e5270eac0ff">&#9670;&nbsp;</a></span>fld_diff_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_diff_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for adi method for radiative Energy diffusion. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00027">27</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="aa33a1dcdba3d105c08f8da30c1561101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33a1dcdba3d105c08f8da30c1561101">&#9670;&nbsp;</a></span>fld_eint_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::fld_eint_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>source split for energy interact and radforce: </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00013">13</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a6653738fcac09ac966028771a78e4d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6653738fcac09ac966028771a78e4d52">&#9670;&nbsp;</a></span>fld_fluxlimiter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=16) mod_fld::fld_fluxlimiter = 'Pomraning'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Diffusion limit lambda = 0.33. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00037">37</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ab52da06b97cae443e859349f1c04b5fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab52da06b97cae443e859349f1c04b5fa">&#9670;&nbsp;</a></span>fld_interaction_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_interaction_method = 'Halley'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to find the root for the energy interaction polynomial. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00046">46</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a833746bb6e5dbd734a00ec94b4669b1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a833746bb6e5dbd734a00ec94b4669b1b">&#9670;&nbsp;</a></span>fld_kappa0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_kappa0 = 0.34d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opacity per unit of unit_density. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00017">17</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a1b3ea3f3889855c64aeb21fd813bb7d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b3ea3f3889855c64aeb21fd813bb7d3">&#9670;&nbsp;</a></span>fld_mu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_mu = 0.6d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>mean particle mass </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00020">20</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a4717a388644e4cb1fe9b0e27860d2007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4717a388644e4cb1fe9b0e27860d2007">&#9670;&nbsp;</a></span>fld_opacity_law</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_opacity_law = 'const'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use constant Opacity? </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00033">33</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ae08359f6c5f97d728f29a27255f244fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08359f6c5f97d728f29a27255f244fe">&#9670;&nbsp;</a></span>fld_opal_table</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=6) mod_fld::fld_opal_table = 'Y09800'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00034">34</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="abf910fa47bd4269dd49980e2f51efc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf910fa47bd4269dd49980e2f51efc46">&#9670;&nbsp;</a></span>fld_radforce_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::fld_radforce_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00014">14</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ae25919ae30d513d31baef1185e5f3088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae25919ae30d513d31baef1185e5f3088">&#9670;&nbsp;</a></span>flux_lim_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::flux_lim_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take a running average over the fluxlimiter. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00053">53</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ada3e212a237e18cb9a3166799117c6fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada3e212a237e18cb9a3166799117c6fa">&#9670;&nbsp;</a></span>i_diff_mg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::i_diff_mg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>diffusion coefficient for multigrid method </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00040">40</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a3b3c400ea76d816d13544c77938e78e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b3c400ea76d816d13544c77938e78e9">&#9670;&nbsp;</a></span>i_opf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable, public mod_fld::i_opf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for Flux weighted opacities. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00063">63</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a8adb0b2d41f252cf64683544a14b47ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adb0b2d41f252cf64683544a14b47ef">&#9670;&nbsp;</a></span>lineforce_opacities</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::lineforce_opacities = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use or dont use lineforce opacities. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00057">57</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a76ef494608b155112c93ba41930b05b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ef494608b155112c93ba41930b05b7">&#9670;&nbsp;</a></span>size_d_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::size_d_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00050">50</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a7471e33d67b7dfb4f836eb7b8df8ec0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7471e33d67b7dfb4f836eb7b8df8ec0f">&#9670;&nbsp;</a></span>size_l_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::size_l_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00054">54</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
