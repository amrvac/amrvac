<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: mod_fld Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPI-AMRVAC<span id="projectnumber">&#160;3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mod_fld Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Nicolas Moens Module for including flux limited diffusion (FLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information.  
<a href="namespacemod__fld.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2fab030adfe37e60459f2f6c8140f091" id="r_a2fab030adfe37e60459f2f6c8140f091"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a2fab030adfe37e60459f2f6c8140f091">fld_params_read</a> (files)</td></tr>
<tr class="memdesc:a2fab030adfe37e60459f2f6c8140f091"><td class="mdescLeft">&#160;</td><td class="mdescRight">public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a>  <br /></td></tr>
<tr class="separator:a2fab030adfe37e60459f2f6c8140f091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644bcbf423e600ca2e0019f55394ca3d" id="r_a644bcbf423e600ca2e0019f55394ca3d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a644bcbf423e600ca2e0019f55394ca3d">fld_init</a> (he_abundance, radiation_diffusion, energy_interact, r_gamma)</td></tr>
<tr class="memdesc:a644bcbf423e600ca2e0019f55394ca3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ...  <br /></td></tr>
<tr class="separator:a644bcbf423e600ca2e0019f55394ca3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b928697cae65a802cc7721063d39b65" id="r_a5b928697cae65a802cc7721063d39b65"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a5b928697cae65a802cc7721063d39b65">get_fld_rad_force</a> (qdt, ixil, ixol, wct, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:a5b928697cae65a802cc7721063d39b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force  <br /></td></tr>
<tr class="separator:a5b928697cae65a802cc7721063d39b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6c22947bcd2e35eb73047df6d59ce9c" id="r_ad6c22947bcd2e35eb73047df6d59ce9c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ad6c22947bcd2e35eb73047df6d59ce9c">fld_radforce_get_dt</a> (w, ixil, ixol, dtnew, dxd, x)</td></tr>
<tr class="separator:ad6c22947bcd2e35eb73047df6d59ce9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078e9ee0bdeb4d94763a97c2f009d9fd" id="r_a078e9ee0bdeb4d94763a97c2f009d9fd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a078e9ee0bdeb4d94763a97c2f009d9fd">fld_get_opacity</a> (w, x, ixil, ixol, fld_kappa)</td></tr>
<tr class="memdesc:a078e9ee0bdeb4d94763a97c2f009d9fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in Rosseland-mean opacities from OPAL tables. Table opacity values are given in bas...">mod_opal_opacity</a>.  <br /></td></tr>
<tr class="separator:a078e9ee0bdeb4d94763a97c2f009d9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e9e6eb8603ea5f429c6fab5477f778" id="r_a84e9e6eb8603ea5f429c6fab5477f778"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778">fld_get_fluxlimiter</a> (w, x, ixil, ixol, fld_lambda, fld_r, nth)</td></tr>
<tr class="memdesc:a84e9e6eb8603ea5f429c6fab5477f778"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path.  <br /></td></tr>
<tr class="separator:a84e9e6eb8603ea5f429c6fab5477f778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54bad97f6a46e7c89cee5698a217f46" id="r_ac54bad97f6a46e7c89cee5698a217f46"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ac54bad97f6a46e7c89cee5698a217f46">fld_get_radflux</a> (w, x, ixil, ixol, rad_flux, nth)</td></tr>
<tr class="memdesc:ac54bad97f6a46e7c89cee5698a217f46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Flux stores radiation flux in w-array.  <br /></td></tr>
<tr class="separator:ac54bad97f6a46e7c89cee5698a217f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b0473cde5cb134920cc7505650e13b" id="r_ae4b0473cde5cb134920cc7505650e13b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae4b0473cde5cb134920cc7505650e13b">fld_get_eddington</a> (w, x, ixil, ixol, eddington_tensor, nth)</td></tr>
<tr class="memdesc:ae4b0473cde5cb134920cc7505650e13b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Eddington-tensor Stores Eddington-tensor in w-array.  <br /></td></tr>
<tr class="separator:ae4b0473cde5cb134920cc7505650e13b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61306bd3278dc4b63570d46d7a4b654c" id="r_a61306bd3278dc4b63570d46d7a4b654c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a61306bd3278dc4b63570d46d7a4b654c">fld_get_radpress</a> (w, x, ixil, ixol, rad_pressure, nth)</td></tr>
<tr class="memdesc:a61306bd3278dc4b63570d46d7a4b654c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Radiation Pressure Returns Radiation Pressure as tensor.  <br /></td></tr>
<tr class="separator:a61306bd3278dc4b63570d46d7a4b654c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af84fc6e1d9d991a23def9a1f3e304f80" id="r_af84fc6e1d9d991a23def9a1f3e304f80"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af84fc6e1d9d991a23def9a1f3e304f80">fld_implicit_update</a> (dtfactor, qdt, qtc, psa, psb)</td></tr>
<tr class="separator:af84fc6e1d9d991a23def9a1f3e304f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf63912c9ee0d82df2f55f5522e35a5" id="r_a1bf63912c9ee0d82df2f55f5522e35a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a1bf63912c9ee0d82df2f55f5522e35a5">energy_interaction</a> (w, x, ixil, ixol, dtfactor, qdt)</td></tr>
<tr class="memdesc:a1bf63912c9ee0d82df2f55f5522e35a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy interaction and photon tiring.  <br /></td></tr>
<tr class="separator:a1bf63912c9ee0d82df2f55f5522e35a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace01cd630d220166e1a301dac3c89008" id="r_ace01cd630d220166e1a301dac3c89008"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ace01cd630d220166e1a301dac3c89008">diffuse_e_rad_mg</a> (dtfactor, qdt, qtc, psa, psb)</td></tr>
<tr class="memdesc:ace01cd630d220166e1a301dac3c89008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library.  <br /></td></tr>
<tr class="separator:ace01cd630d220166e1a301dac3c89008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb47c317d9d55a7e10ff327d7967a5e" id="r_a5fb47c317d9d55a7e10ff327d7967a5e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a5fb47c317d9d55a7e10ff327d7967a5e">evaluate_e_rad_mg</a> (qtc, psa)</td></tr>
<tr class="memdesc:a5fb47c317d9d55a7e10ff327d7967a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <br /></td></tr>
<tr class="separator:a5fb47c317d9d55a7e10ff327d7967a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02980c6a45de45987bb5b18fc223b1aa" id="r_a02980c6a45de45987bb5b18fc223b1aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a02980c6a45de45987bb5b18fc223b1aa">put_diffterm_onegrid</a> (ixil, ixol, w)</td></tr>
<tr class="memdesc:a02980c6a45de45987bb5b18fc223b1aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">inplace update of psa==&gt;F_im(psa)  <br /></td></tr>
<tr class="separator:a02980c6a45de45987bb5b18fc223b1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7655ed0734cd3f508292a2549b19db7b" id="r_a7655ed0734cd3f508292a2549b19db7b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a7655ed0734cd3f508292a2549b19db7b">fld_get_diffcoef_central</a> (w, wct, x, ixil, ixol)</td></tr>
<tr class="memdesc:a7655ed0734cd3f508292a2549b19db7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates cell-centered diffusion coefficient to be used in multigrid.  <br /></td></tr>
<tr class="separator:a7655ed0734cd3f508292a2549b19db7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e6e06ef18024f6865cadb7aab2aa00" id="r_a38e6e06ef18024f6865cadb7aab2aa00"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00">update_diffcoeff</a> (psa)</td></tr>
<tr class="separator:a38e6e06ef18024f6865cadb7aab2aa00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3f250fedcc3f1382b2d77a70b0313d" id="r_aca3f250fedcc3f1382b2d77a70b0313d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#aca3f250fedcc3f1382b2d77a70b0313d">fld_smooth_diffcoef</a> (w, ixil, ixol)</td></tr>
<tr class="memdesc:aca3f250fedcc3f1382b2d77a70b0313d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use running average on Diffusion coefficient.  <br /></td></tr>
<tr class="separator:aca3f250fedcc3f1382b2d77a70b0313d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790ae55dace4c7cae8c5a7091943ad65" id="r_a790ae55dace4c7cae8c5a7091943ad65"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a790ae55dace4c7cae8c5a7091943ad65">bisection_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:a790ae55dace4c7cae8c5a7091943ad65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the bisection method.  <br /></td></tr>
<tr class="separator:a790ae55dace4c7cae8c5a7091943ad65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab77a233aa68b193411dcd4d51348ead7" id="r_ab77a233aa68b193411dcd4d51348ead7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ab77a233aa68b193411dcd4d51348ead7">newton_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:ab77a233aa68b193411dcd4d51348ead7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Newton-Ralphson method.  <br /></td></tr>
<tr class="separator:ab77a233aa68b193411dcd4d51348ead7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae00cd585d53d7f497426872a6b7a36c" id="r_aae00cd585d53d7f497426872a6b7a36c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#aae00cd585d53d7f497426872a6b7a36c">halley_method</a> (e_gas, e_rad, c0, c1)</td></tr>
<tr class="memdesc:aae00cd585d53d7f497426872a6b7a36c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the root of the 4th degree polynomial using the Halley method.  <br /></td></tr>
<tr class="separator:aae00cd585d53d7f497426872a6b7a36c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec89cf1950c713250b72d34680df7c0" id="r_a8ec89cf1950c713250b72d34680df7c0"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0">polynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a8ec89cf1950c713250b72d34680df7c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:a8ec89cf1950c713250b72d34680df7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac956fe2dd223e2039a113a0d0c2991d0" id="r_ac956fe2dd223e2039a113a0d0c2991d0"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0">dpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:ac956fe2dd223e2039a113a0d0c2991d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate first derivative of polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:ac956fe2dd223e2039a113a0d0c2991d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c3cb192d4ff204d751bbabdc46570a3" id="r_a5c3cb192d4ff204d751bbabdc46570a3"><td class="memItemLeft" align="right" valign="top">double precision function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a5c3cb192d4ff204d751bbabdc46570a3">ddpolynomial_bisection</a> (e_gas, c0, c1)</td></tr>
<tr class="memdesc:a5c3cb192d4ff204d751bbabdc46570a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate second derivative of polynomial at argument e_gas.  <br /></td></tr>
<tr class="separator:a5c3cb192d4ff204d751bbabdc46570a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa33a1dcdba3d105c08f8da30c1561101" id="r_aa33a1dcdba3d105c08f8da30c1561101"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#aa33a1dcdba3d105c08f8da30c1561101">fld_eint_split</a> = .false.</td></tr>
<tr class="memdesc:aa33a1dcdba3d105c08f8da30c1561101"><td class="mdescLeft">&#160;</td><td class="mdescRight">source split for energy interact and radforce:  <br /></td></tr>
<tr class="separator:aa33a1dcdba3d105c08f8da30c1561101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf910fa47bd4269dd49980e2f51efc46" id="r_abf910fa47bd4269dd49980e2f51efc46"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#abf910fa47bd4269dd49980e2f51efc46">fld_radforce_split</a> = .false.</td></tr>
<tr class="separator:abf910fa47bd4269dd49980e2f51efc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833746bb6e5dbd734a00ec94b4669b1b" id="r_a833746bb6e5dbd734a00ec94b4669b1b"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a833746bb6e5dbd734a00ec94b4669b1b">fld_kappa0</a> = 0.34d0</td></tr>
<tr class="memdesc:a833746bb6e5dbd734a00ec94b4669b1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opacity per unit of unit_density.  <br /></td></tr>
<tr class="separator:a833746bb6e5dbd734a00ec94b4669b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3ea3f3889855c64aeb21fd813bb7d3" id="r_a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a1b3ea3f3889855c64aeb21fd813bb7d3">fld_mu</a> = 0.6d0</td></tr>
<tr class="memdesc:a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">mean particle mass  <br /></td></tr>
<tr class="separator:a1b3ea3f3889855c64aeb21fd813bb7d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1baf3c3f8c4e68834dfedd8f7362663a" id="r_a1baf3c3f8c4e68834dfedd8f7362663a"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a1baf3c3f8c4e68834dfedd8f7362663a">fld_bisect_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a1baf3c3f8c4e68834dfedd8f7362663a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy.  <br /></td></tr>
<tr class="separator:a1baf3c3f8c4e68834dfedd8f7362663a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23d86935a2e8d953c3ef8e5270eac0ff" id="r_a23d86935a2e8d953c3ef8e5270eac0ff"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a23d86935a2e8d953c3ef8e5270eac0ff">fld_diff_tol</a> = 1.d-4</td></tr>
<tr class="memdesc:a23d86935a2e8d953c3ef8e5270eac0ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance for adi method for radiative Energy diffusion.  <br /></td></tr>
<tr class="separator:a23d86935a2e8d953c3ef8e5270eac0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77876e7c2f8261a6c8a31f2d8659f05" id="r_af77876e7c2f8261a6c8a31f2d8659f05"><td class="memItemLeft" align="right" valign="top">double precision, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af77876e7c2f8261a6c8a31f2d8659f05">diff_crit</a></td></tr>
<tr class="memdesc:af77876e7c2f8261a6c8a31f2d8659f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number for splitting the diffusion module.  <br /></td></tr>
<tr class="separator:af77876e7c2f8261a6c8a31f2d8659f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4717a388644e4cb1fe9b0e27860d2007" id="r_a4717a388644e4cb1fe9b0e27860d2007"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a4717a388644e4cb1fe9b0e27860d2007">fld_opacity_law</a> = 'const'</td></tr>
<tr class="memdesc:a4717a388644e4cb1fe9b0e27860d2007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use constant Opacity?  <br /></td></tr>
<tr class="separator:a4717a388644e4cb1fe9b0e27860d2007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb90faa1f0dbfb0d74e9772a7d00545" id="r_a7cb90faa1f0dbfb0d74e9772a7d00545"><td class="memItemLeft" align="right" valign="top">character(len=50)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a7cb90faa1f0dbfb0d74e9772a7d00545">fld_opal_table</a> = 'Y09800'</td></tr>
<tr class="separator:a7cb90faa1f0dbfb0d74e9772a7d00545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6653738fcac09ac966028771a78e4d52" id="r_a6653738fcac09ac966028771a78e4d52"><td class="memItemLeft" align="right" valign="top">character(len=16)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a6653738fcac09ac966028771a78e4d52">fld_fluxlimiter</a> = 'Pomraning'</td></tr>
<tr class="memdesc:a6653738fcac09ac966028771a78e4d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion limit lambda = 0.33.  <br /></td></tr>
<tr class="separator:a6653738fcac09ac966028771a78e4d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada3e212a237e18cb9a3166799117c6fa" id="r_ada3e212a237e18cb9a3166799117c6fa"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ada3e212a237e18cb9a3166799117c6fa">i_diff_mg</a></td></tr>
<tr class="memdesc:ada3e212a237e18cb9a3166799117c6fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">diffusion coefficient for multigrid method  <br /></td></tr>
<tr class="separator:ada3e212a237e18cb9a3166799117c6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a856d86414a9d106690e2f9f33976b705" id="r_a856d86414a9d106690e2f9f33976b705"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a856d86414a9d106690e2f9f33976b705">fld_diff_scheme</a> = 'mg'</td></tr>
<tr class="memdesc:a856d86414a9d106690e2f9f33976b705"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to solve diffusion part.  <br /></td></tr>
<tr class="separator:a856d86414a9d106690e2f9f33976b705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52da06b97cae443e859349f1c04b5fa" id="r_ab52da06b97cae443e859349f1c04b5fa"><td class="memItemLeft" align="right" valign="top">character(len=8)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ab52da06b97cae443e859349f1c04b5fa">fld_interaction_method</a> = 'Halley'</td></tr>
<tr class="memdesc:ab52da06b97cae443e859349f1c04b5fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Which method to find the root for the energy interaction polynomial.  <br /></td></tr>
<tr class="separator:ab52da06b97cae443e859349f1c04b5fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae865a7dd858718239c52ff826e35bedd" id="r_ae865a7dd858718239c52ff826e35bedd"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae865a7dd858718239c52ff826e35bedd">diff_coef_filter</a> = .false.</td></tr>
<tr class="memdesc:ae865a7dd858718239c52ff826e35bedd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take running average for Diffusion coefficient.  <br /></td></tr>
<tr class="separator:ae865a7dd858718239c52ff826e35bedd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ef494608b155112c93ba41930b05b7" id="r_a76ef494608b155112c93ba41930b05b7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a76ef494608b155112c93ba41930b05b7">size_d_filter</a> = 1</td></tr>
<tr class="separator:a76ef494608b155112c93ba41930b05b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25919ae30d513d31baef1185e5f3088" id="r_ae25919ae30d513d31baef1185e5f3088"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#ae25919ae30d513d31baef1185e5f3088">flux_lim_filter</a> = .false.</td></tr>
<tr class="memdesc:ae25919ae30d513d31baef1185e5f3088"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a running average over the fluxlimiter.  <br /></td></tr>
<tr class="separator:ae25919ae30d513d31baef1185e5f3088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7471e33d67b7dfb4f836eb7b8df8ec0f" id="r_a7471e33d67b7dfb4f836eb7b8df8ec0f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a7471e33d67b7dfb4f836eb7b8df8ec0f">size_l_filter</a> = 1</td></tr>
<tr class="separator:a7471e33d67b7dfb4f836eb7b8df8ec0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adb0b2d41f252cf64683544a14b47ef" id="r_a8adb0b2d41f252cf64683544a14b47ef"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a8adb0b2d41f252cf64683544a14b47ef">lineforce_opacities</a> = .false.</td></tr>
<tr class="memdesc:a8adb0b2d41f252cf64683544a14b47ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use or dont use lineforce opacities.  <br /></td></tr>
<tr class="separator:a8adb0b2d41f252cf64683544a14b47ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f9f6143b297d23f4fc26012e98cf32" id="r_a31f9f6143b297d23f4fc26012e98cf32"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a31f9f6143b297d23f4fc26012e98cf32">diffcrash_resume</a> = .true.</td></tr>
<tr class="memdesc:a31f9f6143b297d23f4fc26012e98cf32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume run when multigrid returns error.  <br /></td></tr>
<tr class="separator:a31f9f6143b297d23f4fc26012e98cf32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3c400ea76d816d13544c77938e78e9" id="r_a3b3c400ea76d816d13544c77938e78e9"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#a3b3c400ea76d816d13544c77938e78e9">i_opf</a></td></tr>
<tr class="memdesc:a3b3c400ea76d816d13544c77938e78e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for Flux weighted opacities.  <br /></td></tr>
<tr class="separator:a3b3c400ea76d816d13544c77938e78e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af736b4330bbe9b53d2a6effc9d2e1730" id="r_af736b4330bbe9b53d2a6effc9d2e1730"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__fld.html#af736b4330bbe9b53d2a6effc9d2e1730">dt_diff</a> = 0.d0</td></tr>
<tr class="memdesc:af736b4330bbe9b53d2a6effc9d2e1730"><td class="mdescLeft">&#160;</td><td class="mdescRight">running timestep for diffusion solver, initialised as zero  <br /></td></tr>
<tr class="separator:af736b4330bbe9b53d2a6effc9d2e1730"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Nicolas Moens Module for including flux limited diffusion (FLD)-approximation in Radiation-hydrodynamics simulations using <a class="el" href="namespacemod__rhd.html" title="Module containing all hydrodynamics.">mod_rhd</a> Based on Turner and stone 2001. See [1]Moens, N., Sundqvist, J. O., El Mellah, I., Poniatowski, L., Teunissen, J., and Keppens, R., “Radiation-hydrodynamics with MPI-AMRVAC . Flux-limited diffusion”, <em>Astronomy and Astrophysics</em>, vol. 657, 2022. doi:10.1051/0004-6361/202141023. For more information. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a790ae55dace4c7cae8c5a7091943ad65" name="a790ae55dace4c7cae8c5a7091943ad65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a790ae55dace4c7cae8c5a7091943ad65">&#9670;&#160;</a></span>bisection_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::bisection_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the bisection method. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00789">789</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a790ae55dace4c7cae8c5a7091943ad65_cgraph.png" border="0" usemap="#anamespacemod__fld_a790ae55dace4c7cae8c5a7091943ad65_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a790ae55dace4c7cae8c5a7091943ad65_cgraph" id="anamespacemod__fld_a790ae55dace4c7cae8c5a7091943ad65_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="5,5,147,45"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="195,5,349,45"/>
<area shape="poly" title=" " alt="" coords="147,23,181,23,181,28,147,28"/>
</map>
</div>

</div>
</div>
<a id="a5c3cb192d4ff204d751bbabdc46570a3" name="a5c3cb192d4ff204d751bbabdc46570a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c3cb192d4ff204d751bbabdc46570a3">&#9670;&#160;</a></span>ddpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::ddpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate second derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00932">932</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ace01cd630d220166e1a301dac3c89008" name="ace01cd630d220166e1a301dac3c89008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace01cd630d220166e1a301dac3c89008">&#9670;&#160;</a></span>diffuse_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::diffuse_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dtfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigrid library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psa</td><td>Advance psa=psb+dtfactor*qdt*F_im(psa) </td></tr>
  </table>
  </dd>
</dl>
<p>Set diffusion timestep, add previous timestep if mg did not converge:</p>
<p>Reset dt_diff when diffusion worked out</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00593">593</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ace01cd630d220166e1a301dac3c89008_cgraph.png" border="0" usemap="#anamespacemod__fld_ace01cd630d220166e1a301dac3c89008_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ace01cd630d220166e1a301dac3c89008_cgraph" id="anamespacemod__fld_ace01cd630d220166e1a301dac3c89008_cgraph">
<area shape="rect" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="5,69,147,109"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#adba5ed257a7b740fc0152041faa8f490" title="Copy from multigrid tree with one layer of ghost cells. Corner ghost cells are not used/set." alt="" coords="197,5,379,45"/>
<area shape="poly" title=" " alt="" coords="142,67,207,47,209,52,144,72"/>
<area shape="rect" href="namespacemod__multigrid__coupling.html#a6844c00572acb078d62136c84a07a4c8" title="Copy a variable to the multigrid tree, including a layer of ghost cells." alt="" coords="199,69,377,109"/>
<area shape="poly" title=" " alt="" coords="147,87,185,87,185,92,147,92"/>
<area shape="rect" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00" title=" " alt="" coords="195,134,381,159"/>
<area shape="poly" title=" " alt="" coords="148,106,228,128,227,133,146,111"/>
</map>
</div>

</div>
</div>
<a id="ac956fe2dd223e2039a113a0d0c2991d0" name="ac956fe2dd223e2039a113a0d0c2991d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac956fe2dd223e2039a113a0d0c2991d0">&#9670;&#160;</a></span>dpolynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::dpolynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate first derivative of polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00922">922</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a1bf63912c9ee0d82df2f55f5522e35a5" name="a1bf63912c9ee0d82df2f55f5522e35a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf63912c9ee0d82df2f55f5522e35a5">&#9670;&#160;</a></span>energy_interaction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::energy_interaction </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dtfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy interaction and photon tiring. </p>
<p>Photon tiring calculate tensor div_v !$OMP PARALLEL DO</p>
<p>!$OMP END PARALLEL DO</p>
<p>VARIABLE NAMES DIV ARE ACTUALLY GRADIENTS</p>
<p>eq 34 Turner and stone (Only 2D)</p>
<p>e_gas is the INTERNAL ENERGY without KINETIC ENERGY</p>
<p>Coefficients for the polynomial in Moens et al. 2022, eq 37.</p>
<p>Loop over every cell for rootfinding method</p>
<p>Update gas-energy in w, internal + kinetic</p>
<p>Beginning of module substracted wCT Ekin So now add wCT Ekin</p>
<p>Update rad-energy in w</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00492">492</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a1bf63912c9ee0d82df2f55f5522e35a5_cgraph.png" border="0" usemap="#anamespacemod__fld_a1bf63912c9ee0d82df2f55f5522e35a5_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a1bf63912c9ee0d82df2f55f5522e35a5_cgraph" id="anamespacemod__fld_a1bf63912c9ee0d82df2f55f5522e35a5_cgraph">
<area shape="rect" title="Energy interaction and photon tiring." alt="" coords="5,124,209,149"/>
<area shape="rect" href="namespacemod__fld.html#a790ae55dace4c7cae8c5a7091943ad65" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="739,91,880,131"/>
<area shape="poly" title=" " alt="" coords="120,122,176,75,214,51,256,33,321,15,376,6,426,3,474,6,571,25,691,58,758,83,756,88,690,63,570,31,473,11,426,8,377,11,322,21,258,38,217,56,179,80,123,126"/>
<area shape="rect" href="namespacemod__fld.html#ae4b0473cde5cb134920cc7505650e13b" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="257,48,456,73"/>
<area shape="poly" title=" " alt="" coords="149,121,300,75,302,80,151,126"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="506,73,689,99"/>
<area shape="poly" title=" " alt="" coords="209,123,492,94,492,99,210,129"/>
<area shape="rect" href="namespacemod__fld.html#a078e9ee0bdeb4d94763a97c2f009d9fd" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="266,149,447,175"/>
<area shape="poly" title=" " alt="" coords="210,144,252,149,252,154,209,150"/>
<area shape="rect" href="namespacemod__fld.html#aae00cd585d53d7f497426872a6b7a36c" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="267,199,446,224"/>
<area shape="poly" title=" " alt="" coords="144,147,258,185,287,193,286,198,257,190,142,152"/>
<area shape="rect" href="namespacemod__fld.html#ab77a233aa68b193411dcd4d51348ead7" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="504,199,691,224"/>
<area shape="poly" title=" " alt="" coords="123,147,179,193,217,217,258,234,295,243,333,247,410,247,481,238,541,225,542,230,482,243,410,252,333,253,294,248,257,239,214,221,176,197,120,151"/>
<area shape="poly" title=" " alt="" coords="456,68,493,72,492,78,456,74"/>
<area shape="poly" title=" " alt="" coords="446,209,490,209,490,214,446,214"/>
<area shape="poly" title=" " alt="" coords="624,196,753,135,755,140,627,201"/>
</map>
</div>

</div>
</div>
<a id="a5fb47c317d9d55a7e10ff327d7967a5e" name="a5fb47c317d9d55a7e10ff327d7967a5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb47c317d9d55a7e10ff327d7967a5e">&#9670;&#160;</a></span>evaluate_e_rad_mg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::evaluate_e_rad_mg </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00676">676</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a5fb47c317d9d55a7e10ff327d7967a5e_cgraph.png" border="0" usemap="#anamespacemod__fld_a5fb47c317d9d55a7e10ff327d7967a5e_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a5fb47c317d9d55a7e10ff327d7967a5e_cgraph" id="anamespacemod__fld_a5fb47c317d9d55a7e10ff327d7967a5e_cgraph">
<area shape="rect" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="5,69,160,109"/>
<area shape="rect" href="namespacemod__ghostcells__update.html#a1b945d19ee179d85b1b4a719a8dfcad6" title="do update ghost cells of all blocks including physical boundaries" alt="" coords="213,5,389,45"/>
<area shape="poly" title=" " alt="" coords="151,67,219,47,220,52,153,72"/>
<area shape="rect" href="namespacemod__fld.html#a02980c6a45de45987bb5b18fc223b1aa" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="220,69,383,109"/>
<area shape="poly" title=" " alt="" coords="160,87,206,87,206,92,160,92"/>
<area shape="rect" href="namespacemod__fld.html#a38e6e06ef18024f6865cadb7aab2aa00" title=" " alt="" coords="208,134,395,159"/>
<area shape="poly" title=" " alt="" coords="160,107,239,128,238,133,159,112"/>
</map>
</div>

</div>
</div>
<a id="a7655ed0734cd3f508292a2549b19db7b" name="a7655ed0734cd3f508292a2549b19db7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7655ed0734cd3f508292a2549b19db7b">&#9670;&#160;</a></span>fld_get_diffcoef_central()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_get_diffcoef_central </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates cell-centered diffusion coefficient to be used in multigrid. </p>
<p>calculate diffusion coefficient</p>
<p>so that w(i_diff_mg) in ghostcells won't accumulate to extreme values</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00718">718</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a7655ed0734cd3f508292a2549b19db7b_cgraph.png" border="0" usemap="#anamespacemod__fld_a7655ed0734cd3f508292a2549b19db7b_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a7655ed0734cd3f508292a2549b19db7b_cgraph" id="anamespacemod__fld_a7655ed0734cd3f508292a2549b19db7b_cgraph">
<area shape="rect" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="5,49,188,89"/>
<area shape="rect" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="236,5,436,31"/>
<area shape="poly" title=" " alt="" coords="188,47,261,31,262,36,189,52"/>
<area shape="rect" href="namespacemod__fld.html#a078e9ee0bdeb4d94763a97c2f009d9fd" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="484,31,665,56"/>
<area shape="poly" title=" " alt="" coords="188,61,470,46,470,51,189,67"/>
<area shape="rect" href="namespacemod__fld.html#aca3f250fedcc3f1382b2d77a70b0313d" title="Use running average on Diffusion coefficient." alt="" coords="259,106,413,146"/>
<area shape="poly" title=" " alt="" coords="181,86,246,102,245,107,180,91"/>
<area shape="poly" title=" " alt="" coords="436,26,471,30,470,35,436,31"/>
</map>
</div>

</div>
</div>
<a id="ae4b0473cde5cb134920cc7505650e13b" name="ae4b0473cde5cb134920cc7505650e13b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b0473cde5cb134920cc7505650e13b">&#9670;&#160;</a></span>fld_get_eddington()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_get_eddington </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>eddington_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Eddington-tensor Stores Eddington-tensor in w-array. </p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate radiation pressure P = (lambda + lambda^2 R^2)*E</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00402">402</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ae4b0473cde5cb134920cc7505650e13b_cgraph.png" border="0" usemap="#anamespacemod__fld_ae4b0473cde5cb134920cc7505650e13b_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ae4b0473cde5cb134920cc7505650e13b_cgraph" id="anamespacemod__fld_ae4b0473cde5cb134920cc7505650e13b_cgraph">
<area shape="rect" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="5,31,204,56"/>
<area shape="rect" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="252,5,452,31"/>
<area shape="poly" title=" " alt="" coords="204,31,238,27,239,32,204,36"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="500,31,683,56"/>
<area shape="poly" title=" " alt="" coords="205,41,486,41,486,46,205,46"/>
<area shape="poly" title=" " alt="" coords="453,26,486,30,486,35,452,31"/>
</map>
</div>

</div>
</div>
<a id="a84e9e6eb8603ea5f429c6fab5477f778" name="a84e9e6eb8603ea5f429c6fab5477f778"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e9e6eb8603ea5f429c6fab5477f778">&#9670;&#160;</a></span>fld_get_fluxlimiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_fluxlimiter </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stored in fld_fluxlimiter. It also calculates the ratio of radiation scaleheight and mean free path. </p>
<p>optically thick limit</p>
<p>optically thin limit Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Levermore and Pomraning: lambda = (2 + R)/(6 + 3R + R^2)</p>
<p>Calculate R everywhere |grad E|/(rho kappa E)</p>
<p>Calculate the flux limiter, lambda Minerbo:</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00274">274</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a84e9e6eb8603ea5f429c6fab5477f778_cgraph.png" border="0" usemap="#anamespacemod__fld_a84e9e6eb8603ea5f429c6fab5477f778_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a84e9e6eb8603ea5f429c6fab5477f778_cgraph" id="anamespacemod__fld_a84e9e6eb8603ea5f429c6fab5477f778_cgraph">
<area shape="rect" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="5,31,205,56"/>
<area shape="rect" href="namespacemod__fld.html#a078e9ee0bdeb4d94763a97c2f009d9fd" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="254,5,435,31"/>
<area shape="poly" title=" " alt="" coords="205,30,240,26,241,32,206,35"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="253,55,436,80"/>
<area shape="poly" title=" " alt="" coords="206,51,240,54,239,59,205,56"/>
</map>
</div>

</div>
</div>
<a id="a078e9ee0bdeb4d94763a97c2f009d9fd" name="a078e9ee0bdeb4d94763a97c2f009d9fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a078e9ee0bdeb4d94763a97c2f009d9fd">&#9670;&#160;</a></span>fld_get_opacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_opacity </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>fld_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the opacity in the w-array by calling <a class="el" href="namespacemod__opal__opacity.html" title="This module reads in Rosseland-mean opacities from OPAL tables. Table opacity values are given in bas...">mod_opal_opacity</a>. </p>
<p>Take lower value of rho in domain</p>
<p>Opacity bump</p>
<p>Take lower value of rho in domain</p>
<p>Hard limit on kappa</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00205">205</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a078e9ee0bdeb4d94763a97c2f009d9fd_cgraph.png" border="0" usemap="#anamespacemod__fld_a078e9ee0bdeb4d94763a97c2f009d9fd_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a078e9ee0bdeb4d94763a97c2f009d9fd_cgraph" id="anamespacemod__fld_a078e9ee0bdeb4d94763a97c2f009d9fd_cgraph">
<area shape="rect" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="5,13,187,38"/>
<area shape="rect" href="namespacemod__opal__opacity.html#a8a6b7571280893a4d5716c993e03c910" title="This subroutine calculates the opacity for a given temperature&#45;density structure. Opacities are read ..." alt="" coords="235,5,403,45"/>
<area shape="poly" title=" " alt="" coords="187,23,221,23,221,28,187,28"/>
</map>
</div>

</div>
</div>
<a id="ac54bad97f6a46e7c89cee5698a217f46" name="ac54bad97f6a46e7c89cee5698a217f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac54bad97f6a46e7c89cee5698a217f46">&#9670;&#160;</a></span>fld_get_radflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_radflux </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s, 1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Flux stores radiation flux in w-array. </p>
<p>Calculate the Flux using the fld closure relation F = -c*lambda/(kappa*rho) *grad E</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00375">375</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ac54bad97f6a46e7c89cee5698a217f46_cgraph.png" border="0" usemap="#anamespacemod__fld_ac54bad97f6a46e7c89cee5698a217f46_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ac54bad97f6a46e7c89cee5698a217f46_cgraph" id="anamespacemod__fld_ac54bad97f6a46e7c89cee5698a217f46_cgraph">
<area shape="rect" title="Calculate Radiation Flux stores radiation flux in w&#45;array." alt="" coords="5,29,184,55"/>
<area shape="rect" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="232,29,432,55"/>
<area shape="poly" title=" " alt="" coords="184,39,218,39,218,45,184,45"/>
<area shape="rect" href="namespacemod__fld.html#a078e9ee0bdeb4d94763a97c2f009d9fd" title="Sets the opacity in the w&#45;array by calling mod_opal_opacity." alt="" coords="481,5,662,31"/>
<area shape="poly" title=" " alt="" coords="151,27,232,14,354,8,467,10,467,15,354,14,232,19,152,32"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="480,55,663,80"/>
<area shape="poly" title=" " alt="" coords="152,52,232,65,353,71,466,70,466,75,353,76,232,70,151,57"/>
<area shape="poly" title=" " alt="" coords="432,29,467,26,467,31,433,35"/>
<area shape="poly" title=" " alt="" coords="433,50,466,54,466,59,432,55"/>
</map>
</div>

</div>
</div>
<a id="a61306bd3278dc4b63570d46d7a4b654c" name="a61306bd3278dc4b63570d46d7a4b654c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61306bd3278dc4b63570d46d7a4b654c">&#9670;&#160;</a></span>fld_get_radpress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_get_radpress </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixo^s,1:ndim,1:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rad_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Radiation Pressure Returns Radiation Pressure as tensor. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00455">455</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a61306bd3278dc4b63570d46d7a4b654c_cgraph.png" border="0" usemap="#anamespacemod__fld_a61306bd3278dc4b63570d46d7a4b654c_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a61306bd3278dc4b63570d46d7a4b654c_cgraph" id="anamespacemod__fld_a61306bd3278dc4b63570d46d7a4b654c_cgraph">
<area shape="rect" title="Calculate Radiation Pressure Returns Radiation Pressure as tensor." alt="" coords="5,5,195,31"/>
<area shape="rect" href="namespacemod__fld.html#ae4b0473cde5cb134920cc7505650e13b" title="Calculate Eddington&#45;tensor Stores Eddington&#45;tensor in w&#45;array." alt="" coords="243,5,441,31"/>
<area shape="poly" title=" " alt="" coords="195,15,229,15,229,21,195,21"/>
</map>
</div>

</div>
</div>
<a id="af84fc6e1d9d991a23def9a1f3e304f80" name="af84fc6e1d9d991a23def9a1f3e304f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af84fc6e1d9d991a23def9a1f3e304f80">&#9670;&#160;</a></span>fld_implicit_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_implicit_update </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dtfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qtc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00472">472</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_af84fc6e1d9d991a23def9a1f3e304f80_cgraph.png" border="0" usemap="#anamespacemod__fld_af84fc6e1d9d991a23def9a1f3e304f80_cgraph" alt=""/></div>
<map name="anamespacemod__fld_af84fc6e1d9d991a23def9a1f3e304f80_cgraph" id="anamespacemod__fld_af84fc6e1d9d991a23def9a1f3e304f80_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,160,75"/>
<area shape="rect" href="namespacemod__fld.html#ace01cd630d220166e1a301dac3c89008" title="Calling all subroutines to perform the multigrid method Communicates rad_e and diff_coeff to multigri..." alt="" coords="239,5,381,45"/>
<area shape="poly" title=" " alt="" coords="160,42,225,34,226,39,160,47"/>
<area shape="rect" href="namespacemod__fld.html#a1bf63912c9ee0d82df2f55f5522e35a5" title="Energy interaction and photon tiring." alt="" coords="208,70,412,95"/>
<area shape="poly" title=" " alt="" coords="160,61,195,66,194,71,160,67"/>
</map>
</div>

</div>
</div>
<a id="a644bcbf423e600ca2e0019f55394ca3d" name="a644bcbf423e600ca2e0019f55394ca3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644bcbf423e600ca2e0019f55394ca3d">&#9670;&#160;</a></span>fld_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_init </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>he_abundance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>radiation_diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy_interact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>r_gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialising FLD-module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variables to w-array, flux, kappa, eddington Tensor Lambda and R ... </p>
<p>read par files</p>
<p>Set lineforce opacities as variable</p>
<p>need to check</p>
<p>Need mean molecular weight</p>
<p>set gamma</p>
<p>Read in opacity table if necesary</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00093">93</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a644bcbf423e600ca2e0019f55394ca3d_cgraph.png" border="0" usemap="#anamespacemod__fld_a644bcbf423e600ca2e0019f55394ca3d_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a644bcbf423e600ca2e0019f55394ca3d_cgraph" id="anamespacemod__fld_a644bcbf423e600ca2e0019f55394ca3d_cgraph">
<area shape="rect" title="Initialising FLD&#45;module: Read opacities Initialise Multigrid adimensionalise kappa Add extra variable..." alt="" coords="5,134,132,159"/>
<area shape="rect" href="namespacemod__fld.html#a5fb47c317d9d55a7e10ff327d7967a5e" title="inplace update of psa==&gt;F_im(psa)" alt="" coords="198,5,353,45"/>
<area shape="poly" title=" " alt="" coords="81,131,123,94,179,55,192,48,194,53,181,60,126,98,85,135"/>
<area shape="rect" href="namespacemod__fld.html#af84fc6e1d9d991a23def9a1f3e304f80" title=" " alt="" coords="198,69,353,109"/>
<area shape="poly" title=" " alt="" coords="115,131,189,110,190,116,116,137"/>
<area shape="rect" href="namespacemod__fld.html#a2fab030adfe37e60459f2f6c8140f091" title="public methods these are called in mod_rhd_phys" alt="" coords="180,134,371,159"/>
<area shape="poly" title=" " alt="" coords="132,144,166,144,166,149,132,149"/>
<area shape="rect" href="namespacemod__opal__opacity.html#a7c35946184618fb6e09dc3257316b79d" title="This subroutine is called when the FLD radiation module is initialised. The OPAL tables for different..." alt="" coords="191,184,360,224"/>
<area shape="poly" title=" " alt="" coords="116,157,190,178,189,183,115,162"/>
<area shape="rect" href="namespacemod__variables.html#a924c3b2f4e13f6f6432de212ac790966" title="Set extra variable in w, which is not advected and has no boundary conditions. This has to be done af..." alt="" coords="202,248,349,288"/>
<area shape="poly" title=" " alt="" coords="85,158,126,195,181,234,194,240,192,245,179,238,123,199,81,162"/>
</map>
</div>

</div>
</div>
<a id="a2fab030adfe37e60459f2f6c8140f091" name="a2fab030adfe37e60459f2f6c8140f091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fab030adfe37e60459f2f6c8140f091">&#9670;&#160;</a></span>fld_params_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_params_read </td>
          <td>(</td>
          <td class="paramtype">character(len=*), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>files</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>public methods these are called in <a class="el" href="namespacemod__rhd__phys.html" title="Radiation-Hydrodynamics physics module Module aims at solving the Hydrodynamic equations toghether wi...">mod_rhd_phys</a> </p>
<p>Reading in fld-list parameters from .par file </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00067">67</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ad6c22947bcd2e35eb73047df6d59ce9c" name="ad6c22947bcd2e35eb73047df6d59ce9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6c22947bcd2e35eb73047df6d59ce9c">&#9670;&#160;</a></span>fld_radforce_get_dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::fld_radforce_get_dt </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>dtnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00180">180</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ad6c22947bcd2e35eb73047df6d59ce9c_cgraph.png" border="0" usemap="#anamespacemod__fld_ad6c22947bcd2e35eb73047df6d59ce9c_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ad6c22947bcd2e35eb73047df6d59ce9c_cgraph" id="anamespacemod__fld_ad6c22947bcd2e35eb73047df6d59ce9c_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,164,63"/>
<area shape="rect" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="212,5,412,31"/>
<area shape="poly" title=" " alt="" coords="164,32,198,28,199,33,165,37"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="460,31,643,56"/>
<area shape="poly" title=" " alt="" coords="164,41,447,41,447,46,164,46"/>
<area shape="poly" title=" " alt="" coords="413,26,446,30,446,35,412,31"/>
</map>
</div>

</div>
</div>
<a id="aca3f250fedcc3f1382b2d77a70b0313d" name="aca3f250fedcc3f1382b2d77a70b0313d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca3f250fedcc3f1382b2d77a70b0313d">&#9670;&#160;</a></span>fld_smooth_diffcoef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::fld_smooth_diffcoef </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use running average on Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00762">762</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a5b928697cae65a802cc7721063d39b65" name="a5b928697cae65a802cc7721063d39b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b928697cae65a802cc7721063d39b65">&#9670;&#160;</a></span>get_fld_rad_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_fld::get_fld_rad_force </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles the radiation force </p>
<p>Calculate and add sourceterms</p>
<p>Radiation force = kappa*rho/c *Flux = lambda gradE</p>
<p>Momentum equation source term</p>
<p>Energy equation source term (kinetic energy)</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00144">144</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a5b928697cae65a802cc7721063d39b65_cgraph.png" border="0" usemap="#anamespacemod__fld_a5b928697cae65a802cc7721063d39b65_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a5b928697cae65a802cc7721063d39b65_cgraph" id="anamespacemod__fld_a5b928697cae65a802cc7721063d39b65_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO This subroutine handles th..." alt="" coords="5,23,160,63"/>
<area shape="rect" href="namespacemod__fld.html#a84e9e6eb8603ea5f429c6fab5477f778" title="Calculate fld flux limiter This subroutine calculates flux limiter lambda using the prescription stor..." alt="" coords="208,5,408,31"/>
<area shape="poly" title=" " alt="" coords="160,32,194,28,195,33,160,37"/>
<area shape="rect" href="namespacemod__geometry.html#a9be440eb43ae039be6f1e52e5c841f69" title=" " alt="" coords="456,31,639,56"/>
<area shape="poly" title=" " alt="" coords="160,41,442,41,442,46,160,46"/>
<area shape="poly" title=" " alt="" coords="409,26,442,30,442,35,408,31"/>
</map>
</div>

</div>
</div>
<a id="aae00cd585d53d7f497426872a6b7a36c" name="aae00cd585d53d7f497426872a6b7a36c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae00cd585d53d7f497426872a6b7a36c">&#9670;&#160;</a></span>halley_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::halley_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Halley method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00881">881</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_aae00cd585d53d7f497426872a6b7a36c_cgraph.png" border="0" usemap="#anamespacemod__fld_aae00cd585d53d7f497426872a6b7a36c_cgraph" alt=""/></div>
<map name="anamespacemod__fld_aae00cd585d53d7f497426872a6b7a36c_cgraph" id="anamespacemod__fld_aae00cd585d53d7f497426872a6b7a36c_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Halley method." alt="" coords="5,95,184,121"/>
<area shape="rect" href="namespacemod__fld.html#a5c3cb192d4ff204d751bbabdc46570a3" title="Evaluate second derivative of polynomial at argument e_gas." alt="" coords="240,5,411,45"/>
<area shape="poly" title=" " alt="" coords="130,93,255,48,256,53,132,98"/>
<area shape="rect" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="467,72,629,112"/>
<area shape="poly" title=" " alt="" coords="184,102,453,93,453,98,185,108"/>
<area shape="rect" href="namespacemod__fld.html#ab77a233aa68b193411dcd4d51348ead7" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="232,121,419,146"/>
<area shape="poly" title=" " alt="" coords="184,115,219,119,218,124,184,120"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="471,145,625,185"/>
<area shape="poly" title=" " alt="" coords="123,118,173,139,233,156,290,164,349,169,457,169,457,174,349,174,289,170,231,161,172,144,121,123"/>
<area shape="poly" title=" " alt="" coords="394,118,452,107,453,112,395,123"/>
<area shape="poly" title=" " alt="" coords="415,143,457,150,457,155,414,149"/>
</map>
</div>

</div>
</div>
<a id="ab77a233aa68b193411dcd4d51348ead7" name="ab77a233aa68b193411dcd4d51348ead7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77a233aa68b193411dcd4d51348ead7">&#9670;&#160;</a></span>newton_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::newton_method </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the root of the 4th degree polynomial using the Newton-Ralphson method. </p>
<p>Compare error with dx = dx/dy dy</p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00851">851</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_ab77a233aa68b193411dcd4d51348ead7_cgraph.png" border="0" usemap="#anamespacemod__fld_ab77a233aa68b193411dcd4d51348ead7_cgraph" alt=""/></div>
<map name="anamespacemod__fld_ab77a233aa68b193411dcd4d51348ead7_cgraph" id="anamespacemod__fld_ab77a233aa68b193411dcd4d51348ead7_cgraph">
<area shape="rect" title="Find the root of the 4th degree polynomial using the Newton&#45;Ralphson method." alt="" coords="5,70,192,95"/>
<area shape="rect" href="namespacemod__fld.html#a790ae55dace4c7cae8c5a7091943ad65" title="Find the root of the 4th degree polynomial using the bisection method." alt="" coords="251,5,392,45"/>
<area shape="poly" title=" " alt="" coords="148,67,237,44,238,49,149,73"/>
<area shape="rect" href="namespacemod__fld.html#a8ec89cf1950c713250b72d34680df7c0" title="Evaluate polynomial at argument e_gas." alt="" coords="451,35,605,75"/>
<area shape="poly" title=" " alt="" coords="192,74,437,58,437,63,192,79"/>
<area shape="rect" href="namespacemod__fld.html#ac956fe2dd223e2039a113a0d0c2991d0" title="Evaluate first derivative of polynomial at argument e_gas." alt="" coords="240,120,403,160"/>
<area shape="poly" title=" " alt="" coords="149,93,231,114,229,119,148,98"/>
<area shape="poly" title=" " alt="" coords="393,33,437,39,436,44,392,38"/>
</map>
</div>

</div>
</div>
<a id="a8ec89cf1950c713250b72d34680df7c0" name="a8ec89cf1950c713250b72d34680df7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec89cf1950c713250b72d34680df7c0">&#9670;&#160;</a></span>polynomial_bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function mod_fld::polynomial_bisection </td>
          <td>(</td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>e_gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate polynomial at argument e_gas. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00912">912</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a02980c6a45de45987bb5b18fc223b1aa" name="a02980c6a45de45987bb5b18fc223b1aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02980c6a45de45987bb5b18fc223b1aa">&#9670;&#160;</a></span>put_diffterm_onegrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::put_diffterm_onegrid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s, 1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inplace update of psa==&gt;F_im(psa) </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00697">697</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a38e6e06ef18024f6865cadb7aab2aa00" name="a38e6e06ef18024f6865cadb7aab2aa00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38e6e06ef18024f6865cadb7aab2aa00">&#9670;&#160;</a></span>update_diffcoeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_fld::update_diffcoeff </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmod__physicaldata_1_1state.html">state</a>), dimension(max_blocks), target&#160;</td>
          <td class="paramname"><em>psa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00746">746</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph.png" border="0" usemap="#anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph" alt=""/></div>
<map name="anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph" id="anamespacemod__fld_a38e6e06ef18024f6865cadb7aab2aa00_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,192,38"/>
<area shape="rect" href="namespacemod__fld.html#a7655ed0734cd3f508292a2549b19db7b" title="Calculates cell&#45;centered diffusion coefficient to be used in multigrid." alt="" coords="240,5,423,45"/>
<area shape="poly" title=" " alt="" coords="192,23,226,23,226,28,192,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae865a7dd858718239c52ff826e35bedd" name="ae865a7dd858718239c52ff826e35bedd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae865a7dd858718239c52ff826e35bedd">&#9670;&#160;</a></span>diff_coef_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::diff_coef_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take running average for Diffusion coefficient. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00039">39</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="af77876e7c2f8261a6c8a31f2d8659f05" name="af77876e7c2f8261a6c8a31f2d8659f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af77876e7c2f8261a6c8a31f2d8659f05">&#9670;&#160;</a></span>diff_crit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::diff_crit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number for splitting the diffusion module. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00026">26</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a31f9f6143b297d23f4fc26012e98cf32" name="a31f9f6143b297d23f4fc26012e98cf32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f9f6143b297d23f4fc26012e98cf32">&#9670;&#160;</a></span>diffcrash_resume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::diffcrash_resume = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume run when multigrid returns error. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00047">47</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="af736b4330bbe9b53d2a6effc9d2e1730" name="af736b4330bbe9b53d2a6effc9d2e1730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af736b4330bbe9b53d2a6effc9d2e1730">&#9670;&#160;</a></span>dt_diff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision mod_fld::dt_diff = 0.d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>running timestep for diffusion solver, initialised as zero </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00053">53</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a1baf3c3f8c4e68834dfedd8f7362663a" name="a1baf3c3f8c4e68834dfedd8f7362663a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1baf3c3f8c4e68834dfedd8f7362663a">&#9670;&#160;</a></span>fld_bisect_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_bisect_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for bisection method for Energy sourceterms This is a percentage of the minimum of gas- and radiation energy. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00022">22</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a856d86414a9d106690e2f9f33976b705" name="a856d86414a9d106690e2f9f33976b705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a856d86414a9d106690e2f9f33976b705">&#9670;&#160;</a></span>fld_diff_scheme</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_diff_scheme = 'mg'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to solve diffusion part. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00035">35</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a23d86935a2e8d953c3ef8e5270eac0ff" name="a23d86935a2e8d953c3ef8e5270eac0ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23d86935a2e8d953c3ef8e5270eac0ff">&#9670;&#160;</a></span>fld_diff_tol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_diff_tol = 1.d-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tolerance for adi method for radiative Energy diffusion. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00024">24</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="aa33a1dcdba3d105c08f8da30c1561101" name="aa33a1dcdba3d105c08f8da30c1561101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33a1dcdba3d105c08f8da30c1561101">&#9670;&#160;</a></span>fld_eint_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::fld_eint_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>source split for energy interact and radforce: </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00014">14</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a6653738fcac09ac966028771a78e4d52" name="a6653738fcac09ac966028771a78e4d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6653738fcac09ac966028771a78e4d52">&#9670;&#160;</a></span>fld_fluxlimiter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=16) mod_fld::fld_fluxlimiter = 'Pomraning'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Diffusion limit lambda = 0.33. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00031">31</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ab52da06b97cae443e859349f1c04b5fa" name="ab52da06b97cae443e859349f1c04b5fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab52da06b97cae443e859349f1c04b5fa">&#9670;&#160;</a></span>fld_interaction_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_interaction_method = 'Halley'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Which method to find the root for the energy interaction polynomial. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00037">37</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a833746bb6e5dbd734a00ec94b4669b1b" name="a833746bb6e5dbd734a00ec94b4669b1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a833746bb6e5dbd734a00ec94b4669b1b">&#9670;&#160;</a></span>fld_kappa0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_kappa0 = 0.34d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opacity per unit of unit_density. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00017">17</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a1b3ea3f3889855c64aeb21fd813bb7d3" name="a1b3ea3f3889855c64aeb21fd813bb7d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b3ea3f3889855c64aeb21fd813bb7d3">&#9670;&#160;</a></span>fld_mu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, public mod_fld::fld_mu = 0.6d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>mean particle mass </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00019">19</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a4717a388644e4cb1fe9b0e27860d2007" name="a4717a388644e4cb1fe9b0e27860d2007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4717a388644e4cb1fe9b0e27860d2007">&#9670;&#160;</a></span>fld_opacity_law</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=8) mod_fld::fld_opacity_law = 'const'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use constant Opacity? </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00028">28</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a7cb90faa1f0dbfb0d74e9772a7d00545" name="a7cb90faa1f0dbfb0d74e9772a7d00545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb90faa1f0dbfb0d74e9772a7d00545">&#9670;&#160;</a></span>fld_opal_table</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=50) mod_fld::fld_opal_table = 'Y09800'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00029">29</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="abf910fa47bd4269dd49980e2f51efc46" name="abf910fa47bd4269dd49980e2f51efc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf910fa47bd4269dd49980e2f51efc46">&#9670;&#160;</a></span>fld_radforce_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::fld_radforce_split = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00015">15</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ae25919ae30d513d31baef1185e5f3088" name="ae25919ae30d513d31baef1185e5f3088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae25919ae30d513d31baef1185e5f3088">&#9670;&#160;</a></span>flux_lim_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::flux_lim_filter = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take a running average over the fluxlimiter. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00042">42</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="ada3e212a237e18cb9a3166799117c6fa" name="ada3e212a237e18cb9a3166799117c6fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada3e212a237e18cb9a3166799117c6fa">&#9670;&#160;</a></span>i_diff_mg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::i_diff_mg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>diffusion coefficient for multigrid method </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00033">33</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a3b3c400ea76d816d13544c77938e78e9" name="a3b3c400ea76d816d13544c77938e78e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b3c400ea76d816d13544c77938e78e9">&#9670;&#160;</a></span>i_opf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable, public mod_fld::i_opf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for Flux weighted opacities. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00049">49</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a8adb0b2d41f252cf64683544a14b47ef" name="a8adb0b2d41f252cf64683544a14b47ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adb0b2d41f252cf64683544a14b47ef">&#9670;&#160;</a></span>lineforce_opacities</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_fld::lineforce_opacities = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use or dont use lineforce opacities. </p>

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00045">45</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a76ef494608b155112c93ba41930b05b7" name="a76ef494608b155112c93ba41930b05b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ef494608b155112c93ba41930b05b7">&#9670;&#160;</a></span>size_d_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::size_d_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00040">40</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
<a id="a7471e33d67b7dfb4f836eb7b8df8ec0f" name="a7471e33d67b7dfb4f836eb7b8df8ec0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7471e33d67b7dfb4f836eb7b8df8ec0f">&#9670;&#160;</a></span>size_l_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_fld::size_l_filter = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__fld_8t_source.html#l00043">43</a> of file <a class="el" href="mod__fld_8t_source.html">mod_fld.t</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
