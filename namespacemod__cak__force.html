<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: mod_cak_force Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.1</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mod_cak_force Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module to include CAK radiation line force in (magneto)hydrodynamic models Computes both the force from free electrons and the force from an ensemble of lines (various possibilities for the latter). There is an option to only simulate the pure radial CAK force (with various corrections applied) as well as the full vector CAK force. Depending on the chosen option additional output are the CAK line force component(s) and, when doing a 1-D radial force, the finite disc factor.  
<a href="namespacemod__cak__force.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3f11fac7bc8895d5ad4001f8e818621d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a3f11fac7bc8895d5ad4001f8e818621d">cak_params_read</a> (files)</td></tr>
<tr class="memdesc:a3f11fac7bc8895d5ad4001f8e818621d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public method.  <a href="namespacemod__cak__force.html#a3f11fac7bc8895d5ad4001f8e818621d">More...</a><br /></td></tr>
<tr class="separator:a3f11fac7bc8895d5ad4001f8e818621d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ea4d69b0566bbe50c6d7900abbdce5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a3ea4d69b0566bbe50c6d7900abbdce5d">cak_init</a> (phys_gamma)</td></tr>
<tr class="memdesc:a3ea4d69b0566bbe50c6d7900abbdce5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the module.  <a href="namespacemod__cak__force.html#a3ea4d69b0566bbe50c6d7900abbdce5d">More...</a><br /></td></tr>
<tr class="separator:a3ea4d69b0566bbe50c6d7900abbdce5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b59828c3ad6e4a053045e2dbb821a5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a75b59828c3ad6e4a053045e2dbb821a5">set_cak_force_norm</a> (rstar, twind)</td></tr>
<tr class="memdesc:a75b59828c3ad6e4a053045e2dbb821a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute some (unitless) variables for CAK force normalisation.  <a href="namespacemod__cak__force.html#a75b59828c3ad6e4a053045e2dbb821a5">More...</a><br /></td></tr>
<tr class="separator:a75b59828c3ad6e4a053045e2dbb821a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83fe70934132062bf7aec456aa93f530"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a83fe70934132062bf7aec456aa93f530">cak_add_source</a> (qdt, ixIL, ixOL, wCT, w, x, energy, qsourcesplit, active)</td></tr>
<tr class="memdesc:a83fe70934132062bf7aec456aa93f530"><td class="mdescLeft">&#160;</td><td class="mdescRight">w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO  <a href="namespacemod__cak__force.html#a83fe70934132062bf7aec456aa93f530">More...</a><br /></td></tr>
<tr class="separator:a83fe70934132062bf7aec456aa93f530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78be8d6234cc4b1bb379c1d5da133278"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a78be8d6234cc4b1bb379c1d5da133278">get_cak_force_radial</a> (ixIL, ixOL, wCT, w, x, gcak)</td></tr>
<tr class="memdesc:a78be8d6234cc4b1bb379c1d5da133278"><td class="mdescLeft">&#160;</td><td class="mdescRight">1-D CAK line force in the Gayley line-ensemble distribution parametrisation  <a href="namespacemod__cak__force.html#a78be8d6234cc4b1bb379c1d5da133278">More...</a><br /></td></tr>
<tr class="separator:a78be8d6234cc4b1bb379c1d5da133278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca637c35a8d03c8282d38e4cce6f011c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#aca637c35a8d03c8282d38e4cce6f011c">get_cak_force_vector</a> (ixIL, ixOL, wCT, w, x, gcak)</td></tr>
<tr class="memdesc:aca637c35a8d03c8282d38e4cce6f011c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector CAK line force in the Gayley line-ensemble distribution parametrisation.  <a href="namespacemod__cak__force.html#aca637c35a8d03c8282d38e4cce6f011c">More...</a><br /></td></tr>
<tr class="separator:aca637c35a8d03c8282d38e4cce6f011c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef9eac0ed4ccc968912372844591dec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a0ef9eac0ed4ccc968912372844591dec">get_gelectron</a> (ixIL, ixOL, w, x, ge)</td></tr>
<tr class="memdesc:a0ef9eac0ed4ccc968912372844591dec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute continuum radiation force from Thomson scattering.  <a href="namespacemod__cak__force.html#a0ef9eac0ed4ccc968912372844591dec">More...</a><br /></td></tr>
<tr class="separator:a0ef9eac0ed4ccc968912372844591dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3342a8e2da21d6e48bd73851449898c9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a3342a8e2da21d6e48bd73851449898c9">cak_get_dt</a> (w, ixIL, ixOL, dtnew, dxD, x)</td></tr>
<tr class="memdesc:a3342a8e2da21d6e48bd73851449898c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check time step for total radiation contribution.  <a href="namespacemod__cak__force.html#a3342a8e2da21d6e48bd73851449898c9">More...</a><br /></td></tr>
<tr class="separator:a3342a8e2da21d6e48bd73851449898c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e50108bb9d55cdb8cc5b292c33fb42"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a19e50108bb9d55cdb8cc5b292c33fb42">get_velocity_gradient</a> (ixIL, ixOL, vfield, x, idir, grad_vn)</td></tr>
<tr class="memdesc:a19e50108bb9d55cdb8cc5b292c33fb42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute velocity gradient in direction 'idir' on a non-uniform grid.  <a href="namespacemod__cak__force.html#a19e50108bb9d55cdb8cc5b292c33fb42">More...</a><br /></td></tr>
<tr class="separator:a19e50108bb9d55cdb8cc5b292c33fb42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef780782d3155c249770b687578d070b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#aef780782d3155c249770b687578d070b">rays_init</a> (ntheta_point, nphi_point)</td></tr>
<tr class="memdesc:aef780782d3155c249770b687578d070b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise (theta',phi') radiation angles coming from stellar disc.  <a href="namespacemod__cak__force.html#aef780782d3155c249770b687578d070b">More...</a><br /></td></tr>
<tr class="separator:aef780782d3155c249770b687578d070b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4de21e5ed2f71feb2a89ee2c8705c1ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a4de21e5ed2f71feb2a89ee2c8705c1ec">gauss_legendre_quadrature</a> (xlow, xhi, n, x, w)</td></tr>
<tr class="memdesc:a4de21e5ed2f71feb2a89ee2c8705c1ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast Gauss-Legendre N-point quadrature algorithm by G. Rybicki.  <a href="namespacemod__cak__force.html#a4de21e5ed2f71feb2a89ee2c8705c1ec">More...</a><br /></td></tr>
<tr class="separator:a4de21e5ed2f71feb2a89ee2c8705c1ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a55935f012ca1ef2d5d60b83686c090ce"><td class="memItemLeft" align="right" valign="top">real(8), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a55935f012ca1ef2d5d60b83686c090ce">cak_alpha</a></td></tr>
<tr class="memdesc:a55935f012ca1ef2d5d60b83686c090ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Line-ensemble parameters in the Gayley (1995) formalism.  <a href="namespacemod__cak__force.html#a55935f012ca1ef2d5d60b83686c090ce">More...</a><br /></td></tr>
<tr class="separator:a55935f012ca1ef2d5d60b83686c090ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15231e4b4a9df1259ad0c3558ecf2369"><td class="memItemLeft" align="right" valign="top">real(8), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a15231e4b4a9df1259ad0c3558ecf2369">gayley_qbar</a></td></tr>
<tr class="separator:a15231e4b4a9df1259ad0c3558ecf2369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d7f489d5dbf494e5d3dc90ba3c82cc7"><td class="memItemLeft" align="right" valign="top">real(8), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a1d7f489d5dbf494e5d3dc90ba3c82cc7">gayley_q0</a></td></tr>
<tr class="separator:a1d7f489d5dbf494e5d3dc90ba3c82cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f12dc9aa12323a8b197529097dab2c2"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a9f12dc9aa12323a8b197529097dab2c2">cak_1d_opt</a></td></tr>
<tr class="memdesc:a9f12dc9aa12323a8b197529097dab2c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch to choose between the 1-D CAK line force options.  <a href="namespacemod__cak__force.html#a9f12dc9aa12323a8b197529097dab2c2">More...</a><br /></td></tr>
<tr class="separator:a9f12dc9aa12323a8b197529097dab2c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4f6a71504425aa3ef604af165369fb"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a3b4f6a71504425aa3ef604af165369fb">cak_split</a> =.false.</td></tr>
<tr class="memdesc:a3b4f6a71504425aa3ef604af165369fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">To treat source term in split or unsplit (default) fashion.  <a href="namespacemod__cak__force.html#a3b4f6a71504425aa3ef604af165369fb">More...</a><br /></td></tr>
<tr class="separator:a3b4f6a71504425aa3ef604af165369fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed02c1bd73441906c137c8091aa99816"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#aed02c1bd73441906c137c8091aa99816">cak_1d_force</a> =.false.</td></tr>
<tr class="memdesc:aed02c1bd73441906c137c8091aa99816"><td class="mdescLeft">&#160;</td><td class="mdescRight">To activate the original CAK 1-D line force computation.  <a href="namespacemod__cak__force.html#aed02c1bd73441906c137c8091aa99816">More...</a><br /></td></tr>
<tr class="separator:aed02c1bd73441906c137c8091aa99816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80638e7113beb92591e0978344e74cd4"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a80638e7113beb92591e0978344e74cd4">cak_vector_force</a> =.false.</td></tr>
<tr class="memdesc:a80638e7113beb92591e0978344e74cd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">To activate the vector CAK line force computation.  <a href="namespacemod__cak__force.html#a80638e7113beb92591e0978344e74cd4">More...</a><br /></td></tr>
<tr class="separator:a80638e7113beb92591e0978344e74cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7abb25819b9e38aef7e6f91c73baad32"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a7abb25819b9e38aef7e6f91c73baad32">fix_vector_force_1d</a> =.false.</td></tr>
<tr class="memdesc:a7abb25819b9e38aef7e6f91c73baad32"><td class="mdescLeft">&#160;</td><td class="mdescRight">To activate the pure radial vector CAK line force computation.  <a href="namespacemod__cak__force.html#a7abb25819b9e38aef7e6f91c73baad32">More...</a><br /></td></tr>
<tr class="separator:a7abb25819b9e38aef7e6f91c73baad32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2e07c9e5b3c80b4e604b3a4baaadbf"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#aed2e07c9e5b3c80b4e604b3a4baaadbf">nthetaray</a></td></tr>
<tr class="memdesc:aed2e07c9e5b3c80b4e604b3a4baaadbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Amount of rays in radiation polar and radiation azimuthal direction.  <a href="namespacemod__cak__force.html#aed2e07c9e5b3c80b4e604b3a4baaadbf">More...</a><br /></td></tr>
<tr class="separator:aed2e07c9e5b3c80b4e604b3a4baaadbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af454290f0f678d5ec5e82e500d14402f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#af454290f0f678d5ec5e82e500d14402f">nphiray</a></td></tr>
<tr class="separator:af454290f0f678d5ec5e82e500d14402f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc0ac81ccb769d6f389a481264e4e0c"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a7cc0ac81ccb769d6f389a481264e4e0c">gcak1_</a></td></tr>
<tr class="memdesc:a7cc0ac81ccb769d6f389a481264e4e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extra slots to store quantities in w-array.  <a href="namespacemod__cak__force.html#a7cc0ac81ccb769d6f389a481264e4e0c">More...</a><br /></td></tr>
<tr class="separator:a7cc0ac81ccb769d6f389a481264e4e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed9282fb3227824bfc57f6f4bc2f0d6"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a8ed9282fb3227824bfc57f6f4bc2f0d6">gcak2_</a></td></tr>
<tr class="separator:a8ed9282fb3227824bfc57f6f4bc2f0d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4df183e42aeb56c1c35a21d592f2a94"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#ab4df183e42aeb56c1c35a21d592f2a94">gcak3_</a></td></tr>
<tr class="separator:ab4df183e42aeb56c1c35a21d592f2a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1def5edf4e12bbb4e70ff242f4a4e33b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__cak__force.html#a1def5edf4e12bbb4e70ff242f4a4e33b">fdf_</a></td></tr>
<tr class="separator:a1def5edf4e12bbb4e70ff242f4a4e33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module to include CAK radiation line force in (magneto)hydrodynamic models Computes both the force from free electrons and the force from an ensemble of lines (various possibilities for the latter). There is an option to only simulate the pure radial CAK force (with various corrections applied) as well as the full vector CAK force. Depending on the chosen option additional output are the CAK line force component(s) and, when doing a 1-D radial force, the finite disc factor. </p>
<p>USAGE:</p>
<ol type="1">
<li>Include a cak_list in the .par file and activate (m)hd_cak_force in the (m)hd_list</li>
<li>Create a mod_usr.t file for the problem with appropriate initial and boundary conditions</li>
<li>In the mod_usr.t header call the <a class="el" href="namespacemod__cak__force.html" title="Module to include CAK radiation line force in (magneto)hydrodynamic models Computes both the force fr...">mod_cak_force</a> module to have access to global variables from <a class="el" href="namespacemod__cak__force.html" title="Module to include CAK radiation line force in (magneto)hydrodynamic models Computes both the force fr...">mod_cak_force</a>, which may be handy for printing or the computation of other variables inside mod_usr.t</li>
<li>In usr_init of mod_usr.t call the set_cak_force_norm routine and pass along the stellar radius and wind temperature&mdash;this is needed to correctly compute the (initial) force normalisation inside <a class="el" href="namespacemod__cak__force.html" title="Module to include CAK radiation line force in (magneto)hydrodynamic models Computes both the force fr...">mod_cak_force</a></li>
<li>Ensure that the order of calls in usr_init is similar as for test problem CAKwind_spherical_1D: first reading usr.par list; then set unit scales; then call (M)HD_activate; then call set_cak_force_norm. This order avoids an incorrect force normalisation and code crash</li>
</ol>
<p>Developed by Florian Driessen (2022) </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a83fe70934132062bf7aec456aa93f530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83fe70934132062bf7aec456aa93f530">&#9670;&nbsp;</a></span>cak_add_source()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::cak_add_source </td>
          <td>(</td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>qdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>qsourcesplit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00159">159</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_a83fe70934132062bf7aec456aa93f530_cgraph.png" border="0" usemap="#anamespacemod__cak__force_a83fe70934132062bf7aec456aa93f530_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_a83fe70934132062bf7aec456aa93f530_cgraph" id="anamespacemod__cak__force_a83fe70934132062bf7aec456aa93f530_cgraph">
<area shape="rect" title="w[iw]=w[iw]+qdt*S[wCT,qtC,x] where S is the source based on wCT within ixO" alt="" coords="5,79,157,120"/>
<area shape="rect" href="namespacemod__cak__force.html#a78be8d6234cc4b1bb379c1d5da133278" title="1&#45;D CAK line force in the Gayley line&#45;ensemble distribution parametrisation" alt="" coords="205,49,356,91"/>
<area shape="rect" href="namespacemod__cak__force.html#a0ef9eac0ed4ccc968912372844591dec" title="Compute continuum radiation force from Thomson scattering." alt="" coords="420,5,571,47"/>
<area shape="rect" href="namespacemod__comm__lib.html#a9b6f1a8fd13bc5670e3b426151c34048" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="404,86,587,113"/>
<area shape="rect" href="namespacemod__cak__force.html#aca637c35a8d03c8282d38e4cce6f011c" title="Vector CAK line force in the Gayley line&#45;ensemble distribution parametrisation." alt="" coords="205,167,356,208"/>
</map>
</div>

</div>
</div>
<a id="a3342a8e2da21d6e48bd73851449898c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3342a8e2da21d6e48bd73851449898c9">&#9670;&nbsp;</a></span>cak_get_dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::cak_get_dt </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(inout)&#160;</td>
          <td class="paramname"><em>dtnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check time step for total radiation contribution. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00441">441</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_a3342a8e2da21d6e48bd73851449898c9_cgraph.png" border="0" usemap="#anamespacemod__cak__force_a3342a8e2da21d6e48bd73851449898c9_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_a3342a8e2da21d6e48bd73851449898c9_cgraph" id="anamespacemod__cak__force_a3342a8e2da21d6e48bd73851449898c9_cgraph">
<area shape="rect" title="Check time step for total radiation contribution." alt="" coords="5,5,157,47"/>
<area shape="rect" href="namespacemod__cak__force.html#a0ef9eac0ed4ccc968912372844591dec" title="Compute continuum radiation force from Thomson scattering." alt="" coords="205,5,356,47"/>
</map>
</div>

</div>
</div>
<a id="a3ea4d69b0566bbe50c6d7900abbdce5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ea4d69b0566bbe50c6d7900abbdce5d">&#9670;&nbsp;</a></span>cak_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::cak_init </td>
          <td>(</td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>phys_gamma</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the module. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00097">97</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_a3ea4d69b0566bbe50c6d7900abbdce5d_cgraph.png" border="0" usemap="#anamespacemod__cak__force_a3ea4d69b0566bbe50c6d7900abbdce5d_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_a3ea4d69b0566bbe50c6d7900abbdce5d_cgraph" id="anamespacemod__cak__force_a3ea4d69b0566bbe50c6d7900abbdce5d_cgraph">
<area shape="rect" title="Initialize the module." alt="" coords="5,71,185,98"/>
<area shape="rect" href="namespacemod__cak__force.html#a3f11fac7bc8895d5ad4001f8e818621d" title="Public method." alt="" coords="250,5,402,47"/>
<area shape="rect" href="namespacemod__comm__lib.html#a9b6f1a8fd13bc5670e3b426151c34048" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="235,71,417,98"/>
<area shape="rect" href="namespacemod__cak__force.html#aef780782d3155c249770b687578d070b" title="Initialise (theta&#39;,phi&#39;) radiation angles coming from stellar disc." alt="" coords="233,122,419,149"/>
</map>
</div>

</div>
</div>
<a id="a3f11fac7bc8895d5ad4001f8e818621d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f11fac7bc8895d5ad4001f8e818621d">&#9670;&nbsp;</a></span>cak_params_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::cak_params_read </td>
          <td>(</td>
          <td class="paramtype">character(len=*), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>files</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public method. </p>
<p>Read this module's parameters from a file </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00076">76</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a4de21e5ed2f71feb2a89ee2c8705c1ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4de21e5ed2f71feb2a89ee2c8705c1ec">&#9670;&nbsp;</a></span>gauss_legendre_quadrature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::gauss_legendre_quadrature </td>
          <td>(</td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>xlow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>xhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fast Gauss-Legendre N-point quadrature algorithm by G. Rybicki. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00633">633</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a78be8d6234cc4b1bb379c1d5da133278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78be8d6234cc4b1bb379c1d5da133278">&#9670;&nbsp;</a></span>get_cak_force_radial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::get_cak_force_radial </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixo^s,1:3), intent(inout)&#160;</td>
          <td class="paramname"><em>gcak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1-D CAK line force in the Gayley line-ensemble distribution parametrisation </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00216">216</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_a78be8d6234cc4b1bb379c1d5da133278_cgraph.png" border="0" usemap="#anamespacemod__cak__force_a78be8d6234cc4b1bb379c1d5da133278_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_a78be8d6234cc4b1bb379c1d5da133278_cgraph" id="anamespacemod__cak__force_a78be8d6234cc4b1bb379c1d5da133278_cgraph">
<area shape="rect" title="1&#45;D CAK line force in the Gayley line&#45;ensemble distribution parametrisation" alt="" coords="5,71,156,112"/>
<area shape="rect" href="namespacemod__cak__force.html#a0ef9eac0ed4ccc968912372844591dec" title="Compute continuum radiation force from Thomson scattering." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacemod__cak__force.html#a19e50108bb9d55cdb8cc5b292c33fb42" title="Compute velocity gradient in direction &#39;idir&#39; on a non&#45;uniform grid." alt="" coords="220,71,371,112"/>
<area shape="rect" href="namespacemod__comm__lib.html#a9b6f1a8fd13bc5670e3b426151c34048" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="204,137,387,163"/>
</map>
</div>

</div>
</div>
<a id="aca637c35a8d03c8282d38e4cce6f011c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca637c35a8d03c8282d38e4cce6f011c">&#9670;&nbsp;</a></span>get_cak_force_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::get_cak_force_vector </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>wCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixo^s,1:3), intent(inout)&#160;</td>
          <td class="paramname"><em>gcak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vector CAK line force in the Gayley line-ensemble distribution parametrisation. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00292">292</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_aca637c35a8d03c8282d38e4cce6f011c_cgraph.png" border="0" usemap="#anamespacemod__cak__force_aca637c35a8d03c8282d38e4cce6f011c_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_aca637c35a8d03c8282d38e4cce6f011c_cgraph" id="anamespacemod__cak__force_aca637c35a8d03c8282d38e4cce6f011c_cgraph">
<area shape="rect" title="Vector CAK line force in the Gayley line&#45;ensemble distribution parametrisation." alt="" coords="5,5,156,47"/>
<area shape="rect" href="namespacemod__cak__force.html#a19e50108bb9d55cdb8cc5b292c33fb42" title="Compute velocity gradient in direction &#39;idir&#39; on a non&#45;uniform grid." alt="" coords="204,5,355,47"/>
</map>
</div>

</div>
</div>
<a id="a0ef9eac0ed4ccc968912372844591dec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef9eac0ed4ccc968912372844591dec">&#9670;&nbsp;</a></span>get_gelectron()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::get_gelectron </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:nw), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>ge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute continuum radiation force from Thomson scattering. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00429">429</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a19e50108bb9d55cdb8cc5b292c33fb42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e50108bb9d55cdb8cc5b292c33fb42">&#9670;&nbsp;</a></span>get_velocity_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::get_velocity_gradient </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s), intent(in)&#160;</td>
          <td class="paramname"><em>vfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ixo^s), intent(out)&#160;</td>
          <td class="paramname"><em>grad_vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute velocity gradient in direction 'idir' on a non-uniform grid. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00478">478</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="aef780782d3155c249770b687578d070b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef780782d3155c249770b687578d070b">&#9670;&nbsp;</a></span>rays_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_cak_force::rays_init </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntheta_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphi_point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise (theta',phi') radiation angles coming from stellar disc. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00546">546</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__cak__force_aef780782d3155c249770b687578d070b_cgraph.png" border="0" usemap="#anamespacemod__cak__force_aef780782d3155c249770b687578d070b_cgraph" alt=""/></div>
<map name="anamespacemod__cak__force_aef780782d3155c249770b687578d070b_cgraph" id="anamespacemod__cak__force_aef780782d3155c249770b687578d070b_cgraph">
<area shape="rect" title="Initialise (theta&#39;,phi&#39;) radiation angles coming from stellar disc." alt="" coords="5,13,191,39"/>
<area shape="rect" href="namespacemod__cak__force.html#a4de21e5ed2f71feb2a89ee2c8705c1ec" title="Fast Gauss&#45;Legendre N&#45;point quadrature algorithm by G. Rybicki." alt="" coords="239,5,405,47"/>
</map>
</div>

</div>
</div>
<a id="a75b59828c3ad6e4a053045e2dbb821a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75b59828c3ad6e4a053045e2dbb821a5">&#9670;&nbsp;</a></span>set_cak_force_norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mod_cak_force::set_cak_force_norm </td>
          <td>(</td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>rstar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>twind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute some (unitless) variables for CAK force normalisation. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00143">143</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aed02c1bd73441906c137c8091aa99816"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed02c1bd73441906c137c8091aa99816">&#9670;&nbsp;</a></span>cak_1d_force</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_cak_force::cak_1d_force =.false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To activate the original CAK 1-D line force computation. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00044">44</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a9f12dc9aa12323a8b197529097dab2c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f12dc9aa12323a8b197529097dab2c2">&#9670;&nbsp;</a></span>cak_1d_opt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::cak_1d_opt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch to choose between the 1-D CAK line force options. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00035">35</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a55935f012ca1ef2d5d60b83686c090ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55935f012ca1ef2d5d60b83686c090ce">&#9670;&nbsp;</a></span>cak_alpha</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(8), public mod_cak_force::cak_alpha</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Line-ensemble parameters in the Gayley (1995) formalism. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00032">32</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a3b4f6a71504425aa3ef604af165369fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4f6a71504425aa3ef604af165369fb">&#9670;&nbsp;</a></span>cak_split</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_cak_force::cak_split =.false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To treat source term in split or unsplit (default) fashion. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00041">41</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a80638e7113beb92591e0978344e74cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80638e7113beb92591e0978344e74cd4">&#9670;&nbsp;</a></span>cak_vector_force</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_cak_force::cak_vector_force =.false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To activate the vector CAK line force computation. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00047">47</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a1def5edf4e12bbb4e70ff242f4a4e33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1def5edf4e12bbb4e70ff242f4a4e33b">&#9670;&nbsp;</a></span>fdf_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::fdf_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00068">68</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a7abb25819b9e38aef7e6f91c73baad32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7abb25819b9e38aef7e6f91c73baad32">&#9670;&nbsp;</a></span>fix_vector_force_1d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical mod_cak_force::fix_vector_force_1d =.false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To activate the pure radial vector CAK line force computation. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00050">50</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a1d7f489d5dbf494e5d3dc90ba3c82cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d7f489d5dbf494e5d3dc90ba3c82cc7">&#9670;&nbsp;</a></span>gayley_q0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(8), public mod_cak_force::gayley_q0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00032">32</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a15231e4b4a9df1259ad0c3558ecf2369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15231e4b4a9df1259ad0c3558ecf2369">&#9670;&nbsp;</a></span>gayley_qbar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(8), public mod_cak_force::gayley_qbar</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00032">32</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a7cc0ac81ccb769d6f389a481264e4e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc0ac81ccb769d6f389a481264e4e0c">&#9670;&nbsp;</a></span>gcak1_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::gcak1_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extra slots to store quantities in w-array. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00068">68</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="a8ed9282fb3227824bfc57f6f4bc2f0d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ed9282fb3227824bfc57f6f4bc2f0d6">&#9670;&nbsp;</a></span>gcak2_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::gcak2_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00068">68</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="ab4df183e42aeb56c1c35a21d592f2a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4df183e42aeb56c1c35a21d592f2a94">&#9670;&nbsp;</a></span>gcak3_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::gcak3_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00068">68</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="af454290f0f678d5ec5e82e500d14402f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af454290f0f678d5ec5e82e500d14402f">&#9670;&nbsp;</a></span>nphiray</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::nphiray</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00053">53</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
<a id="aed2e07c9e5b3c80b4e604b3a4baaadbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2e07c9e5b3c80b4e604b3a4baaadbf">&#9670;&nbsp;</a></span>nthetaray</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mod_cak_force::nthetaray</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Amount of rays in radiation polar and radiation azimuthal direction. </p>

<p class="definition">Definition at line <a class="el" href="mod__cak__force_8t_source.html#l00053">53</a> of file <a class="el" href="mod__cak__force_8t_source.html">mod_cak_force.t</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
