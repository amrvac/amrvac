<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPI-AMRVAC: mod_lfff Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPI-AMRVAC
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">The MPI - Adaptive Mesh Refinement - Versatile Advection Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mod_lfff Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Program to extrapolate linear force-free fields in 3D Cartesian coordinates, based on exact Green function method (Chiu &amp; Hilton 1977 ApJ 212,873).  
<a href="namespacemod__lfff.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:abb24141f3d4b7653940b952990530d84"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#abb24141f3d4b7653940b952990530d84">init_b_fff_data</a> (magnetogramname, qLunit, qBunit)</td></tr>
<tr class="separator:abb24141f3d4b7653940b952990530d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac604d9a61394c508966a54cb0d6de5b5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#ac604d9a61394c508966a54cb0d6de5b5">calc_lin_fff</a> (ixIL, ixOL, Bf, x, alpha, zshift, idir)</td></tr>
<tr class="separator:ac604d9a61394c508966a54cb0d6de5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19aa7cd7bf6dff5b3dc4a7b12612c7c0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#a19aa7cd7bf6dff5b3dc4a7b12612c7c0">get_potential_field_potential</a> (ixIL, ixOL, potential, x, zshift)</td></tr>
<tr class="separator:a19aa7cd7bf6dff5b3dc4a7b12612c7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a57571732dd6f8862594f402d4d2fb0d3"><td class="memItemLeft" align="right" valign="top">integer, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#a57571732dd6f8862594f402d4d2fb0d3">nx1</a></td></tr>
<tr class="separator:a57571732dd6f8862594f402d4d2fb0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab933f87ec30a5e5fe667265277f2e22f"><td class="memItemLeft" align="right" valign="top">integer, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#ab933f87ec30a5e5fe667265277f2e22f">nx2</a></td></tr>
<tr class="separator:ab933f87ec30a5e5fe667265277f2e22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4dc7187ff5b260ed012afb9809ae9f"><td class="memItemLeft" align="right" valign="top">double precision, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#aca4dc7187ff5b260ed012afb9809ae9f">bzmax</a></td></tr>
<tr class="separator:aca4dc7187ff5b260ed012afb9809ae9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a072313a92a3f71f5554e1624f107e6fd"><td class="memItemLeft" align="right" valign="top">double precision, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#a072313a92a3f71f5554e1624f107e6fd">darea</a></td></tr>
<tr class="separator:a072313a92a3f71f5554e1624f107e6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a144c405acf9984ebc8327c875d55fee8"><td class="memItemLeft" align="right" valign="top">double precision, dimension(:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#a144c405acf9984ebc8327c875d55fee8">bz0</a></td></tr>
<tr class="separator:a144c405acf9984ebc8327c875d55fee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4b83bf08dd16d1c4cb8501926ebdf9"><td class="memItemLeft" align="right" valign="top">double precision, dimension(:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#aee4b83bf08dd16d1c4cb8501926ebdf9">xa1</a></td></tr>
<tr class="separator:aee4b83bf08dd16d1c4cb8501926ebdf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46e4d8479397894718341a638add773"><td class="memItemLeft" align="right" valign="top">double precision, dimension(:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemod__lfff.html#ac46e4d8479397894718341a638add773">xa2</a></td></tr>
<tr class="separator:ac46e4d8479397894718341a638add773"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Program to extrapolate linear force-free fields in 3D Cartesian coordinates, based on exact Green function method (Chiu &amp; Hilton 1977 ApJ 212,873). </p>
<p>Usage: 1 In the subroutine usr_set_parameters of mod_usr.t: To extrapolate a linear force free field from a observed magnetogram prepared in a data file, e.g., 'hmiM720sxxxx.dat' replace call init_bc_fff_data('hmiM720sxxxx.dat',unit_length,unit_magneticfield) 'hmiM720sxxxx.dat' must be a binary file containing nx1,nx2,xc1,xc2,dxm1, dxm2, Bz0(nx1,nx2). Integers nx1 and nx2 give the resolution of the uniform-grid magentogram. Others are double-precision floats. xc1 and xc2 are coordinates of the central point of the magnetogram. dxm1 and dxm2 are the cell sizes for each direction, Bz0 is the vertical conponent of magetic field on the solar surface from observations. 2 In the subroutine usr_init_one_grid of mod_usr.t, add lines like:</p>
<p>double precision :: Bf(ixG^S,1:ndir), alpha, zshift</p>
<p>alpha=0.d0 ! potential field !alpha=0.08d0 ! non-potential linear force-free field zshift=0.05d0 ! lift your box zshift heigher to the bottom magnetogram call calc_lin_fff(ixG^L,ix^L,Bf,x,alpha,zshift)</p>
<p>3 Notice that the resolution of input magnetogram must be better than the best resolution of your AMR grid to have a good behavior close to the bottom layer </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac604d9a61394c508966a54cb0d6de5b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac604d9a61394c508966a54cb0d6de5b5">&#9670;&nbsp;</a></span>calc_lin_fff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_lfff::calc_lin_fff </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndir), intent(inout)&#160;</td>
          <td class="paramname"><em>Bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>zshift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>idir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00100">100</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="a19aa7cd7bf6dff5b3dc4a7b12612c7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19aa7cd7bf6dff5b3dc4a7b12612c7c0">&#9670;&nbsp;</a></span>get_potential_field_potential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_lfff::get_potential_field_potential </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ixO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s), intent(inout)&#160;</td>
          <td class="paramname"><em>potential</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ixi^s,1:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>zshift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00168">168</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="abb24141f3d4b7653940b952990530d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb24141f3d4b7653940b952990530d84">&#9670;&nbsp;</a></span>init_b_fff_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mod_lfff::init_b_fff_data </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>magnetogramname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qLunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>qBunit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00037">37</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemod__lfff_abb24141f3d4b7653940b952990530d84_cgraph.png" border="0" usemap="#anamespacemod__lfff_abb24141f3d4b7653940b952990530d84_cgraph" alt=""/></div>
<map name="anamespacemod__lfff_abb24141f3d4b7653940b952990530d84_cgraph" id="anamespacemod__lfff_abb24141f3d4b7653940b952990530d84_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,181,32"/>
<area shape="rect" href="comm__lib_8t.html#a49b49ea9ffbbadfe688e332921c4cddd" title="Exit MPI&#45;AMRVAC with an error message." alt="" coords="229,5,304,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a144c405acf9984ebc8327c875d55fee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a144c405acf9984ebc8327c875d55fee8">&#9670;&nbsp;</a></span>bz0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, dimension(:,:), allocatable, save mod_lfff::bz0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00032">32</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="aca4dc7187ff5b260ed012afb9809ae9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4dc7187ff5b260ed012afb9809ae9f">&#9670;&nbsp;</a></span>bzmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, save mod_lfff::bzmax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00031">31</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="a072313a92a3f71f5554e1624f107e6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a072313a92a3f71f5554e1624f107e6fd">&#9670;&nbsp;</a></span>darea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, save mod_lfff::darea</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00031">31</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="a57571732dd6f8862594f402d4d2fb0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57571732dd6f8862594f402d4d2fb0d3">&#9670;&nbsp;</a></span>nx1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, save mod_lfff::nx1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00030">30</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="ab933f87ec30a5e5fe667265277f2e22f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab933f87ec30a5e5fe667265277f2e22f">&#9670;&nbsp;</a></span>nx2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, save mod_lfff::nx2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00030">30</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="aee4b83bf08dd16d1c4cb8501926ebdf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4b83bf08dd16d1c4cb8501926ebdf9">&#9670;&nbsp;</a></span>xa1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, dimension(:), allocatable, save mod_lfff::xa1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00033">33</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
<a id="ac46e4d8479397894718341a638add773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46e4d8479397894718341a638add773">&#9670;&nbsp;</a></span>xa2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision, dimension(:), allocatable, save mod_lfff::xa2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__lfff_8t_source.html#l00033">33</a> of file <a class="el" href="mod__lfff_8t_source.html">mod_lfff.t</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
